<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 27 Extensions to ggplot | Reproducible Medical Research with R</title>
  <meta name="description" content="This book is for anyone in the medical field interested in learning R to analyze available health data." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 27 Extensions to ggplot | Reproducible Medical Research with R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is for anyone in the medical field interested in learning R to analyze available health data." />
  <meta name="github-repo" content="higgi13425/rmrwr-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 27 Extensions to ggplot | Reproducible Medical Research with R" />
  
  <meta name="twitter:description" content="This book is for anyone in the medical field interested in learning R to analyze available health data." />
  

<meta name="author" content="Peter D.R. Higgins, MD, PhD, MSc" />


<meta name="date" content="2025-04-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"/>
<link rel="next" href="customizing-plot-scales.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="include/webex.css" type="text/css" />
<link rel="stylesheet" href="include/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RMRWR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#who-this-book-is-for"><i class="fa fa-check"></i><b>1.1</b> Who This Book is For</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-upward-spiral-of-success-structure"><i class="fa fa-check"></i><b>1.3</b> The (Upward) Spiral of Success Structure</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#motivation-for-this-book"><i class="fa fa-check"></i><b>1.4</b> Motivation for this Book</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#the-scientific-reproducibility-crisis"><i class="fa fa-check"></i><b>1.5</b> The Scientific Reproducibility Crisis</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#features-of-a-bookdown-electronic-book"><i class="fa fa-check"></i><b>1.6</b> Features of a Bookdown electronic book</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#what-this-book-is-not"><i class="fa fa-check"></i><b>1.7</b> What this Book is Not</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#this-book-is-not-a-statistics-text"><i class="fa fa-check"></i><b>1.7.1</b> This Book is Not A Statistics Text</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#this-book-does-not-provide-comprehensive-coverage-of-the-r-universe"><i class="fa fa-check"></i><b>1.7.2</b> This Book Does Not Provide Comprehensive Coverage of the R Universe</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#some-guideposts"><i class="fa fa-check"></i><b>1.8</b> Some Guideposts</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#helpful-tools"><i class="fa fa-check"></i><b>1.9</b> Helpful Tools</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="index.html"><a href="index.html#demonstrations-in-flipbooks"><i class="fa fa-check"></i><b>1.9.1</b> Demonstrations in Flipbooks</a></li>
<li class="chapter" data-level="1.9.2" data-path="index.html"><a href="index.html#learnr-coding-exercises"><i class="fa fa-check"></i><b>1.9.2</b> Learnr Coding Exercises</a></li>
<li class="chapter" data-level="1.9.3" data-path="index.html"><a href="index.html#coding"><i class="fa fa-check"></i><b>1.9.3</b> Coding</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html"><i class="fa fa-check"></i><b>2</b> Getting Started and Installing Your Tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#goals-for-this-chapter"><i class="fa fa-check"></i><b>2.1</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#website-links-needed-for-this-chapter"><i class="fa fa-check"></i><b>2.2</b> Website links needed for this Chapter</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#pathway-for-this-chapter"><i class="fa fa-check"></i><b>2.3</b> Pathway for this Chapter</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#installing-r-on-your-computer"><i class="fa fa-check"></i><b>2.4</b> Installing R on your Computer</a></li>
<li class="chapter" data-level="2.5" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#windows-specific-steps-for-installing-r"><i class="fa fa-check"></i><b>2.5</b> Windows-Specific Steps for Installing R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#testing-r-on-windows"><i class="fa fa-check"></i><b>2.5.1</b> Testing R on Windows</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#mac-specific-installation-of-r"><i class="fa fa-check"></i><b>2.6</b> Mac-specific Installation of R</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#testing-r-on-the-mac"><i class="fa fa-check"></i><b>2.6.1</b> Testing R on the Mac</a></li>
<li class="chapter" data-level="2.6.2" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#successful-testing"><i class="fa fa-check"></i><b>2.6.2</b> Successful testing!</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#installing-rstudio-on-your-computer"><i class="fa fa-check"></i><b>2.7</b> Installing RStudio on your Computer</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#windows-install-of-rstudio"><i class="fa fa-check"></i><b>2.7.1</b> Windows Install of RStudio</a></li>
<li class="chapter" data-level="2.7.2" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#testing-windows-rstudio"><i class="fa fa-check"></i><b>2.7.2</b> Testing Windows RStudio</a></li>
<li class="chapter" data-level="2.7.3" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#installing-rstudio-on-the-mac"><i class="fa fa-check"></i><b>2.7.3</b> Installing RStudio on the Mac</a></li>
<li class="chapter" data-level="2.7.4" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#testing-the-mac-installation-of-rstudio"><i class="fa fa-check"></i><b>2.7.4</b> Testing the Mac Installation of RStudio</a></li>
<li class="chapter" data-level="2.7.5" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#critical-setup---tuning-up-your-rstudio-installation"><i class="fa fa-check"></i><b>2.7.5</b> Critical Setup - Tuning Up Your RStudio Installation</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#installing-git-on-your-computer"><i class="fa fa-check"></i><b>2.8</b> Installing Git on your Computer</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#installing-git-on-macos"><i class="fa fa-check"></i><b>2.8.1</b> Installing Git on macOS</a></li>
<li class="chapter" data-level="2.8.2" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#installing-git-on-windows"><i class="fa fa-check"></i><b>2.8.2</b> Installing Git on Windows</a></li>
<li class="chapter" data-level="2.8.3" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#installing-git-on-linux"><i class="fa fa-check"></i><b>2.8.3</b> Installing Git on Linux</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="getting-started-and-installing-your-tools.html"><a href="getting-started-and-installing-your-tools.html#getting-acquainted-with-the-rstudio-ide"><i class="fa fa-check"></i><b>2.9</b> Getting Acquainted with the RStudio IDE</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html"><i class="fa fa-check"></i><b>3</b> A Tasting Menu of R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#setting-the-table"><i class="fa fa-check"></i><b>3.1</b> Setting the Table</a></li>
<li class="chapter" data-level="3.2" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#goals-for-this-chapter-1"><i class="fa fa-check"></i><b>3.2</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="3.3" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#packages-needed-for-this-chapter"><i class="fa fa-check"></i><b>3.3</b> Packages needed for this Chapter</a></li>
<li class="chapter" data-level="3.4" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#website-links-needed-for-this-chapter-1"><i class="fa fa-check"></i><b>3.4</b> Website links needed for this Chapter</a></li>
<li class="chapter" data-level="3.5" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#setting-up-rpubs"><i class="fa fa-check"></i><b>3.5</b> Setting up RPubs</a></li>
<li class="chapter" data-level="3.6" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#open-a-new-rmarkdown-document"><i class="fa fa-check"></i><b>3.6</b> Open a New Rmarkdown document</a></li>
<li class="chapter" data-level="3.7" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#knitting-your-rmarkdown-document"><i class="fa fa-check"></i><b>3.7</b> Knitting your Rmarkdown document</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#installing-packages"><i class="fa fa-check"></i><b>3.7.1</b> Installing Packages</a></li>
<li class="chapter" data-level="3.7.2" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#loading-packages-with-library"><i class="fa fa-check"></i><b>3.7.2</b> Loading Packages with library()</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#your-turn-to-write-text"><i class="fa fa-check"></i><b>3.8</b> Your Turn to Write Text</a></li>
<li class="chapter" data-level="3.9" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#wrangle-your-data"><i class="fa fa-check"></i><b>3.9</b> Wrangle Your Data</a></li>
<li class="chapter" data-level="3.10" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#summarize-your-data"><i class="fa fa-check"></i><b>3.10</b> Summarize Your Data</a></li>
<li class="chapter" data-level="3.11" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#visualize-your-data"><i class="fa fa-check"></i><b>3.11</b> Visualize Your Data</a></li>
<li class="chapter" data-level="3.12" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#statistical-testing-of-differences"><i class="fa fa-check"></i><b>3.12</b> Statistical Testing of Differences</a></li>
<li class="chapter" data-level="3.13" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#publish-your-work-to-rpubs"><i class="fa fa-check"></i><b>3.13</b> Publish your work to RPubs</a></li>
<li class="chapter" data-level="3.14" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#the-dessert-cart"><i class="fa fa-check"></i><b>3.14</b> The Dessert Cart</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#interactive-plots"><i class="fa fa-check"></i><b>3.14.1</b> Interactive Plots</a></li>
<li class="chapter" data-level="3.14.2" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#animated-graphics"><i class="fa fa-check"></i><b>3.14.2</b> Animated Graphics</a></li>
<li class="chapter" data-level="3.14.3" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#a-clinical-trial-dashboard"><i class="fa fa-check"></i><b>3.14.3</b> A Clinical Trial Dashboard</a></li>
<li class="chapter" data-level="3.14.4" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#a-shiny-app"><i class="fa fa-check"></i><b>3.14.4</b> A Shiny App</a></li>
<li class="chapter" data-level="3.14.5" data-path="a-tasting-menu-of-r.html"><a href="a-tasting-menu-of-r.html#an-example-of-synergy-in-the-r-community"><i class="fa fa-check"></i><b>3.14.5</b> An Example of Synergy in the R Community</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html"><i class="fa fa-check"></i><b>4</b> Introduction to Reproducibility</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html#first-steps-to-research-reproducibility"><i class="fa fa-check"></i><b>4.1</b> First Steps to Research Reproducibility</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html#have-a-plan"><i class="fa fa-check"></i><b>4.1.1</b> Have a Plan</a></li>
<li class="chapter" data-level="4.1.2" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html#treat-your-raw-data-like-gold"><i class="fa fa-check"></i><b>4.1.2</b> Treat Your Raw Data Like Gold</a></li>
<li class="chapter" data-level="4.1.3" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html#cleaning-and-analyzing-your-data"><i class="fa fa-check"></i><b>4.1.3</b> Cleaning and Analyzing Your Data</a></li>
<li class="chapter" data-level="4.1.4" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html#the-first-level-of-reproducibility"><i class="fa fa-check"></i><b>4.1.4</b> The First Level of Reproducibility</a></li>
<li class="chapter" data-level="4.1.5" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html#the-second-level-of-reproducibility"><i class="fa fa-check"></i><b>4.1.5</b> The Second Level of Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="introduction-to-reproducibility.html"><a href="introduction-to-reproducibility.html#the-foundations-of-reproducibility"><i class="fa fa-check"></i><b>4.2</b> The Foundations of Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html"><i class="fa fa-check"></i><b>5</b> Importing Your Data into R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#reading-data-with-the-readr-package"><i class="fa fa-check"></i><b>5.1</b> Reading data with the {readr} package</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#test-yourself-on-scurvy"><i class="fa fa-check"></i><b>5.1.1</b> Test yourself on scurvy</a></li>
<li class="chapter" data-level="5.1.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#what-is-a-path"><i class="fa fa-check"></i><b>5.1.2</b> What is a path?<br></a></li>
<li class="chapter" data-level="5.1.3" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#try-it-yourself"><i class="fa fa-check"></i><b>5.1.3</b> Try it Yourself</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#reading-excel-files-with-readxl"><i class="fa fa-check"></i><b>5.2</b> Reading Excel Files with readxl</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#test-yourself-on-read_excel"><i class="fa fa-check"></i><b>5.2.1</b> Test yourself on read_excel()</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#bringing-in-data-from-other-statistical-programs-sas-stata-spss-with-the-haven-package"><i class="fa fa-check"></i><b>5.3</b> Bringing in data from other Statistical Programs (SAS, Stata, SPSS) with the {haven} package</a></li>
<li class="chapter" data-level="5.4" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#other-strange-file-types-with-rio"><i class="fa fa-check"></i><b>5.4</b> Other strange file types with rio</a></li>
<li class="chapter" data-level="5.5" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#data-exploration-with-glimpse-str-and-headtail"><i class="fa fa-check"></i><b>5.5</b> Data exploration with glimpse, str, and head/tail</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#taking-a-glimpse-with-glimpse"><i class="fa fa-check"></i><b>5.5.1</b> Taking a glimpse with <em>glimpse()</em></a></li>
<li class="chapter" data-level="5.5.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#try-this-out-yourself."><i class="fa fa-check"></i><b>5.5.2</b> Try this out yourself.</a></li>
<li class="chapter" data-level="5.5.3" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#test-yourself-on-strep_tb"><i class="fa fa-check"></i><b>5.5.3</b> Test yourself on strep_tb</a></li>
<li class="chapter" data-level="5.5.4" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#examining-structure-with-str"><i class="fa fa-check"></i><b>5.5.4</b> Examining Structure with <em>str()</em></a></li>
<li class="chapter" data-level="5.5.5" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#test-yourself-on-the-scurvy-dataset"><i class="fa fa-check"></i><b>5.5.5</b> Test yourself on the scurvy dataset</a></li>
<li class="chapter" data-level="5.5.6" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#examining-a-bit-of-data-with-head-and-tail"><i class="fa fa-check"></i><b>5.5.6</b> Examining a bit of data with <em>head()</em> and <em>tail()</em></a></li>
<li class="chapter" data-level="5.5.7" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#test-yourself-on-the-printing-tibbles"><i class="fa fa-check"></i><b>5.5.7</b> Test yourself on the printing tibbles</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#more-exploration-with-skimr-and-dataexplorer"><i class="fa fa-check"></i><b>5.6</b> More exploration with skimr and DataExplorer</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#test-yourself-on-the-skim-results"><i class="fa fa-check"></i><b>5.6.1</b> Test yourself on the <code>skim()</code> results</a></li>
<li class="chapter" data-level="5.6.2" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#test-yourself-on-the-create_report-results"><i class="fa fa-check"></i><b>5.6.2</b> Test yourself on the <code>create_report()</code> results</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#practice-loading-data-from-multiple-file-types"><i class="fa fa-check"></i><b>5.7</b> Practice loading data from multiple file types</a></li>
<li class="chapter" data-level="5.8" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#practice-saving-writing-to-disk-data-objects-in-formats-including-csv-rds-xls-xlsx-and-statistical-program-formats"><i class="fa fa-check"></i><b>5.8</b> Practice saving (writing to disk) data objects in formats including csv, rds, xls, xlsx and statistical program formats</a></li>
<li class="chapter" data-level="5.9" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#how-do-readr-and-readxl-parse-columns"><i class="fa fa-check"></i><b>5.9</b> How do readr and readxl parse columns?</a></li>
<li class="chapter" data-level="5.10" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#what-are-the-variable-types"><i class="fa fa-check"></i><b>5.10</b> What are the variable types?</a></li>
<li class="chapter" data-level="5.11" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#controlling-parsing"><i class="fa fa-check"></i><b>5.11</b> Controlling Parsing</a></li>
<li class="chapter" data-level="5.12" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#chapter-challenges"><i class="fa fa-check"></i><b>5.12</b> Chapter Challenges</a></li>
<li class="chapter" data-level="5.13" data-path="importing-your-data-into-r.html"><a href="importing-your-data-into-r.html#future-forms-of-data-ingestion"><i class="fa fa-check"></i><b>5.13</b> Future forms of data ingestion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html"><i class="fa fa-check"></i><b>6</b> Wrangling Rows in R with Filter</a>
<ul>
<li class="chapter" data-level="6.1" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#goals-for-this-chapter-2"><i class="fa fa-check"></i><b>6.1</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="6.2" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#packages-needed-for-this-chapter-1"><i class="fa fa-check"></i><b>6.2</b> Packages needed for this Chapter</a></li>
<li class="chapter" data-level="6.3" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#pathway-for-this-chapter-1"><i class="fa fa-check"></i><b>6.3</b> Pathway for this Chapter</a></li>
<li class="chapter" data-level="6.4" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#logical-statements-in-r"><i class="fa fa-check"></i><b>6.4</b> Logical Statements in R</a></li>
<li class="chapter" data-level="6.5" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#filtering-on-numbers---starting-with-a-flipbook"><i class="fa fa-check"></i><b>6.5</b> Filtering on Numbers - Starting with A Flipbook</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#your-turn---learnr-exercises"><i class="fa fa-check"></i><b>6.5.1</b> Your Turn - learnr exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#filtering-on-multiple-criteria-with-boolean-logic"><i class="fa fa-check"></i><b>6.6</b> Filtering on Multiple Criteria with Boolean Logic</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#your-turn---learnr-exercises-1"><i class="fa fa-check"></i><b>6.6.1</b> Your Turn - learnr exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#filtering-strings"><i class="fa fa-check"></i><b>6.7</b> Filtering Strings</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#your-turn---learnr-exercises-2"><i class="fa fa-check"></i><b>6.7.1</b> Your Turn - learnr exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#filtering-dates"><i class="fa fa-check"></i><b>6.8</b> Filtering Dates</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#your-turn---learnr-exercises-3"><i class="fa fa-check"></i><b>6.8.1</b> Your Turn - learnr exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#filtering-out-or-identifying-missing-data"><i class="fa fa-check"></i><b>6.9</b> Filtering Out or Identifying Missing Data</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#working-with-missing-data"><i class="fa fa-check"></i><b>6.9.1</b> Working with Missing data</a></li>
<li class="chapter" data-level="6.9.2" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#your-turn---learnr-exercises-4"><i class="fa fa-check"></i><b>6.9.2</b> Your Turn - learnr exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#filtering-out-duplicate-observations"><i class="fa fa-check"></i><b>6.10</b> Filtering Out Duplicate observations</a></li>
<li class="chapter" data-level="6.11" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#slicing-data-by-row"><i class="fa fa-check"></i><b>6.11</b> Slicing Data by Row</a></li>
<li class="chapter" data-level="6.12" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#randomly-sampling-your-rows"><i class="fa fa-check"></i><b>6.12</b> Randomly Sampling Your Rows</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#your-turn---learnr-exercises-5"><i class="fa fa-check"></i><b>6.12.1</b> Your Turn - learnr exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#further-challenges"><i class="fa fa-check"></i><b>6.13</b> Further Challenges</a></li>
<li class="chapter" data-level="6.14" data-path="wrangling-rows-in-r-with-filter.html"><a href="wrangling-rows-in-r-with-filter.html#explore-more-about-filtering"><i class="fa fa-check"></i><b>6.14</b> Explore More about Filtering</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html"><i class="fa fa-check"></i><b>7</b> The Basics of R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#why-programming"><i class="fa fa-check"></i><b>7.1</b> Why Programming?</a></li>
<li class="chapter" data-level="7.2" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#programming-fears"><i class="fa fa-check"></i><b>7.2</b> Programming Fears</a></li>
<li class="chapter" data-level="7.3" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#thinking-about-wofkflow"><i class="fa fa-check"></i><b>7.3</b> Thinking about Wofkflow</a></li>
<li class="chapter" data-level="7.4" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#files-in-r"><i class="fa fa-check"></i><b>7.4</b> Files in R</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#data-files"><i class="fa fa-check"></i><b>7.4.1</b> Data Files</a></li>
<li class="chapter" data-level="7.4.2" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#script-files"><i class="fa fa-check"></i><b>7.4.2</b> Script files</a></li>
<li class="chapter" data-level="7.4.3" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#other-files"><i class="fa fa-check"></i><b>7.4.3</b> Other files</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#paths-in-r"><i class="fa fa-check"></i><b>7.5</b> Paths in R</a></li>
<li class="chapter" data-level="7.6" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#creating-variables-in-r"><i class="fa fa-check"></i><b>7.6</b> Creating variables in R</a></li>
<li class="chapter" data-level="7.7" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#the-pipe-operator"><i class="fa fa-check"></i><b>7.7</b> The Pipe Operator</a></li>
<li class="chapter" data-level="7.8" data-path="the-basics-of-r.html"><a href="the-basics-of-r.html#r-dialects"><i class="fa fa-check"></i><b>7.8</b> R Dialects</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html"><i class="fa fa-check"></i><b>8</b> Wrangling Columns in R with Select, Rename, and Relocate</a>
<ul>
<li class="chapter" data-level="8.1" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#goals-for-this-chapter-3"><i class="fa fa-check"></i><b>8.1</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="8.2" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#packages-needed-for-this-chapter-2"><i class="fa fa-check"></i><b>8.2</b> Packages needed for this Chapter</a></li>
<li class="chapter" data-level="8.3" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#pathway-for-this-chapter-2"><i class="fa fa-check"></i><b>8.3</b> Pathway for this Chapter</a></li>
<li class="chapter" data-level="8.4" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#tidyselect-helpers-in-r"><i class="fa fa-check"></i><b>8.4</b> Tidyselect Helpers in R</a></li>
<li class="chapter" data-level="8.5" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#selecting-a-column-variables"><i class="fa fa-check"></i><b>8.5</b> Selecting a Column Variables</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#try-this-out"><i class="fa fa-check"></i><b>8.5.1</b> Try this out</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#selecting-columns-that-are-not-contiguous"><i class="fa fa-check"></i><b>8.6</b> Selecting Columns that are Not Contiguous</a></li>
<li class="chapter" data-level="8.7" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#selecting-columns-with-logical-operators"><i class="fa fa-check"></i><b>8.7</b> Selecting Columns With Logical Operators</a></li>
<li class="chapter" data-level="8.8" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#further-challenges-1"><i class="fa fa-check"></i><b>8.8</b> Further Challenges</a></li>
<li class="chapter" data-level="8.9" data-path="wrangling-columns-in-r-with-select-rename-and-relocate.html"><a href="wrangling-columns-in-r-with-select-rename-and-relocate.html#explore-more-about-filtering-1"><i class="fa fa-check"></i><b>8.9</b> Explore More about Filtering</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-mutate-to-make-new-variables-columns.html"><a href="using-mutate-to-make-new-variables-columns.html"><i class="fa fa-check"></i><b>9</b> Using Mutate to Make New Variables (Columns)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="using-mutate-to-make-new-variables-columns.html"><a href="using-mutate-to-make-new-variables-columns.html#calculating-bmi"><i class="fa fa-check"></i><b>9.1</b> Calculating BMI</a></li>
<li class="chapter" data-level="9.2" data-path="using-mutate-to-make-new-variables-columns.html"><a href="using-mutate-to-make-new-variables-columns.html#recoding-categorical-or-ordinal-data"><i class="fa fa-check"></i><b>9.2</b> Recoding categorical or ordinal data</a></li>
<li class="chapter" data-level="9.3" data-path="using-mutate-to-make-new-variables-columns.html"><a href="using-mutate-to-make-new-variables-columns.html#calculating-glomerular-filtration-rate"><i class="fa fa-check"></i><b>9.3</b> Calculating Glomerular Filtration Rate</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html"><i class="fa fa-check"></i><b>10</b> Mutating Joins to Combine Data Sources</a>
<ul>
<li class="chapter" data-level="10.1" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#what-are-joins"><i class="fa fa-check"></i><b>10.1</b> What are Joins?</a></li>
<li class="chapter" data-level="10.2" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#what-are-mutating-joins"><i class="fa fa-check"></i><b>10.2</b> What are Mutating Joins?</a></li>
<li class="chapter" data-level="10.3" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#lets-start-with-left-joins"><i class="fa fa-check"></i><b>10.3</b> Let’s Start with Left Joins</a></li>
<li class="chapter" data-level="10.4" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#left-join-in-action"><i class="fa fa-check"></i><b>10.4</b> Left Join in Action</a></li>
<li class="chapter" data-level="10.5" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#left-join-in-practice"><i class="fa fa-check"></i><b>10.5</b> Left Join in Practice</a></li>
<li class="chapter" data-level="10.6" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#quick-quiz"><i class="fa fa-check"></i><b>10.6</b> Quick Quiz</a></li>
<li class="chapter" data-level="10.7" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#problem-variable-names"><i class="fa fa-check"></i><b>10.7</b> Problem variable names</a></li>
<li class="chapter" data-level="10.8" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#right-join-in-action"><i class="fa fa-check"></i><b>10.8</b> Right Join in Action</a></li>
<li class="chapter" data-level="10.9" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#right-join-in-practice"><i class="fa fa-check"></i><b>10.9</b> Right Join in Practice</a></li>
<li class="chapter" data-level="10.10" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#inner-joins"><i class="fa fa-check"></i><b>10.10</b> Inner Joins</a></li>
<li class="chapter" data-level="10.11" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#quick-quiz-1"><i class="fa fa-check"></i><b>10.11</b> Quick Quiz</a></li>
<li class="chapter" data-level="10.12" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#now-lets-take-a-look-at-the-result"><i class="fa fa-check"></i><b>10.12</b> Now Let’s take a Look at the result</a></li>
<li class="chapter" data-level="10.13" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#full-joins"><i class="fa fa-check"></i><b>10.13</b> Full Joins</a></li>
<li class="chapter" data-level="10.14" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#quick-quiz-2"><i class="fa fa-check"></i><b>10.14</b> Quick Quiz</a></li>
<li class="chapter" data-level="10.15" data-path="mutating-joins-to-combine-data-sources.html"><a href="mutating-joins-to-combine-data-sources.html#now-lets-take-a-look-at-the-result-1"><i class="fa fa-check"></i><b>10.15</b> Now Let’s take a Look at the result</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html"><i class="fa fa-check"></i><b>11</b> Interpreting Error Messages</a>
<ul>
<li class="chapter" data-level="11.1" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#the-common-errors-table"><i class="fa fa-check"></i><b>11.1</b> The Common Errors Table</a></li>
<li class="chapter" data-level="11.2" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#examples-of-common-errors-and-how-to-fix-them"><i class="fa fa-check"></i><b>11.2</b> Examples of Common Errors and How to fix them</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#missing-parenthesis"><i class="fa fa-check"></i><b>11.2.1</b> Missing Parenthesis</a></li>
<li class="chapter" data-level="11.2.2" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#an-extra-parenthesis"><i class="fa fa-check"></i><b>11.2.2</b> An Extra Parenthesis</a></li>
<li class="chapter" data-level="11.2.3" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#missing-pipe-in-a-data-wrangling-pipeline"><i class="fa fa-check"></i><b>11.2.3</b> Missing pipe <code>%&gt;%</code> in a data wrangling pipeline</a></li>
<li class="chapter" data-level="11.2.4" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#missing-in-a-ggplot-pipeline"><i class="fa fa-check"></i><b>11.2.4</b> Missing + in a ggplot pipeline</a></li>
<li class="chapter" data-level="11.2.5" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#pipe-in-place-of-a"><i class="fa fa-check"></i><b>11.2.5</b> Pipe <code>%&gt;%</code> in Place of a <code>+</code></a></li>
<li class="chapter" data-level="11.2.6" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#missing-comma-within-a-function"><i class="fa fa-check"></i><b>11.2.6</b> Missing Comma Within a Function()</a></li>
<li class="chapter" data-level="11.2.7" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#a-missing-object"><i class="fa fa-check"></i><b>11.2.7</b> A Missing Object</a></li>
<li class="chapter" data-level="11.2.8" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#one-equals-sign-when-you-need-two"><i class="fa fa-check"></i><b>11.2.8</b> One Equals Sign When you Need Two</a></li>
<li class="chapter" data-level="11.2.9" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#non-numeric-argument-to-a-binary-operator"><i class="fa fa-check"></i><b>11.2.9</b> Non-numeric argument to a binary operator</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#errors-beyond-this-list"><i class="fa fa-check"></i><b>11.3</b> Errors Beyond This List</a></li>
<li class="chapter" data-level="11.4" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#when-things-get-weird"><i class="fa fa-check"></i><b>11.4</b> When Things Get Weird</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#restart-your-r-session-shift-cmd-f10"><i class="fa fa-check"></i><b>11.4.1</b> Restart your R Session (Shift-Cmd-F10)</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="interpreting-error-messages.html"><a href="interpreting-error-messages.html#references"><i class="fa fa-check"></i><b>11.5</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><a href="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><i class="fa fa-check"></i><b>12</b> The Building Blocks of R: data types, data structures, functions, and packages</a>
<ul>
<li class="chapter" data-level="12.1" data-path="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><a href="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html#data-types"><i class="fa fa-check"></i><b>12.1</b> Data Types</a></li>
<li class="chapter" data-level="12.2" data-path="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><a href="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html#data-structures"><i class="fa fa-check"></i><b>12.2</b> Data Structures</a></li>
<li class="chapter" data-level="12.3" data-path="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><a href="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html#examining-data-types-and-data-structures"><i class="fa fa-check"></i><b>12.3</b> Examining Data Types and Data Structures</a></li>
<li class="chapter" data-level="12.4" data-path="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><a href="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html#functions"><i class="fa fa-check"></i><b>12.4</b> Functions</a></li>
<li class="chapter" data-level="12.5" data-path="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><a href="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html#packages"><i class="fa fa-check"></i><b>12.5</b> Packages</a></li>
<li class="chapter" data-level="12.6" data-path="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html"><a href="the-building-blocks-of-r-data-types-data-structures-functions-and-packages.html#the-building-blocks-of-r"><i class="fa fa-check"></i><b>12.6</b> The Building Blocks of R</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html"><i class="fa fa-check"></i><b>13</b> Building Your Table One with the {gtsummary} Package</a>
<ul>
<li class="chapter" data-level="13.1" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#using-tbl_summary-from-the-gtsummary-package"><i class="fa fa-check"></i><b>13.1</b> Using tbl_summary() from the gtsummary package</a></li>
<li class="chapter" data-level="13.2" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#making-a-basic-table"><i class="fa fa-check"></i><b>13.2</b> Making a Basic table</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#challenges"><i class="fa fa-check"></i><b>13.2.1</b> Challenges:</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#multiple-dimensions"><i class="fa fa-check"></i><b>13.3</b> Multiple Dimensions</a></li>
<li class="chapter" data-level="13.4" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#new-challenges"><i class="fa fa-check"></i><b>13.4</b> New Challenges</a></li>
<li class="chapter" data-level="13.5" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#even-more-help"><i class="fa fa-check"></i><b>13.5</b> Even More Help</a></li>
<li class="chapter" data-level="13.6" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#figuring-out-column-names"><i class="fa fa-check"></i><b>13.6</b> Figuring out Column names</a></li>
<li class="chapter" data-level="13.7" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#even-more-challenges"><i class="fa fa-check"></i><b>13.7</b> Even More Challenges</a></li>
<li class="chapter" data-level="13.8" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#adding-some-formatting"><i class="fa fa-check"></i><b>13.8</b> Adding Some Formatting</a>
<ul>
<li class="chapter" data-level="13.8.1" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#formatting-with-gt"><i class="fa fa-check"></i><b>13.8.1</b> Formatting with {gt}</a></li>
</ul></li>
<li class="chapter" data-level="13.9" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#a-fancier-version-for-gt"><i class="fa fa-check"></i><b>13.9</b> A Fancier Version for gt</a>
<ul>
<li class="chapter" data-level="13.9.1" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#the-flextable-package"><i class="fa fa-check"></i><b>13.9.1</b> The {flextable} package</a></li>
</ul></li>
<li class="chapter" data-level="13.10" data-path="building-your-table-one-with-the-gtsummary-package.html"><a href="building-your-table-one-with-the-gtsummary-package.html#a-fancier-version-for-flextable"><i class="fa fa-check"></i><b>13.10</b> A Fancier Version for Flextable</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><i class="fa fa-check"></i><b>14</b> Tips for Hashtag Debugging your Pipes and GGPlots</a>
<ul>
<li class="chapter" data-level="14.1" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#debugging"><i class="fa fa-check"></i><b>14.1</b> Debugging</a></li>
<li class="chapter" data-level="14.2" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#the-quick-screen"><i class="fa fa-check"></i><b>14.2</b> The Quick Screen</a></li>
<li class="chapter" data-level="14.3" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#systematic-hunting-for-bugs-in-pipes"><i class="fa fa-check"></i><b>14.3</b> Systematic Hunting For Bugs in Pipes</a></li>
<li class="chapter" data-level="14.4" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#systematic-hunting-for-bugs-in-plots"><i class="fa fa-check"></i><b>14.4</b> Systematic Hunting For Bugs in Plots</a></li>
<li class="chapter" data-level="14.5" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#hashtag-debugging"><i class="fa fa-check"></i><b>14.5</b> Hashtag Debugging</a></li>
<li class="chapter" data-level="14.6" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#pipe-2"><i class="fa fa-check"></i><b>14.6</b> Pipe 2</a></li>
<li class="chapter" data-level="14.7" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#plot-2"><i class="fa fa-check"></i><b>14.7</b> Plot 2</a></li>
<li class="chapter" data-level="14.8" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#plot3"><i class="fa fa-check"></i><b>14.8</b> Plot3</a></li>
<li class="chapter" data-level="14.9" data-path="tips-for-hashtag-debugging-your-pipes-and-ggplots.html"><a href="tips-for-hashtag-debugging-your-pipes-and-ggplots.html#pipe-3"><i class="fa fa-check"></i><b>14.9</b> Pipe 3</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html"><i class="fa fa-check"></i><b>15</b> Finding Help in R</a>
<ul>
<li class="chapter" data-level="15.1" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#programming-in-r"><i class="fa fa-check"></i><b>15.1</b> Programming in R</a></li>
<li class="chapter" data-level="15.2" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#starting-with-help"><i class="fa fa-check"></i><b>15.2</b> Starting with Help!</a></li>
<li class="chapter" data-level="15.3" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#the-magic-of-vignettes"><i class="fa fa-check"></i><b>15.3</b> The Magic of Vignettes</a></li>
<li class="chapter" data-level="15.4" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#googling-the-error-message"><i class="fa fa-check"></i><b>15.4</b> Googling the Error Message</a></li>
<li class="chapter" data-level="15.5" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#you-know-what-you-want-to-do-but-dont-know-what-package-or-function-to-use"><i class="fa fa-check"></i><b>15.5</b> You Know What You Want to Do, but Don’t Know What Package or Function to Use</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#cran-task-views"><i class="fa fa-check"></i><b>15.5.1</b> CRAN Task Views</a></li>
<li class="chapter" data-level="15.5.2" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#google-is-your-friend"><i class="fa fa-check"></i><b>15.5.2</b> Google is Your Friend</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="finding-help-in-r.html"><a href="finding-help-in-r.html#seeking-advanced-help-with-a-minimal-reprex"><i class="fa fa-check"></i><b>15.6</b> Seeking Advanced Help with a Minimal REPREX</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html"><i class="fa fa-check"></i><b>16</b> The Basics of Base R</a>
<ul>
<li class="chapter" data-level="16.1" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#dimensions-of-data-rectangles"><i class="fa fa-check"></i><b>16.1</b> Dimensions of Data Rectangles</a></li>
<li class="chapter" data-level="16.2" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#naming-columns"><i class="fa fa-check"></i><b>16.2</b> Naming columns</a></li>
<li class="chapter" data-level="16.3" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#concatenation"><i class="fa fa-check"></i><b>16.3</b> Concatenation</a></li>
<li class="chapter" data-level="16.4" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#sequences"><i class="fa fa-check"></i><b>16.4</b> Sequences</a></li>
<li class="chapter" data-level="16.5" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#constants"><i class="fa fa-check"></i><b>16.5</b> Constants</a></li>
<li class="chapter" data-level="16.6" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#fancier-sequences"><i class="fa fa-check"></i><b>16.6</b> Fancier Sequences</a></li>
<li class="chapter" data-level="16.7" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#mathematical-functions"><i class="fa fa-check"></i><b>16.7</b> Mathematical functions</a></li>
<li class="chapter" data-level="16.8" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#handling-missing-data-nas"><i class="fa fa-check"></i><b>16.8</b> Handling missing data (NAs)</a></li>
<li class="chapter" data-level="16.9" data-path="the-basics-of-base-r.html"><a href="the-basics-of-base-r.html#cutting-continuous-data-into-levels"><i class="fa fa-check"></i><b>16.9</b> Cutting Continuous data into Levels</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html"><i class="fa fa-check"></i><b>17</b> Updating R, RStudio, and Your Packages</a>
<ul>
<li class="chapter" data-level="17.1" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html#installing-packages-1"><i class="fa fa-check"></i><b>17.1</b> Installing Packages</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html#installing-packages-from-github"><i class="fa fa-check"></i><b>17.1.1</b> Installing Packages from Github</a></li>
<li class="chapter" data-level="17.1.2" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html#problems-with-installing-packages"><i class="fa fa-check"></i><b>17.1.2</b> Problems with Installing Packages</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html#loading-packages-with-library-1"><i class="fa fa-check"></i><b>17.2</b> Loading Packages with Library</a></li>
<li class="chapter" data-level="17.3" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html#updating-r"><i class="fa fa-check"></i><b>17.3</b> Updating R</a></li>
<li class="chapter" data-level="17.4" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html#updating-rstudio"><i class="fa fa-check"></i><b>17.4</b> Updating RStudio</a></li>
<li class="chapter" data-level="17.5" data-path="updating-r-rstudio-and-your-packages.html"><a href="updating-r-rstudio-and-your-packages.html#updating-your-packages"><i class="fa fa-check"></i><b>17.5</b> Updating Your Packages</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html"><i class="fa fa-check"></i><b>18</b> Major R Updates (Where Are My Packages?)</a>
<ul>
<li class="chapter" data-level="18.1" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#when-to-upgrade-r"><i class="fa fa-check"></i><b>18.1</b> When to Upgrade R</a></li>
<li class="chapter" data-level="18.2" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#preparing-for-a-minor-or-major-r-upgrade"><i class="fa fa-check"></i><b>18.2</b> Preparing for a Minor or Major R Upgrade</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#before-you-upgrade-r"><i class="fa fa-check"></i><b>18.2.1</b> Before you upgrade R</a></li>
<li class="chapter" data-level="18.2.2" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#step-1-clean-up-old-unused-packages"><i class="fa fa-check"></i><b>18.2.2</b> STEP 1: Clean up old, unused packages</a></li>
<li class="chapter" data-level="18.2.3" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#step-2-build-a-dataframe-of-your-currently-installed-packages."><i class="fa fa-check"></i><b>18.2.3</b> STEP 2: Build a dataframe of your currently installed packages.</a></li>
<li class="chapter" data-level="18.2.4" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#step-3-removing-unwanted-packages-from-the-dataframe"><i class="fa fa-check"></i><b>18.2.4</b> STEP 3: Removing unwanted Packages from the dataframe</a></li>
<li class="chapter" data-level="18.2.5" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#step-4-upgrading-r-to-the-new-version"><i class="fa fa-check"></i><b>18.2.5</b> STEP 4: Upgrading R to the new Version</a></li>
<li class="chapter" data-level="18.2.6" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#step-5-upgrading-the-rstudio-version"><i class="fa fa-check"></i><b>18.2.6</b> STEP 5: Upgrading the RStudio Version</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#step-6-rebuilding-all-of-your-packages-in-one-automated-step"><i class="fa fa-check"></i><b>18.3</b> STEP 6: Rebuilding All of your Packages in One (Automated) Step</a></li>
<li class="chapter" data-level="18.4" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#checking-the-new-library-path"><i class="fa fa-check"></i><b>18.4</b> Checking the new library path</a></li>
<li class="chapter" data-level="18.5" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#now-check-your-list-of-packages"><i class="fa fa-check"></i><b>18.5</b> Now Check your list of Packages</a></li>
<li class="chapter" data-level="18.6" data-path="major-r-updates-where-are-my-packages.html"><a href="major-r-updates-where-are-my-packages.html#updating-packages"><i class="fa fa-check"></i><b>18.6</b> Updating Packages</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="intermediate-steps-toward-reproducibility.html"><a href="intermediate-steps-toward-reproducibility.html"><i class="fa fa-check"></i><b>19</b> Intermediate Steps Toward Reproducibility</a>
<ul>
<li class="chapter" data-level="19.1" data-path="intermediate-steps-toward-reproducibility.html"><a href="intermediate-steps-toward-reproducibility.html#level-3-reproducibility"><i class="fa fa-check"></i><b>19.1</b> Level 3 Reproducibility</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="intermediate-steps-toward-reproducibility.html"><a href="intermediate-steps-toward-reproducibility.html#creating-a-new-project-in-rstudio"><i class="fa fa-check"></i><b>19.1.1</b> Creating a New Project in RStudio</a></li>
<li class="chapter" data-level="19.1.2" data-path="intermediate-steps-toward-reproducibility.html"><a href="intermediate-steps-toward-reproducibility.html#file-paths-and-the-here-package"><i class="fa fa-check"></i><b>19.1.2</b> File paths and the {here} package</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="intermediate-steps-toward-reproducibility.html"><a href="intermediate-steps-toward-reproducibility.html#code-review-with-a-coding-partner"><i class="fa fa-check"></i><b>19.2</b> Code Review with a Coding Partner</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="intermediate-steps-toward-reproducibility.html"><a href="intermediate-steps-toward-reproducibility.html#checklist-for-code-review"><i class="fa fa-check"></i><b>19.2.1</b> Checklist for Code Review</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="intermediate-steps-toward-reproducibility.html"><a href="intermediate-steps-toward-reproducibility.html#sharing-code-on-github"><i class="fa fa-check"></i><b>19.3</b> Sharing code on GitHub</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html"><i class="fa fa-check"></i><b>20</b> Building Table One for a Clinical Study</a>
<ul>
<li class="chapter" data-level="20.1" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#packages-needed-for-this-chapter-3"><i class="fa fa-check"></i><b>20.1</b> Packages Needed for this Chapter:</a></li>
<li class="chapter" data-level="20.2" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#pathway-for-this-chapter-3"><i class="fa fa-check"></i><b>20.2</b> Pathway for this Chapter</a></li>
<li class="chapter" data-level="20.3" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#baseline-characteristics"><i class="fa fa-check"></i><b>20.3</b> Baseline Characteristics</a></li>
<li class="chapter" data-level="20.4" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#building-your-table-1"><i class="fa fa-check"></i><b>20.4</b> Building Your Table 1</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#updating-variable-labels"><i class="fa fa-check"></i><b>20.4.1</b> Updating Variable Labels</a></li>
<li class="chapter" data-level="20.4.2" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#updating-variable-values"><i class="fa fa-check"></i><b>20.4.2</b> Updating Variable Values</a></li>
<li class="chapter" data-level="20.4.3" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#table-1-separated-by-treatment-arm"><i class="fa fa-check"></i><b>20.4.3</b> Table 1 separated by Treatment Arm</a></li>
<li class="chapter" data-level="20.4.4" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#styling-our-table-1"><i class="fa fa-check"></i><b>20.4.4</b> Styling our Table 1</a></li>
<li class="chapter" data-level="20.4.5" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#adding-a-column-spanner"><i class="fa fa-check"></i><b>20.4.5</b> Adding A Column Spanner</a></li>
<li class="chapter" data-level="20.4.6" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#further-styling-our-table-1"><i class="fa fa-check"></i><b>20.4.6</b> Further Styling our Table 1</a></li>
<li class="chapter" data-level="20.4.7" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#your-turn"><i class="fa fa-check"></i><b>20.4.7</b> Your Turn</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#try-this-with-a-new-dataset"><i class="fa fa-check"></i><b>20.5</b> Try this with a new dataset</a></li>
<li class="chapter" data-level="20.6" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#making-modifications-to-the-trial-table"><i class="fa fa-check"></i><b>20.6</b> Making Modifications to the trial table</a></li>
<li class="chapter" data-level="20.7" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#more-modifications-to-the-trial-table"><i class="fa fa-check"></i><b>20.7</b> More Modifications to the trial table</a></li>
<li class="chapter" data-level="20.8" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#taking-control-of-the-stats"><i class="fa fa-check"></i><b>20.8</b> Taking Control of the Stats</a>
<ul>
<li class="chapter" data-level="20.8.1" data-path="building-table-one-for-a-clinical-study.html"><a href="building-table-one-for-a-clinical-study.html#your-turn-1"><i class="fa fa-check"></i><b>20.8.1</b> Your Turn</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="comparing-two-measures-of-centrality.html"><a href="comparing-two-measures-of-centrality.html"><i class="fa fa-check"></i><b>21</b> Comparing Two Measures of Centrality</a>
<ul>
<li class="chapter" data-level="21.0.1" data-path="comparing-two-measures-of-centrality.html"><a href="comparing-two-measures-of-centrality.html#applying-the-t-test"><i class="fa fa-check"></i><b>21.0.1</b> Applying the t test</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html"><i class="fa fa-check"></i><b>22</b> Simple example of a t-test</a>
<ul>
<li class="chapter" data-level="22.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#common-problem"><i class="fa fa-check"></i><b>22.1</b> Common Problem</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#how-skewed-is-too-skewed"><i class="fa fa-check"></i><b>22.1.1</b> How Skewed is Too Skewed?</a></li>
<li class="chapter" data-level="22.1.2" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#visualize-the-distribution-of-data-variables-in-ggplot"><i class="fa fa-check"></i><b>22.1.2</b> Visualize the Distribution of data variables in ggplot</a></li>
<li class="chapter" data-level="22.1.3" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#visualize-the-distribution-of-datalen-in-ggplot"><i class="fa fa-check"></i><b>22.1.3</b> Visualize the Distribution of data$len in ggplot</a></li>
<li class="chapter" data-level="22.1.4" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#results-of-shapiro-wilk"><i class="fa fa-check"></i><b>22.1.4</b> Results of Shapiro-Wilk</a></li>
<li class="chapter" data-level="22.1.5" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#try-it-yourself-1"><i class="fa fa-check"></i><b>22.1.5</b> Try it yourself</a></li>
<li class="chapter" data-level="22.1.6" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#mammal-sleep-hours"><i class="fa fa-check"></i><b>22.1.6</b> Mammal sleep hours</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#one-sample-t-test"><i class="fa fa-check"></i><b>22.2</b> One Sample T test</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#how-to-do-one-sample-t-test"><i class="fa fa-check"></i><b>22.2.1</b> How to do One Sample T test</a></li>
<li class="chapter" data-level="22.2.2" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#interpreting-the-one-sample-t-test"><i class="fa fa-check"></i><b>22.2.2</b> Interpreting the One Sample T test</a></li>
<li class="chapter" data-level="22.2.3" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#what-are-the-arguments-of-the-t.test-function"><i class="fa fa-check"></i><b>22.2.3</b> What are the arguments of the t.test function?</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#insert-flipbook-for-ttest-here"><i class="fa fa-check"></i><b>22.3</b> Insert flipbook for ttest here</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#flipbook-time"><i class="fa fa-check"></i><b>22.3.1</b> Flipbook Time!</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#fine-but-what-about-2-groups"><i class="fa fa-check"></i><b>22.4</b> Fine, but what about 2 groups?</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#setting-up-2-group-t-test"><i class="fa fa-check"></i><b>22.4.1</b> Setting up 2 group t test</a></li>
<li class="chapter" data-level="22.4.2" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#results-of-the-2-group-t-test"><i class="fa fa-check"></i><b>22.4.2</b> Results of the 2 group t test</a></li>
<li class="chapter" data-level="22.4.3" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#interpreting-the-2-group-t-test"><i class="fa fa-check"></i><b>22.4.3</b> Interpreting the 2 group t test</a></li>
<li class="chapter" data-level="22.4.4" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#group-t-test-with-wide-data"><i class="fa fa-check"></i><b>22.4.4</b> 2 group t test with wide data</a></li>
<li class="chapter" data-level="22.4.5" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#results-of-2-group-t-test-with-wide-data"><i class="fa fa-check"></i><b>22.4.5</b> Results of 2 group t test with wide data</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#assumptions-of-students-t-test"><i class="fa fa-check"></i><b>22.5</b> 3 Assumptions of Student’s t test</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#testing-assumptions-of-students-t-test"><i class="fa fa-check"></i><b>22.5.1</b> Testing Assumptions of Student’s t test</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#getting-results-out-of-t.test"><i class="fa fa-check"></i><b>22.6</b> Getting results out of t.test</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#getting-results-out-of-t.test-1"><i class="fa fa-check"></i><b>22.6.1</b> Getting results out of t.test</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#reporting-the-results-from-t.test-using-inline-code"><i class="fa fa-check"></i><b>22.7</b> Reporting the results from t.test using inline code</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="simple-example-of-a-t-test.html"><a href="simple-example-of-a-t-test.html#for-next-time"><i class="fa fa-check"></i><b>22.7.1</b> For Next Time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html"><i class="fa fa-check"></i><b>23</b> Sample Size Calculations with <code>{pwr}</code></a>
<ul>
<li class="chapter" data-level="23.1" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#sample-size-for-a-continuous-endpoint-t-test"><i class="fa fa-check"></i><b>23.1</b> Sample Size for a Continuous Endpoint (t-test)</a></li>
<li class="chapter" data-level="23.2" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#one-sample-t-test-for-lowering-creatinine"><i class="fa fa-check"></i><b>23.2</b> One Sample t-test for Lowering Creatinine</a></li>
<li class="chapter" data-level="23.3" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#paired-t-tests-before-vs-after-or-truly-paired"><i class="fa fa-check"></i><b>23.3</b> Paired t-tests (before vs after, or truly paired)</a></li>
<li class="chapter" data-level="23.4" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#sample-t-tests-with-unequal-study-arm-sizes"><i class="fa fa-check"></i><b>23.4</b> 2 Sample t tests with Unequal Study Arm Sizes</a></li>
<li class="chapter" data-level="23.5" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#testing-multiple-options-and-plotting-results"><i class="fa fa-check"></i><b>23.5</b> Testing Multiple Options and Plotting Results</a></li>
<li class="chapter" data-level="23.6" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#your-turn-2"><i class="fa fa-check"></i><b>23.6</b> Your Turn</a></li>
<li class="chapter" data-level="23.6.1" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#scenario-1-fev1-in-copd"><i class="fa fa-check"></i><b>23.6.1</b> Scenario 1: FEV1 in COPD</a></li>
<li class="chapter" data-level="23.6.2" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#scenario-2-bnp-in-chf"><i class="fa fa-check"></i><b>23.6.2</b> Scenario 2: BNP in CHF</a></li>
<li class="chapter" data-level="23.6.3" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#scenario-3-barthel-index-in-stroke"><i class="fa fa-check"></i><b>23.6.3</b> Scenario 3: Barthel Index in Stroke</a></li>
<li class="chapter" data-level="23.7" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#sample-sizes-for-proportions"><i class="fa fa-check"></i><b>23.7</b> Sample Sizes for Proportions</a></li>
<li class="chapter" data-level="23.8" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#sample-size-for-two-proportions-equal-n"><i class="fa fa-check"></i><b>23.8</b> Sample size for two proportions, equal n</a></li>
<li class="chapter" data-level="23.9" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#sample-size-for-two-proportions-unequal-arms"><i class="fa fa-check"></i><b>23.9</b> Sample size for two proportions, unequal arms</a></li>
<li class="chapter" data-level="23.10" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#your-turn-3"><i class="fa fa-check"></i><b>23.10</b> Your Turn</a></li>
<li class="chapter" data-level="23.10.1" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#scenario-1-mortality-on-renal-dialysis"><i class="fa fa-check"></i><b>23.10.1</b> Scenario 1: Mortality on Renal Dialysis</a></li>
<li class="chapter" data-level="23.10.2" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#scenario-2-intestinal-anastomosis-in-crohns-disease"><i class="fa fa-check"></i><b>23.10.2</b> Scenario 2: Intestinal anastomosis in Crohn’s disease</a></li>
<li class="chapter" data-level="23.10.3" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#scenario-3-metformin-in-donuts"><i class="fa fa-check"></i><b>23.10.3</b> Scenario 3: Metformin in Donuts</a></li>
<li class="chapter" data-level="23.11" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#add-chi-square"><i class="fa fa-check"></i><b>23.11</b> add chi square</a></li>
<li class="chapter" data-level="23.12" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#add-correlation-test"><i class="fa fa-check"></i><b>23.12</b> add correlation test</a></li>
<li class="chapter" data-level="23.13" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#add-anova"><i class="fa fa-check"></i><b>23.13</b> add anova</a></li>
<li class="chapter" data-level="23.14" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#add-linear-model"><i class="fa fa-check"></i><b>23.14</b> add linear model</a></li>
<li class="chapter" data-level="23.15" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#add-note-on-guessing-effect-sizes---cohen-small-medium-large"><i class="fa fa-check"></i><b>23.15</b> add note on guessing effect sizes - cohen small, medium, large</a></li>
<li class="chapter" data-level="23.16" data-path="sample-size-calculations-with-pwr.html"><a href="sample-size-calculations-with-pwr.html#explore-more"><i class="fa fa-check"></i><b>23.16</b> Explore More</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="randomization-for-clinical-trials-with-r.html"><a href="randomization-for-clinical-trials-with-r.html"><i class="fa fa-check"></i><b>24</b> Randomization for Clinical Trials with R</a>
<ul>
<li class="chapter" data-level="24.1" data-path="randomization-for-clinical-trials-with-r.html"><a href="randomization-for-clinical-trials-with-r.html#printing-these-on-cards"><i class="fa fa-check"></i><b>24.1</b> Printing these on Cards</a></li>
<li class="chapter" data-level="24.2" data-path="randomization-for-clinical-trials-with-r.html"><a href="randomization-for-clinical-trials-with-r.html#now-try-this-yourself"><i class="fa fa-check"></i><b>24.2</b> Now, try this yourself</a></li>
<li class="chapter" data-level="24.3" data-path="randomization-for-clinical-trials-with-r.html"><a href="randomization-for-clinical-trials-with-r.html#now-freestyle"><i class="fa fa-check"></i><b>24.3</b> Now Freestyle</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html"><i class="fa fa-check"></i><b>25</b> Univariate ggplots to Visualize Distributions</a>
<ul>
<li class="chapter" data-level="25.1" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#histograms"><i class="fa fa-check"></i><b>25.1</b> Histograms</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#comparisons-of-distributions-with-histograms"><i class="fa fa-check"></i><b>25.1.1</b> Comparisons of Distributions with Histograms</a></li>
<li class="chapter" data-level="25.1.2" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#histograms-and-categories"><i class="fa fa-check"></i><b>25.1.2</b> Histograms and Categories</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#density-plots"><i class="fa fa-check"></i><b>25.2</b> Density Plots</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#comparisons-with-density-plots"><i class="fa fa-check"></i><b>25.2.1</b> Comparisons with Density plots</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#comparing-distributions-across-categories"><i class="fa fa-check"></i><b>25.3</b> Comparing Distributions Across Categories</a></li>
<li class="chapter" data-level="25.4" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#boxplots"><i class="fa fa-check"></i><b>25.4</b> Boxplots</a></li>
<li class="chapter" data-level="25.5" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#violin-plots"><i class="fa fa-check"></i><b>25.5</b> Violin Plots</a></li>
<li class="chapter" data-level="25.6" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#ridgeline-plots"><i class="fa fa-check"></i><b>25.6</b> Ridgeline Plots</a>
<ul>
<li class="chapter" data-level="25.6.1" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#including-plots"><i class="fa fa-check"></i><b>25.6.1</b> Including Plots</a></li>
<li class="chapter" data-level="25.6.2" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#including-points"><i class="fa fa-check"></i><b>25.6.2</b> Including Points</a></li>
<li class="chapter" data-level="25.6.3" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#including-points-1"><i class="fa fa-check"></i><b>25.6.3</b> Including Points</a></li>
<li class="chapter" data-level="25.6.4" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#including-points-2"><i class="fa fa-check"></i><b>25.6.4</b> Including Points</a></li>
<li class="chapter" data-level="25.6.5" data-path="univariate-ggplots-to-visualize-distributions.html"><a href="univariate-ggplots-to-visualize-distributions.html#including-points-3"><i class="fa fa-check"></i><b>25.6.5</b> Including Points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><i class="fa fa-check"></i><b>26</b> Bivariate ggplot2 Scatterplots to Visualize Relationships Between Variables</a>
<ul>
<li class="chapter" data-level="26.1" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#packages-used-in-this-chapter"><i class="fa fa-check"></i><b>26.1</b> Packages used in this Chapter</a></li>
<li class="chapter" data-level="26.2" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#data-exploration-and-validation-dev"><i class="fa fa-check"></i><b>26.2</b> Data Exploration and Validation (DEV)</a></li>
<li class="chapter" data-level="26.3" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#scatterplots"><i class="fa fa-check"></i><b>26.3</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#micro-quiz"><i class="fa fa-check"></i><b>26.3.1</b> Micro-quiz!</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#mapping-more-variables"><i class="fa fa-check"></i><b>26.4</b> Mapping More Variables</a></li>
<li class="chapter" data-level="26.5" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#inheritance-and-layering-in-ggplot2"><i class="fa fa-check"></i><b>26.5</b> Inheritance and Layering in ggplot2</a></li>
<li class="chapter" data-level="26.6" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#aesthetic-mapping-micro-quiz"><i class="fa fa-check"></i><b>26.6</b> Aesthetic mapping Micro-Quiz!</a></li>
<li class="chapter" data-level="26.7" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#controlling-point-shape-size-and-color-manually"><i class="fa fa-check"></i><b>26.7</b> Controlling Point Shape, Size, and Color Manually</a>
<ul>
<li class="chapter" data-level="26.7.1" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#manual-shapes"><i class="fa fa-check"></i><b>26.7.1</b> Manual Shapes</a></li>
<li class="chapter" data-level="26.7.2" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#manual-sizes"><i class="fa fa-check"></i><b>26.7.2</b> Manual Sizes</a></li>
<li class="chapter" data-level="26.7.3" data-path="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html"><a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html#manual-color"><i class="fa fa-check"></i><b>26.7.3</b> Manual Color</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="27" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html"><i class="fa fa-check"></i><b>27</b> Extensions to ggplot</a>
<ul>
<li class="chapter" data-level="27.1" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#goals-for-this-chapter-4"><i class="fa fa-check"></i><b>27.1</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="27.2" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#packages-needed-for-this-chapter-4"><i class="fa fa-check"></i><b>27.2</b> Packages Needed for this chapter</a></li>
<li class="chapter" data-level="27.3" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#a-flipbook-of-where-we-are-going-with-ggplot-extensions"><i class="fa fa-check"></i><b>27.3</b> A Flipbook of Where We Are Going With ggplot Extensions</a>
<ul>
<li class="chapter" data-level="27.3.1" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#make-flipbook"><i class="fa fa-check"></i><b>27.3.1</b> MAKE FLIPBOOK</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#a-waffle-plot"><i class="fa fa-check"></i><b>27.4</b> A Waffle Plot</a></li>
<li class="chapter" data-level="27.5" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#an-alluvial-plot"><i class="fa fa-check"></i><b>27.5</b> An Alluvial Plot</a></li>
<li class="chapter" data-level="27.6" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#lollipop-plots"><i class="fa fa-check"></i><b>27.6</b> Lollipop Plots</a></li>
<li class="chapter" data-level="27.7" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#dumbbell-plots"><i class="fa fa-check"></i><b>27.7</b> Dumbbell Plots</a></li>
<li class="chapter" data-level="27.8" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#spaghetti-plots-with-summary-smoothed-lines-for-change-over-time"><i class="fa fa-check"></i><b>27.8</b> Spaghetti Plots with Summary Smoothed Lines for Change Over Time</a></li>
<li class="chapter" data-level="27.9" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#swimmer-plots"><i class="fa fa-check"></i><b>27.9</b> Swimmer Plots</a></li>
<li class="chapter" data-level="27.10" data-path="extensions-to-ggplot.html"><a href="extensions-to-ggplot.html#adding-significance-comparisons-with-ggsignif"><i class="fa fa-check"></i><b>27.10</b> Adding Significance Comparisons with {ggsignif}</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html"><i class="fa fa-check"></i><b>28</b> Customizing Plot Scales</a>
<ul>
<li class="chapter" data-level="28.1" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#goals-for-this-chapter-5"><i class="fa fa-check"></i><b>28.1</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="28.2" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#packages-needed-for-this-chapter-5"><i class="fa fa-check"></i><b>28.2</b> Packages Needed for this chapter</a></li>
<li class="chapter" data-level="28.3" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#a-flipbook-of-where-we-are-going-with-scales"><i class="fa fa-check"></i><b>28.3</b> A Flipbook of Where We Are Going With Scales</a></li>
<li class="chapter" data-level="28.4" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#a-basic-scatterplot"><i class="fa fa-check"></i><b>28.4</b> A Basic Scatterplot</a></li>
<li class="chapter" data-level="28.5" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#but-what-if-you-want-the-scale-for-risk-to-start-at-0"><i class="fa fa-check"></i><b>28.5</b> But what if you want the scale for risk to start at 0?</a></li>
<li class="chapter" data-level="28.6" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#but-this-axis-does-not-really-start-at-exactly-0"><i class="fa fa-check"></i><b>28.6</b> But this axis does not really start at Exactly 0</a></li>
<li class="chapter" data-level="28.7" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#control-the-limits-and-the-breaks"><i class="fa fa-check"></i><b>28.7</b> Control the Limits and the Breaks</a></li>
<li class="chapter" data-level="28.8" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#test-what-you-have-learned"><i class="fa fa-check"></i><b>28.8</b> Test what you have learned</a></li>
<li class="chapter" data-level="28.9" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#continuous-vs.-discrete-plots-and-scales"><i class="fa fa-check"></i><b>28.9</b> Continuous vs. Discrete Plots and Scales</a></li>
<li class="chapter" data-level="28.10" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#using-scales-to-customize-a-legend"><i class="fa fa-check"></i><b>28.10</b> Using Scales to Customize a Legend</a></li>
<li class="chapter" data-level="28.11" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#test-what-you-have-learned-1"><i class="fa fa-check"></i><b>28.11</b> Test what you have learned</a>
<ul>
<li class="chapter" data-level="28.11.1" data-path="customizing-plot-scales.html"><a href="customizing-plot-scales.html#more-examples-with-flipbooks"><i class="fa fa-check"></i><b>28.11.1</b> More Examples with Flipbooks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="29" data-path="helping-out-with-ggplot.html"><a href="helping-out-with-ggplot.html"><i class="fa fa-check"></i><b>29</b> Helping out with ggplot</a>
<ul>
<li class="chapter" data-level="29.1" data-path="helping-out-with-ggplot.html"><a href="helping-out-with-ggplot.html#ggxgghelp"><i class="fa fa-check"></i><b>29.1</b> ggx::gghelp()</a></li>
<li class="chapter" data-level="29.2" data-path="helping-out-with-ggplot.html"><a href="helping-out-with-ggplot.html#getting-more-help-with-theming-with-ggthemeassist"><i class="fa fa-check"></i><b>29.2</b> Getting more help with theming with ggThemeAssist</a></li>
<li class="chapter" data-level="29.3" data-path="helping-out-with-ggplot.html"><a href="helping-out-with-ggplot.html#website-helpers-for-ggplot"><i class="fa fa-check"></i><b>29.3</b> Website helpers for ggplot</a></li>
<li class="chapter" data-level="29.4" data-path="helping-out-with-ggplot.html"><a href="helping-out-with-ggplot.html#getting-even-more-help-with-esquisse"><i class="fa fa-check"></i><b>29.4</b> Getting Even more help with esquisse</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>30</b> Functions</a>
<ul>
<li class="chapter" data-level="30.1" data-path="functions-1.html"><a href="functions-1.html#dont-repeat-yourself"><i class="fa fa-check"></i><b>30.1</b> Don’t repeat yourself</a></li>
<li class="chapter" data-level="30.2" data-path="functions-1.html"><a href="functions-1.html#your-turn-4"><i class="fa fa-check"></i><b>30.2</b> Your Turn</a></li>
<li class="chapter" data-level="30.3" data-path="functions-1.html"><a href="functions-1.html#freestyle"><i class="fa fa-check"></i><b>30.3</b> Freestyle</a>
<ul>
<li class="chapter" data-level="30.3.1" data-path="functions-1.html"><a href="functions-1.html#acknowledgement"><i class="fa fa-check"></i><b>30.3.1</b> Acknowledgement</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="functions-1.html"><a href="functions-1.html#read-more"><i class="fa fa-check"></i><b>30.4</b> Read More</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="using-found-web-data.html"><a href="using-found-web-data.html"><i class="fa fa-check"></i><b>31</b> Using Found (Web) Data</a>
<ul>
<li class="chapter" data-level="31.1" data-path="using-found-web-data.html"><a href="using-found-web-data.html#found-poetry"><i class="fa fa-check"></i><b>31.1</b> Found Poetry</a></li>
<li class="chapter" data-level="31.2" data-path="using-found-web-data.html"><a href="using-found-web-data.html#found-data"><i class="fa fa-check"></i><b>31.2</b> Found Data</a></li>
<li class="chapter" data-level="31.3" data-path="using-found-web-data.html"><a href="using-found-web-data.html#download-example"><i class="fa fa-check"></i><b>31.3</b> Download Example</a></li>
<li class="chapter" data-level="31.4" data-path="using-found-web-data.html"><a href="using-found-web-data.html#datapasta-small-table-example"><i class="fa fa-check"></i><b>31.4</b> Datapasta (small table) Example</a></li>
<li class="chapter" data-level="31.5" data-path="using-found-web-data.html"><a href="using-found-web-data.html#your-turn-5"><i class="fa fa-check"></i><b>31.5</b> Your Turn</a></li>
<li class="chapter" data-level="31.6" data-path="using-found-web-data.html"><a href="using-found-web-data.html#rvest-example"><i class="fa fa-check"></i><b>31.6</b> {rvest} Example</a></li>
<li class="chapter" data-level="31.7" data-path="using-found-web-data.html"><a href="using-found-web-data.html#your-turn-6"><i class="fa fa-check"></i><b>31.7</b> Your Turn</a></li>
<li class="chapter" data-level="31.8" data-path="using-found-web-data.html"><a href="using-found-web-data.html#api-example-with-tidycensus"><i class="fa fa-check"></i><b>31.8</b> API example with {tidycensus}</a></li>
<li class="chapter" data-level="31.9" data-path="using-found-web-data.html"><a href="using-found-web-data.html#challenges-1"><i class="fa fa-check"></i><b>31.9</b> Challenges</a></li>
<li class="chapter" data-level="31.10" data-path="using-found-web-data.html"><a href="using-found-web-data.html#advanced-challenge---dynamic-websites"><i class="fa fa-check"></i><b>31.10</b> Advanced Challenge - Dynamic Websites</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html"><i class="fa fa-check"></i><b>32</b> Linear Regression and Broom for Tidying Models</a>
<ul>
<li class="chapter" data-level="32.1" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#packages-needed"><i class="fa fa-check"></i><b>32.1</b> Packages needed</a></li>
<li class="chapter" data-level="32.2" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#building-a-simple-base-model-with-lm"><i class="fa fa-check"></i><b>32.2</b> Building a simple base model with {lm}</a>
<ul>
<li class="chapter" data-level="32.2.1" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#producing-manuscript-quality-tables-with-gtsummary"><i class="fa fa-check"></i><b>32.2.1</b> Producing manuscript-quality tables with {gtsummary}</a></li>
</ul></li>
<li class="chapter" data-level="32.3" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#is-your-model-valid"><i class="fa fa-check"></i><b>32.3</b> Is Your Model Valid?</a></li>
<li class="chapter" data-level="32.4" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#making-predictions-with-your-model"><i class="fa fa-check"></i><b>32.4</b> Making Predictions with Your Model</a>
<ul>
<li class="chapter" data-level="32.4.1" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#predictions-from-new-data"><i class="fa fa-check"></i><b>32.4.1</b> Predictions from new data</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#choosing-predictors-for-multivariate-modeling-testing-dealing-with-collinearity"><i class="fa fa-check"></i><b>32.5</b> Choosing predictors for multivariate modeling – testing, dealing with collinearity</a>
<ul>
<li class="chapter" data-level="32.5.1" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#challenges-2"><i class="fa fa-check"></i><b>32.5.1</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="32.6" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#presenting-model-results-with-rmarkdown"><i class="fa fa-check"></i><b>32.6</b> presenting model results with RMarkdown</a>
<ul>
<li class="chapter" data-level="32.6.1" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#challenges-3"><i class="fa fa-check"></i><b>32.6.1</b> Challenges</a></li>
</ul></li>
<li class="chapter" data-level="32.7" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#presenting-model-results-with-a-shiny-app"><i class="fa fa-check"></i><b>32.7</b> presenting model results with a Shiny App</a>
<ul>
<li class="chapter" data-level="32.7.1" data-path="linear-regression-and-broom-for-tidying-models.html"><a href="linear-regression-and-broom-for-tidying-models.html#challenges-4"><i class="fa fa-check"></i><b>32.7.1</b> Challenges</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="33" data-path="logistic-regression-and-broom-for-tidying-models.html"><a href="logistic-regression-and-broom-for-tidying-models.html"><i class="fa fa-check"></i><b>33</b> Logistic Regression and Broom for Tidying Models</a>
<ul>
<li class="chapter" data-level="33.1" data-path="logistic-regression-and-broom-for-tidying-models.html"><a href="logistic-regression-and-broom-for-tidying-models.html#the-model-summary"><i class="fa fa-check"></i><b>33.1</b> The Model Summary</a></li>
<li class="chapter" data-level="33.2" data-path="logistic-regression-and-broom-for-tidying-models.html"><a href="logistic-regression-and-broom-for-tidying-models.html#evaluating-your-model-assumptions"><i class="fa fa-check"></i><b>33.2</b> Evaluating your Model Assumptions</a></li>
<li class="chapter" data-level="33.3" data-path="logistic-regression-and-broom-for-tidying-models.html"><a href="logistic-regression-and-broom-for-tidying-models.html#converting-between-logit-odds-ratios-and-probability"><i class="fa fa-check"></i><b>33.3</b> Converting between logit, odds ratios, and probability</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html"><i class="fa fa-check"></i><b>34</b> Fast and Frugal Trees with the {FFTrees} Package</a>
<ul>
<li class="chapter" data-level="34.1" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#setup"><i class="fa fa-check"></i><b>34.1</b> Setup</a></li>
<li class="chapter" data-level="34.2" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#the-breast-cancer-dataset"><i class="fa fa-check"></i><b>34.2</b> The Breast Cancer Dataset</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#data-inspection"><i class="fa fa-check"></i><b>34.2.1</b> Data Inspection</a></li>
<li class="chapter" data-level="34.2.2" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#check-your-progress"><i class="fa fa-check"></i><b>34.2.2</b> Check Your Progress</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#building-a-fftrees-model-for-breast-cancer"><i class="fa fa-check"></i><b>34.3</b> Building a FFTrees Model for Breast Cancer</a></li>
<li class="chapter" data-level="34.4" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#your-turn-with-heart-disease-data"><i class="fa fa-check"></i><b>34.4</b> Your Turn with Heart Disease Data</a>
<ul>
<li class="chapter" data-level="34.4.1" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#test-what-you-have-learned-2"><i class="fa fa-check"></i><b>34.4.1</b> Test what you have learned</a></li>
</ul></li>
<li class="chapter" data-level="34.5" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#your-turn-to-build-and-interpret-a-model"><i class="fa fa-check"></i><b>34.5</b> Your Turn to Build and Interpret a Model</a></li>
<li class="chapter" data-level="34.6" data-path="fast-and-frugal-trees-with-the-fftrees-package.html"><a href="fast-and-frugal-trees-with-the-fftrees-package.html#now-build-your-fftrees-model-to-predict-improved-status-vs.-death"><i class="fa fa-check"></i><b>34.6</b> Now build your FFTrees model to predict improved status (vs. death)</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html"><i class="fa fa-check"></i><b>35</b> A Gentle Introduction to Shiny</a>
<ul>
<li class="chapter" data-level="35.1" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#what-is-shiny"><i class="fa fa-check"></i><b>35.1</b> What is Shiny?</a></li>
<li class="chapter" data-level="35.2" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#the-basic-structure-of-a-shiny-app"><i class="fa fa-check"></i><b>35.2</b> The Basic Structure of a Shiny App</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#the-weirdness-of-a-shiny-app"><i class="fa fa-check"></i><b>35.2.1</b> The weirdness of a Shiny app</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#the-user-interface-section-structure"><i class="fa fa-check"></i><b>35.3</b> The User Interface Section Structure</a></li>
<li class="chapter" data-level="35.4" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#the-server-section-structure"><i class="fa fa-check"></i><b>35.4</b> The Server Section Structure</a></li>
<li class="chapter" data-level="35.5" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#how-to-run-an-app"><i class="fa fa-check"></i><b>35.5</b> How to Run an App</a>
<ul>
<li class="chapter" data-level="35.5.1" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#how-to-stop-an-app"><i class="fa fa-check"></i><b>35.5.1</b> How to Stop an App</a></li>
</ul></li>
<li class="chapter" data-level="35.6" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#building-a-very-simple-app-version-1"><i class="fa fa-check"></i><b>35.6</b> Building a Very Simple App (Version 1)</a>
<ul>
<li class="chapter" data-level="35.6.1" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#the-ui-section"><i class="fa fa-check"></i><b>35.6.1</b> The ui section</a></li>
<li class="chapter" data-level="35.6.2" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#the-server-section"><i class="fa fa-check"></i><b>35.6.2</b> The server section</a></li>
</ul></li>
<li class="chapter" data-level="35.7" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#edit-this-app-version-2"><i class="fa fa-check"></i><b>35.7</b> Edit this App (Version 2)</a></li>
<li class="chapter" data-level="35.8" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#building-a-user-interface-for-inputs-and-outputs"><i class="fa fa-check"></i><b>35.8</b> Building a User Interface for Inputs and Outputs</a>
<ul>
<li class="chapter" data-level="35.8.1" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#inputs"><i class="fa fa-check"></i><b>35.8.1</b> Inputs</a></li>
<li class="chapter" data-level="35.8.2" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#outputs"><i class="fa fa-check"></i><b>35.8.2</b> Outputs</a></li>
</ul></li>
<li class="chapter" data-level="35.9" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#building-a-functioning-server-section"><i class="fa fa-check"></i><b>35.9</b> Building a Functioning Server Section</a>
<ul>
<li class="chapter" data-level="35.9.1" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#using-the-input-values-data"><i class="fa fa-check"></i><b>35.9.1</b> Using the input values &amp; Data</a></li>
<li class="chapter" data-level="35.9.2" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#wrangling-and-calculating"><i class="fa fa-check"></i><b>35.9.2</b> Wrangling and Calculating</a></li>
<li class="chapter" data-level="35.9.3" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#rendering-to-html-outputs"><i class="fa fa-check"></i><b>35.9.3</b> Rendering to HTML Outputs</a></li>
</ul></li>
<li class="chapter" data-level="35.10" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#building-a-simple-shiny-app-version-3"><i class="fa fa-check"></i><b>35.10</b> Building a Simple Shiny App (Version 3)</a></li>
<li class="chapter" data-level="35.11" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#publishing-your-shiny-app-on-the-web"><i class="fa fa-check"></i><b>35.11</b> Publishing Your Shiny App on the Web</a></li>
<li class="chapter" data-level="35.12" data-path="a-gentle-introduction-to-shiny.html"><a href="a-gentle-introduction-to-shiny.html#more-to-explore"><i class="fa fa-check"></i><b>35.12</b> More to Explore</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html"><i class="fa fa-check"></i><b>36</b> Sharing Models with Shiny</a>
<ul>
<li class="chapter" data-level="36.0.1" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#packages-needed-for-this-chapter-6"><i class="fa fa-check"></i><b>36.0.1</b> Packages Needed for this Chapter</a></li>
<li class="chapter" data-level="36.1" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#setting-up-and-saving-models"><i class="fa fa-check"></i><b>36.1</b> Setting up and Saving Models</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#linear-model"><i class="fa fa-check"></i><b>36.1.1</b> Linear Model</a></li>
<li class="chapter" data-level="36.1.2" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#logistic-model"><i class="fa fa-check"></i><b>36.1.2</b> Logistic Model</a></li>
<li class="chapter" data-level="36.1.3" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#random-forest-model"><i class="fa fa-check"></i><b>36.1.3</b> Random Forest Model</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#building-a-shiny-app-for-the-linear-model"><i class="fa fa-check"></i><b>36.2</b> Building a Shiny App for the Linear Model</a>
<ul>
<li class="chapter" data-level="36.2.1" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#the-default-shiny-app"><i class="fa fa-check"></i><b>36.2.1</b> The Default Shiny App</a></li>
<li class="chapter" data-level="36.2.2" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#editing-the-ui-sidebarpanel-for-the-input-predictor-variables"><i class="fa fa-check"></i><b>36.2.2</b> Editing the <strong>ui</strong> <em>sidebarPanel</em> for the Input Predictor Variables</a></li>
<li class="chapter" data-level="36.2.3" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#editing-the-server-section-to-make-predictions"><i class="fa fa-check"></i><b>36.2.3</b> Editing the <em>server</em> section to make Predictions</a></li>
<li class="chapter" data-level="36.2.4" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#editing-the-mainpanel-in-the-ui-section-to-display-your-prediction"><i class="fa fa-check"></i><b>36.2.4</b> Editing the mainPanel in the ui section to display your Prediction</a></li>
</ul></li>
<li class="chapter" data-level="36.3" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#building-a-shiny-app-for-the-logistic-model"><i class="fa fa-check"></i><b>36.3</b> Building a Shiny App for the Logistic Model</a>
<ul>
<li class="chapter" data-level="36.3.1" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#the-default-shiny-app-1"><i class="fa fa-check"></i><b>36.3.1</b> The Default Shiny App</a></li>
<li class="chapter" data-level="36.3.2" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#editing-the-ui-sidebarpanel-for-the-input-predictor-variables-1"><i class="fa fa-check"></i><b>36.3.2</b> Editing the <strong>ui</strong> <em>sidebarPanel</em> for the Input Predictor Variables</a></li>
<li class="chapter" data-level="36.3.3" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#editing-the-server-section-to-make-predictions-1"><i class="fa fa-check"></i><b>36.3.3</b> Editing the <em>server</em> section to make Predictions</a></li>
<li class="chapter" data-level="36.3.4" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#editing-the-mainpanel-in-the-ui-section-to-display-your-prediction-1"><i class="fa fa-check"></i><b>36.3.4</b> Editing the mainPanel in the ui section to display your Prediction</a></li>
</ul></li>
<li class="chapter" data-level="36.4" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#building-a-shiny-app-for-the-random-forest-model"><i class="fa fa-check"></i><b>36.4</b> Building a Shiny App for the Random Forest Model</a></li>
<li class="chapter" data-level="36.5" data-path="sharing-models-with-shiny.html"><a href="sharing-models-with-shiny.html#challenge-yourself"><i class="fa fa-check"></i><b>36.5</b> Challenge Yourself</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html"><i class="fa fa-check"></i><b>37</b> Introduction to R Markdown</a>
<ul>
<li class="chapter" data-level="37.1" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#what-makes-an-rmarkdown-document"><i class="fa fa-check"></i><b>37.1</b> What Makes an Rmarkdown document?</a></li>
<li class="chapter" data-level="37.2" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#trying-out-rmarkdown-with-a-mock-manuscript"><i class="fa fa-check"></i><b>37.2</b> Trying out RMarkdown with a Mock Manuscript</a></li>
<li class="chapter" data-level="37.3" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#inserting-code-chunks"><i class="fa fa-check"></i><b>37.3</b> Inserting Code Chunks</a>
<ul>
<li class="chapter" data-level="37.3.1" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#code-chunk-icons"><i class="fa fa-check"></i><b>37.3.1</b> Code Chunk Icons</a></li>
</ul></li>
<li class="chapter" data-level="37.4" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#including-plots-1"><i class="fa fa-check"></i><b>37.4</b> Including Plots</a></li>
<li class="chapter" data-level="37.5" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#including-tables"><i class="fa fa-check"></i><b>37.5</b> Including Tables</a></li>
<li class="chapter" data-level="37.6" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#including-links-and-images"><i class="fa fa-check"></i><b>37.6</b> Including Links and Images</a>
<ul>
<li class="chapter" data-level="37.6.1" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#links"><i class="fa fa-check"></i><b>37.6.1</b> Links</a></li>
<li class="chapter" data-level="37.6.2" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#images"><i class="fa fa-check"></i><b>37.6.2</b> Images</a></li>
</ul></li>
<li class="chapter" data-level="37.7" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#other-languages-in-code-chunks"><i class="fa fa-check"></i><b>37.7</b> Other languages in code chunks</a></li>
<li class="chapter" data-level="37.8" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#code-chunk-options"><i class="fa fa-check"></i><b>37.8</b> Code Chunk Options</a></li>
<li class="chapter" data-level="37.9" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#how-it-all-rmarkdown-knitr-pandoc-works"><i class="fa fa-check"></i><b>37.9</b> How It All (Rmarkdown + {knitr} + Pandoc) Works</a></li>
<li class="chapter" data-level="37.10" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#knitting-and-editing-and-re-knitting-your-rmd-document"><i class="fa fa-check"></i><b>37.10</b> Knitting and Editing (and re-Knitting() Your Rmd document</a></li>
<li class="chapter" data-level="37.11" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#try-out-other-chunk-options"><i class="fa fa-check"></i><b>37.11</b> Try Out Other Chunk Options</a></li>
<li class="chapter" data-level="37.12" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#the-setup-chunk"><i class="fa fa-check"></i><b>37.12</b> The <code>setup</code> chunk</a></li>
<li class="chapter" data-level="37.13" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#markdown-syntax"><i class="fa fa-check"></i><b>37.13</b> Markdown syntax</a></li>
<li class="chapter" data-level="37.14" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#nd-header"><i class="fa fa-check"></i><b>37.14</b> 2nd Header</a>
<ul>
<li class="chapter" data-level="37.14.1" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#rd-header"><i class="fa fa-check"></i><b>37.14.1</b> 3rd Header</a></li>
</ul></li>
<li class="chapter" data-level="37.15" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#line-breaks-and-page-breaks"><i class="fa fa-check"></i><b>37.15</b> Line Breaks and Page Breaks</a></li>
<li class="chapter" data-level="37.16" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#making-lists"><i class="fa fa-check"></i><b>37.16</b> Making Lists</a>
<ul>
<li class="chapter" data-level="37.16.1" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#ordered-lists"><i class="fa fa-check"></i><b>37.16.1</b> Ordered Lists</a></li>
<li class="chapter" data-level="37.16.2" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#un-ordered-lists"><i class="fa fa-check"></i><b>37.16.2</b> Un-ordered lists</a></li>
<li class="chapter" data-level="37.16.3" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#nested-lists"><i class="fa fa-check"></i><b>37.16.3</b> Nested Lists</a></li>
</ul></li>
<li class="chapter" data-level="37.17" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#the-easy-button---visual-markdown-editing"><i class="fa fa-check"></i><b>37.17</b> The Easy Button - Visual Markdown Editing</a>
<ul>
<li class="chapter" data-level="37.17.1" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#try-inserting-a-list-a-table-and-a-block-quote"><i class="fa fa-check"></i><b>37.17.1</b> Try inserting a list, a table and a block-quote</a></li>
</ul></li>
<li class="chapter" data-level="37.18" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#inline-code"><i class="fa fa-check"></i><b>37.18</b> Inline Code</a>
<ul>
<li class="chapter" data-level="37.18.1" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#try-inserting-some-in-line-r-code"><i class="fa fa-check"></i><b>37.18.1</b> Try inserting some in-line R code</a></li>
</ul></li>
<li class="chapter" data-level="37.19" data-path="introduction-to-r-markdown.html"><a href="introduction-to-r-markdown.html#a-quick-quiz"><i class="fa fa-check"></i><b>37.19</b> A Quick Quiz</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html"><i class="fa fa-check"></i><b>38</b> Rmarkdown Output Options</a>
<ul>
<li class="chapter" data-level="38.1" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#microsoft-word-output-from-rmarkdown"><i class="fa fa-check"></i><b>38.1</b> Microsoft Word Output from Rmarkdown</a>
<ul>
<li class="chapter" data-level="38.1.1" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#making-a-styles-reference-file-for-microsoft-word"><i class="fa fa-check"></i><b>38.1.1</b> Making a Styles Reference File for Microsoft Word</a></li>
<li class="chapter" data-level="38.1.2" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#lets-practice-this."><i class="fa fa-check"></i><b>38.1.2</b> Let’s Practice This.</a></li>
<li class="chapter" data-level="38.1.3" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#re-formatting-your-template"><i class="fa fa-check"></i><b>38.1.3</b> Re-formatting Your Template</a></li>
<li class="chapter" data-level="38.1.4" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#using-your-new-styles-template"><i class="fa fa-check"></i><b>38.1.4</b> Using Your New Styles Template</a></li>
<li class="chapter" data-level="38.1.5" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#now-you-are-ready"><i class="fa fa-check"></i><b>38.1.5</b> Now you are ready!</a></li>
</ul></li>
<li class="chapter" data-level="38.2" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#pdf-output-from-rmarkdown"><i class="fa fa-check"></i><b>38.2</b> PDF Output from RMarkdown</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#latex-and-tinytex"><i class="fa fa-check"></i><b>38.2.1</b> LaTeX and tinytex</a></li>
<li class="chapter" data-level="38.2.2" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#knitting-to-pdf"><i class="fa fa-check"></i><b>38.2.2</b> Knitting to PDF</a></li>
</ul></li>
<li class="chapter" data-level="38.3" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#microsoft-powerpoint-output-from-rmarkdown"><i class="fa fa-check"></i><b>38.3</b> Microsoft Powerpoint Output from Rmarkdown</a>
<ul>
<li class="chapter" data-level="38.3.1" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#tables-in-powerpoint"><i class="fa fa-check"></i><b>38.3.1</b> Tables in Powerpoint</a></li>
<li class="chapter" data-level="38.3.2" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#images-in-powerpoint"><i class="fa fa-check"></i><b>38.3.2</b> Images in Powerpoint</a></li>
<li class="chapter" data-level="38.3.3" data-path="rmarkdown-output-options.html"><a href="rmarkdown-output-options.html#plots-in-powerpoint"><i class="fa fa-check"></i><b>38.3.3</b> Plots in Powerpoint</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="39" data-path="adding-citations-to-your-rmarkdown.html"><a href="adding-citations-to-your-rmarkdown.html"><i class="fa fa-check"></i><b>39</b> Adding Citations to your RMarkdown</a></li>
<li class="chapter" data-level="40" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html"><i class="fa fa-check"></i><b>40</b> Quarto is a Next-Generation RMarkdown</a>
<ul>
<li class="chapter" data-level="40.1" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#goals-for-this-chapter-6"><i class="fa fa-check"></i><b>40.1</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="40.2" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#packages-needed-for-this-chapter-7"><i class="fa fa-check"></i><b>40.2</b> Packages Needed for this chapter</a></li>
<li class="chapter" data-level="40.3" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#introducing-quarto"><i class="fa fa-check"></i><b>40.3</b> Introducing Quarto</a></li>
<li class="chapter" data-level="40.4" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#a-tour-of-quarto"><i class="fa fa-check"></i><b>40.4</b> A Tour of Quarto</a></li>
<li class="chapter" data-level="40.5" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#opening-a-new-quarto-document"><i class="fa fa-check"></i><b>40.5</b> Opening a New Quarto Document</a></li>
<li class="chapter" data-level="40.6" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#annotating-code-in-quarto"><i class="fa fa-check"></i><b>40.6</b> Annotating code in Quarto</a></li>
<li class="chapter" data-level="40.7" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#the-visual-editor-vs.-source-editor-in-quarto"><i class="fa fa-check"></i><b>40.7</b> The Visual Editor vs. Source Editor in Quarto</a></li>
<li class="chapter" data-level="40.8" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#adding-code-chunks"><i class="fa fa-check"></i><b>40.8</b> Adding Code Chunks</a></li>
<li class="chapter" data-level="40.9" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#organized-options-in-code-chunks-with-the-hash-pipe"><i class="fa fa-check"></i><b>40.9</b> Organized Options in Code Chunks with the Hash-Pipe #|</a></li>
<li class="chapter" data-level="40.10" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#stating-global-options-in-your-yaml-header"><i class="fa fa-check"></i><b>40.10</b> Stating Global Options in Your YAML Header</a>
<ul>
<li class="chapter" data-level="40.10.1" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#code-options-and-code-folding"><i class="fa fa-check"></i><b>40.10.1</b> Code Options and Code Folding</a></li>
<li class="chapter" data-level="40.10.2" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#parameters"><i class="fa fa-check"></i><b>40.10.2</b> Parameters</a></li>
</ul></li>
<li class="chapter" data-level="40.11" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#figures"><i class="fa fa-check"></i><b>40.11</b> Figures</a></li>
<li class="chapter" data-level="40.12" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#tables"><i class="fa fa-check"></i><b>40.12</b> Tables</a></li>
<li class="chapter" data-level="40.13" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#inline-code-and-caching"><i class="fa fa-check"></i><b>40.13</b> Inline Code and Caching</a></li>
<li class="chapter" data-level="40.14" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#quarto-at-the-command-line"><i class="fa fa-check"></i><b>40.14</b> Quarto at the Command Line</a></li>
<li class="chapter" data-level="40.15" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#citations-in-quarto"><i class="fa fa-check"></i><b>40.15</b> Citations in Quarto</a></li>
<li class="chapter" data-level="40.16" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#challenge-yourself-1"><i class="fa fa-check"></i><b>40.16</b> Challenge Yourself</a></li>
<li class="chapter" data-level="40.17" data-path="quarto-is-a-next-generation-rmarkdown.html"><a href="quarto-is-a-next-generation-rmarkdown.html#exploring-further"><i class="fa fa-check"></i><b>40.17</b> Exploring further</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="cmd-line.html"><a href="cmd-line.html"><i class="fa fa-check"></i><b>41</b> Running R from the UNIX Command Line</a>
<ul>
<li class="chapter" data-level="41.1" data-path="cmd-line.html"><a href="cmd-line.html#what-is-the-unix-command-line"><i class="fa fa-check"></i><b>41.1</b> What is the UNIX Command line?</a></li>
<li class="chapter" data-level="41.2" data-path="cmd-line.html"><a href="cmd-line.html#why-run-r-from-the-command-line"><i class="fa fa-check"></i><b>41.2</b> Why run R from the command line?</a></li>
<li class="chapter" data-level="41.3" data-path="cmd-line.html"><a href="cmd-line.html#how-do-you-get-started"><i class="fa fa-check"></i><b>41.3</b> How do you get started?</a>
<ul>
<li class="chapter" data-level="41.3.1" data-path="cmd-line.html"><a href="cmd-line.html#on-a-mac"><i class="fa fa-check"></i><b>41.3.1</b> On a Mac</a></li>
<li class="chapter" data-level="41.3.2" data-path="cmd-line.html"><a href="cmd-line.html#on-a-windows-pc"><i class="fa fa-check"></i><b>41.3.2</b> On a Windows PC</a></li>
</ul></li>
<li class="chapter" data-level="41.4" data-path="cmd-line.html"><a href="cmd-line.html#the-yawning-blackness-of-the-terminal-window"><i class="fa fa-check"></i><b>41.4</b> The Yawning Blackness of the Terminal Window</a></li>
<li class="chapter" data-level="41.5" data-path="cmd-line.html"><a href="cmd-line.html#where-are-we"><i class="fa fa-check"></i><b>41.5</b> Where Are We?</a></li>
<li class="chapter" data-level="41.6" data-path="cmd-line.html"><a href="cmd-line.html#cleaning-up"><i class="fa fa-check"></i><b>41.6</b> Cleaning Up</a></li>
<li class="chapter" data-level="41.7" data-path="cmd-line.html"><a href="cmd-line.html#other-helpful-file-commands"><i class="fa fa-check"></i><b>41.7</b> Other helpful file commands</a></li>
<li class="chapter" data-level="41.8" data-path="cmd-line.html"><a href="cmd-line.html#what-about-r"><i class="fa fa-check"></i><b>41.8</b> What about R?</a></li>
<li class="chapter" data-level="41.9" data-path="cmd-line.html"><a href="cmd-line.html#what-about-just-a-few-lines-of-r"><i class="fa fa-check"></i><b>41.9</b> What about just a few lines of R?</a></li>
<li class="chapter" data-level="41.10" data-path="cmd-line.html"><a href="cmd-line.html#running-an-r-script-from-the-terminal"><i class="fa fa-check"></i><b>41.10</b> Running an R Script from the Terminal</a></li>
<li class="chapter" data-level="41.11" data-path="cmd-line.html"><a href="cmd-line.html#rendering-an-rmarkdown-file-from-the-terminal"><i class="fa fa-check"></i><b>41.11</b> Rendering an Rmarkdown file from the Terminal</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="secure-passwords-in-r.html"><a href="secure-passwords-in-r.html"><i class="fa fa-check"></i><b>42</b> Secure Passwords in R</a>
<ul>
<li class="chapter" data-level="42.1" data-path="secure-passwords-in-r.html"><a href="secure-passwords-in-r.html#setting-new-keys"><i class="fa fa-check"></i><b>42.1</b> Setting New Keys</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html"><i class="fa fa-check"></i><b>43</b> Dates and Times in R</a>
<ul>
<li class="chapter" data-level="43.1" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#data-types-for-dates-and-times"><i class="fa fa-check"></i><b>43.1</b> Data Types for Dates and Times</a></li>
<li class="chapter" data-level="43.2" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#using-posixlt"><i class="fa fa-check"></i><b>43.2</b> Using POSIXlt</a></li>
<li class="chapter" data-level="43.3" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#formatting-dates"><i class="fa fa-check"></i><b>43.3</b> Formatting dates</a>
<ul>
<li class="chapter" data-level="43.3.1" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#code-chunk-icons-1"><i class="fa fa-check"></i><b>43.3.1</b> Code Chunk Icons</a></li>
</ul></li>
<li class="chapter" data-level="43.4" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#including-plots-2"><i class="fa fa-check"></i><b>43.4</b> Including Plots</a></li>
<li class="chapter" data-level="43.5" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#including-tables-1"><i class="fa fa-check"></i><b>43.5</b> Including Tables</a></li>
<li class="chapter" data-level="43.6" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#other-languages-in-code-chunks-1"><i class="fa fa-check"></i><b>43.6</b> Other languages in code chunks</a></li>
<li class="chapter" data-level="43.7" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#code-chunk-options-1"><i class="fa fa-check"></i><b>43.7</b> Code Chunk Options</a></li>
<li class="chapter" data-level="43.8" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#try-out-other-chunk-options-1"><i class="fa fa-check"></i><b>43.8</b> Try Out Other Chunk Options</a></li>
<li class="chapter" data-level="43.9" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#the-setup-chunk-1"><i class="fa fa-check"></i><b>43.9</b> The <code>setup</code> chunk</a></li>
<li class="chapter" data-level="43.10" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#the-easy-button---visual-markdown-editing-1"><i class="fa fa-check"></i><b>43.10</b> The Easy Button - Visual Markdown Editing</a></li>
<li class="chapter" data-level="43.11" data-path="dates-and-times-in-r.html"><a href="dates-and-times-in-r.html#a-quick-quiz-1"><i class="fa fa-check"></i><b>43.11</b> A Quick Quiz</a></li>
</ul></li>
<li class="chapter" data-level="44" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html"><i class="fa fa-check"></i><b>44</b> Protecting PHI (Protected Health Information)</a>
<ul>
<li class="chapter" data-level="44.1" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html#protecting-not-inadvertently-sharing-phi"><i class="fa fa-check"></i><b>44.1</b> Protecting (Not Inadvertently Sharing) PHI</a></li>
<li class="chapter" data-level="44.2" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html#identifying-phi"><i class="fa fa-check"></i><b>44.2</b> Identifying PHI</a></li>
<li class="chapter" data-level="44.3" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html#selectively-deleting-phi"><i class="fa fa-check"></i><b>44.3</b> Selectively Deleting PHI</a></li>
<li class="chapter" data-level="44.4" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html#problems-with-phi-free-data"><i class="fa fa-check"></i><b>44.4</b> Problems with PHI-free data</a></li>
<li class="chapter" data-level="44.5" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html#encrypting-phi"><i class="fa fa-check"></i><b>44.5</b> Encrypting PHI</a>
<ul>
<li class="chapter" data-level="44.5.1" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html#generating-public-and-private-keys"><i class="fa fa-check"></i><b>44.5.1</b> Generating Public and Private keys</a></li>
</ul></li>
<li class="chapter" data-level="44.6" data-path="protecting-phi-protected-health-information.html"><a href="protecting-phi-protected-health-information.html#sharing-synthetic-data-with-synthpop"><i class="fa fa-check"></i><b>44.6</b> Sharing synthetic data with {synthpop}</a></li>
</ul></li>
<li class="chapter" data-level="45" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html"><i class="fa fa-check"></i><b>45</b> Building Data Pipelines with {targets}</a>
<ul>
<li class="chapter" data-level="45.1" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#what-does-targets-do"><i class="fa fa-check"></i><b>45.1</b> What Does {targets} Do?</a></li>
<li class="chapter" data-level="45.2" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#air-quality-analysis"><i class="fa fa-check"></i><b>45.2</b> Air Quality Analysis</a>
<ul>
<li class="chapter" data-level="45.2.1" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#prepping-the-functions.r-file"><i class="fa fa-check"></i><b>45.2.1</b> Prepping The Functions.R file</a></li>
<li class="chapter" data-level="45.2.2" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#checking-your-functions"><i class="fa fa-check"></i><b>45.2.2</b> Checking Your Functions</a></li>
<li class="chapter" data-level="45.2.3" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#set-up-the-pipeline"><i class="fa fa-check"></i><b>45.2.3</b> Set Up the Pipeline</a></li>
<li class="chapter" data-level="45.2.4" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#pre-build-checks"><i class="fa fa-check"></i><b>45.2.4</b> Pre-Build Checks</a></li>
<li class="chapter" data-level="45.2.5" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#changing-the-pipeline"><i class="fa fa-check"></i><b>45.2.5</b> Changing the Pipeline</a></li>
</ul></li>
<li class="chapter" data-level="45.3" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#your-turn---a-tuberculosis-analysis-pipeline"><i class="fa fa-check"></i><b>45.3</b> Your Turn - A Tuberculosis Analysis Pipeline</a>
<ul>
<li class="chapter" data-level="45.3.1" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#making-new-functions"><i class="fa fa-check"></i><b>45.3.1</b> Making new Functions</a></li>
<li class="chapter" data-level="45.3.2" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#testing-functions"><i class="fa fa-check"></i><b>45.3.2</b> Testing functions</a></li>
</ul></li>
<li class="chapter" data-level="45.4" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#resetting-functions-before-the-pipeline-is-built"><i class="fa fa-check"></i><b>45.4</b> Resetting functions before the Pipeline is Built</a>
<ul>
<li class="chapter" data-level="45.4.1" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#setting-up-targets"><i class="fa fa-check"></i><b>45.4.1</b> Setting Up {targets}</a></li>
</ul></li>
<li class="chapter" data-level="45.5" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#editing-the-_targets.r-file"><i class="fa fa-check"></i><b>45.5</b> Editing the <code>_targets.R</code> File</a>
<ul>
<li class="chapter" data-level="45.5.1" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#running-the-pipeline"><i class="fa fa-check"></i><b>45.5.1</b> Running the Pipeline</a></li>
<li class="chapter" data-level="45.5.2" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#modificatons-to-the-pipeline"><i class="fa fa-check"></i><b>45.5.2</b> Modificatons to the Pipeline</a></li>
<li class="chapter" data-level="45.5.3" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#modify-the-plot"><i class="fa fa-check"></i><b>45.5.3</b> Modify the Plot</a></li>
</ul></li>
<li class="chapter" data-level="45.6" data-path="building-data-pipelines-with-targets.html"><a href="building-data-pipelines-with-targets.html#next-steps"><i class="fa fa-check"></i><b>45.6</b> Next Steps</a></li>
</ul></li>
<li class="chapter" data-level="46" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html"><i class="fa fa-check"></i><b>46</b> Colors and Scales in {ggplot2}</a>
<ul>
<li class="chapter" data-level="46.1" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#goals-for-this-chapter-7"><i class="fa fa-check"></i><b>46.1</b> Goals for this Chapter</a></li>
<li class="chapter" data-level="46.2" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#colors-in-r-and-ggplot2"><i class="fa fa-check"></i><b>46.2</b> Colors in R and {ggplot2}</a>
<ul>
<li class="chapter" data-level="46.2.1" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#using-pre-defined-color-names"><i class="fa fa-check"></i><b>46.2.1</b> Using pre-defined color names</a></li>
<li class="chapter" data-level="46.2.2" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#using-color-hex-codes"><i class="fa fa-check"></i><b>46.2.2</b> Using color hex codes</a></li>
<li class="chapter" data-level="46.2.3" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#screen-vs.-print-colors"><i class="fa fa-check"></i><b>46.2.3</b> Screen vs. Print Colors</a></li>
<li class="chapter" data-level="46.2.4" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#transparency-and-hex-colors"><i class="fa fa-check"></i><b>46.2.4</b> Transparency and hex colors</a></li>
<li class="chapter" data-level="46.2.5" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#more-obscure-ways-to-select-colors"><i class="fa fa-check"></i><b>46.2.5</b> More obscure ways to select colors</a></li>
<li class="chapter" data-level="46.2.6" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#using-color-palettes"><i class="fa fa-check"></i><b>46.2.6</b> Using color palettes</a></li>
<li class="chapter" data-level="46.2.7" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#color-blind-friendly-palettes"><i class="fa fa-check"></i><b>46.2.7</b> Color-blind friendly palettes</a></li>
</ul></li>
<li class="chapter" data-level="46.3" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#sequential-diverging-and-qualitative-palettes"><i class="fa fa-check"></i><b>46.3</b> Sequential, Diverging, and Qualitative Palettes</a></li>
<li class="chapter" data-level="46.4" data-path="colors-and-scales-in-ggplot2.html"><a href="colors-and-scales-in-ggplot2.html#choosing-colors-with-meaning"><i class="fa fa-check"></i><b>46.4</b> Choosing Colors with Meaning</a></li>
</ul></li>
<li class="chapter" data-level="47" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html"><i class="fa fa-check"></i><b>47</b> Using the {flowchart} package for CONSORT diagrams in R</a>
<ul>
<li class="chapter" data-level="47.1" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#why-flowcharts"><i class="fa fa-check"></i><b>47.1</b> Why Flowcharts?</a></li>
<li class="chapter" data-level="47.2" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#loading-libraries"><i class="fa fa-check"></i><b>47.2</b> Loading Libraries</a></li>
<li class="chapter" data-level="47.3" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#a-consort-flowchart-for-statins-to-prevent-hcc"><i class="fa fa-check"></i><b>47.3</b> A CONSORT Flowchart for Statins to Prevent HCC</a></li>
<li class="chapter" data-level="47.4" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#data"><i class="fa fa-check"></i><b>47.4</b> Data</a></li>
<li class="chapter" data-level="47.5" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#branching"><i class="fa fa-check"></i><b>47.5</b> Branching</a></li>
<li class="chapter" data-level="47.6" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#splitting-into-groups-treatment-arms"><i class="fa fa-check"></i><b>47.6</b> Splitting into Groups (Treatment Arms)</a>
<ul>
<li class="chapter" data-level="47.6.1" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#a-short-tangent-on-ifelse"><i class="fa fa-check"></i><b>47.6.1</b> A Short Tangent on {ifelse}</a></li>
</ul></li>
<li class="chapter" data-level="47.7" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#filtering-for-completers"><i class="fa fa-check"></i><b>47.7</b> Filtering for Completers</a></li>
<li class="chapter" data-level="47.8" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#modify-exclusions-for-more-detailed-labels"><i class="fa fa-check"></i><b>47.8</b> Modify exclusions for more detailed labels</a>
<ul>
<li class="chapter" data-level="47.8.1" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#time-for-a-quiz"><i class="fa fa-check"></i><b>47.8.1</b> Time for a Quiz</a></li>
</ul></li>
<li class="chapter" data-level="47.9" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#a-more-complicated-study"><i class="fa fa-check"></i><b>47.9</b> A More Complicated Study</a></li>
<li class="chapter" data-level="47.10" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#example"><i class="fa fa-check"></i><b>47.10</b> Example</a></li>
<li class="chapter" data-level="47.11" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#branching-1"><i class="fa fa-check"></i><b>47.11</b> Branching</a></li>
<li class="chapter" data-level="47.12" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#splitting-into-groups-treatment-arms-1"><i class="fa fa-check"></i><b>47.12</b> Splitting into Groups (Treatment Arms)</a></li>
<li class="chapter" data-level="47.13" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#filtering-for-completers-1"><i class="fa fa-check"></i><b>47.13</b> Filtering for Completers</a></li>
<li class="chapter" data-level="47.14" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#modify-exclusions-for-more-detailed-labels-1"><i class="fa fa-check"></i><b>47.14</b> Modify exclusions for more detailed labels</a></li>
<li class="chapter" data-level="47.15" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#next-step"><i class="fa fa-check"></i><b>47.15</b> Next step</a></li>
<li class="chapter" data-level="47.16" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#now-add-these-withdrawal-reasons"><i class="fa fa-check"></i><b>47.16</b> Now Add These Withdrawal Reasons</a></li>
<li class="chapter" data-level="47.17" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#your-turn-7"><i class="fa fa-check"></i><b>47.17</b> Your Turn</a></li>
<li class="chapter" data-level="47.17.1" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#fatigue-starting-box"><i class="fa fa-check"></i><b>47.17.1</b> Fatigue Starting Box</a></li>
<li class="chapter" data-level="47.17.2" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#fatigue-branching-fror-exclusions-with-fc_filter"><i class="fa fa-check"></i><b>47.17.2</b> Fatigue Branching fr=or Exclusions with fc_filter</a></li>
<li class="chapter" data-level="47.17.3" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#branching-fatigue"><i class="fa fa-check"></i><b>47.17.3</b> Branching Fatigue</a></li>
<li class="chapter" data-level="47.17.4" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#fatigue-completers"><i class="fa fa-check"></i><b>47.17.4</b> Fatigue Completers</a></li>
<li class="chapter" data-level="47.17.5" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#fatigue-text-for-exclusions"><i class="fa fa-check"></i><b>47.17.5</b> Fatigue Text for Exclusions</a></li>
<li class="chapter" data-level="47.17.6" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#fatigue-add-text-for-exclusions"><i class="fa fa-check"></i><b>47.17.6</b> Fatigue Add text for Exclusions</a></li>
<li class="chapter" data-level="47.17.7" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#withdrawal-reasons"><i class="fa fa-check"></i><b>47.17.7</b> Withdrawal Reasons</a></li>
<li class="chapter" data-level="47.17.8" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#now-add-these-to-your-flowchart-with-fc_modify"><i class="fa fa-check"></i><b>47.17.8</b> Now add these to Your Flowchart with fc_modify</a></li>
<li class="chapter" data-level="47.17.9" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#final-fatigue-flowchart-drawing-fatigue_fc6"><i class="fa fa-check"></i><b>47.17.9</b> Final Fatigue Flowchart Drawing fatigue_fc6</a></li>
<li class="chapter" data-level="47.17.10" data-path="using-the-flowchart-package-for-consort-diagrams-in-r.html"><a href="using-the-flowchart-package-for-consort-diagrams-in-r.html#explore-more-features"><i class="fa fa-check"></i><b>47.17.10</b> Explore More Features</a></li>
</ul></li>
<li class="chapter" data-level="48" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><i class="fa fa-check"></i><b>48</b> Using the {tabulapdf} package tp extract tables from PDFs</a>
<ul>
<li class="chapter" data-level="48.1" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#why-tables-from-pdfs"><i class="fa fa-check"></i><b>48.1</b> Why Tables from PDFs?</a></li>
<li class="chapter" data-level="48.2" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#extracting-tables-from-pdfs"><i class="fa fa-check"></i><b>48.2</b> Extracting Tables from PDFs</a></li>
<li class="chapter" data-level="48.3" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#extracting-tables-from-pdfs-1"><i class="fa fa-check"></i><b>48.3</b> Extracting Tables from PDFs</a></li>
<li class="chapter" data-level="48.4" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#extracting-tables-from-the-pdf"><i class="fa fa-check"></i><b>48.4</b> Extracting Tables from the PDF</a></li>
<li class="chapter" data-level="48.5" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#extracting-a-specific-table"><i class="fa fa-check"></i><b>48.5</b> Extracting a Specific Table</a></li>
<li class="chapter" data-level="48.6" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#extracting-a-specific-table-1"><i class="fa fa-check"></i><b>48.6</b> Extracting a Specific Table</a></li>
<li class="chapter" data-level="48.7" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#viewing-and-targeting-the-pdf"><i class="fa fa-check"></i><b>48.7</b> Viewing and Targeting the PDF</a></li>
<li class="chapter" data-level="48.8" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#your-turn-8"><i class="fa fa-check"></i><b>48.8</b> Your Turn</a></li>
<li class="chapter" data-level="48.8.1" data-path="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html"><a href="using-the-tabulapdf-package-tp-extract-tables-from-pdfs.html#explore-more-features-1"><i class="fa fa-check"></i><b>48.8.1</b> Explore More Features</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="title-holder.html"><a href="title-holder.html"><i class="fa fa-check"></i>Title holder</a></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reproducible Medical Research with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="extensions-to-ggplot" class="section level1 hasAnchor" number="27">
<h1><span class="header-section-number">Chapter 27</span> Extensions to ggplot<a href="extensions-to-ggplot.html#extensions-to-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The {ggplot2} package is made to be <em>extensible</em> - so that other people can write packages that add new (often niche) geoms for specific purposes. This chapter is a short tour of some of the neat extensions people have written, and when and where they can be useful. Some of these are distinct packages, and others are just cool ways to use ggplot. Please check out the links to the individual packages to learn more, as we will frequently just scratch the surface of what is available.</p>
<div id="goals-for-this-chapter-4" class="section level2 hasAnchor" number="27.1">
<h2><span class="header-section-number">27.1</span> Goals for this Chapter<a href="extensions-to-ggplot.html#goals-for-this-chapter-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>learn how and why to use waffle plots</li>
<li>learn how and when to use alluvial plots</li>
<li>learn how and when to use lollipop plots</li>
<li>learn how and when to use dumbbell plots</li>
<li>learn how and when to use spaghetti plots</li>
<li>learn how and when to use swimmer plots</li>
</ul>
</div>
<div id="packages-needed-for-this-chapter-4" class="section level2 hasAnchor" number="27.2">
<h2><span class="header-section-number">27.2</span> Packages Needed for this chapter<a href="extensions-to-ggplot.html#packages-needed-for-this-chapter-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You will need {tidyverse}, {medicaldata}, {waffle}, {ggalluvial}, {ggalt}, {ggrepel}, {ggforce}, {ggalt}, {ggtext}. {ggsignif}, {ggbump}, {survminer}, {ggcorrplot}, {plotROC}, {directlabels}, {geomtextpath}, {ggheatmap}, {ggQC}, {ggupset}, {plotly}, and {gganimate}.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="extensions-to-ggplot.html#cb524-1" tabindex="-1"></a><span class="co"># install.packages(&#39;tidyverse&#39;)</span></span>
<span id="cb524-2"><a href="extensions-to-ggplot.html#cb524-2" tabindex="-1"></a><span class="co"># install.packages(&#39;medicaldata&#39;)</span></span>
<span id="cb524-3"><a href="extensions-to-ggplot.html#cb524-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb524-4"><a href="extensions-to-ggplot.html#cb524-4" tabindex="-1"></a><span class="fu">library</span>(medicaldata)</span>
<span id="cb524-5"><a href="extensions-to-ggplot.html#cb524-5" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb524-6"><a href="extensions-to-ggplot.html#cb524-6" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb524-7"><a href="extensions-to-ggplot.html#cb524-7" tabindex="-1"></a><span class="fu">library</span>(ggalt)</span>
<span id="cb524-8"><a href="extensions-to-ggplot.html#cb524-8" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb524-9"><a href="extensions-to-ggplot.html#cb524-9" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb524-10"><a href="extensions-to-ggplot.html#cb524-10" tabindex="-1"></a><span class="fu">library</span>(ggbump)</span>
<span id="cb524-11"><a href="extensions-to-ggplot.html#cb524-11" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb524-12"><a href="extensions-to-ggplot.html#cb524-12" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb524-13"><a href="extensions-to-ggplot.html#cb524-13" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span>
<span id="cb524-14"><a href="extensions-to-ggplot.html#cb524-14" tabindex="-1"></a><span class="fu">library</span>(plotROC)</span>
<span id="cb524-15"><a href="extensions-to-ggplot.html#cb524-15" tabindex="-1"></a><span class="fu">library</span>(directlabels)</span>
<span id="cb524-16"><a href="extensions-to-ggplot.html#cb524-16" tabindex="-1"></a><span class="fu">library</span>(geomtextpath)</span>
<span id="cb524-17"><a href="extensions-to-ggplot.html#cb524-17" tabindex="-1"></a><span class="fu">library</span>(ggheatmap)</span>
<span id="cb524-18"><a href="extensions-to-ggplot.html#cb524-18" tabindex="-1"></a><span class="fu">library</span>(ggQC)</span>
<span id="cb524-19"><a href="extensions-to-ggplot.html#cb524-19" tabindex="-1"></a><span class="fu">library</span>(ggupset)</span>
<span id="cb524-20"><a href="extensions-to-ggplot.html#cb524-20" tabindex="-1"></a><span class="fu">library</span>(ComplexUpset)</span>
<span id="cb524-21"><a href="extensions-to-ggplot.html#cb524-21" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb524-22"><a href="extensions-to-ggplot.html#cb524-22" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span></code></pre></div>
</div>
<div id="a-flipbook-of-where-we-are-going-with-ggplot-extensions" class="section level2 hasAnchor" number="27.3">
<h2><span class="header-section-number">27.3</span> A Flipbook of Where We Are Going With ggplot Extensions<a href="extensions-to-ggplot.html#a-flipbook-of-where-we-are-going-with-ggplot-extensions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>See the flipbook below, which contains some examples of what you can do with ggplot extensions.</p>
<p>You can use the the icons in the bottom bar to expand to full screen or share this flipbook. If you are in full screen mode, you can use the Home button to go the the first slide and the End button to go to the last slide, and the Escape key to get out of full screen mode.</p>
<div id="make-flipbook" class="section level3 hasAnchor" number="27.3.1">
<h3><span class="header-section-number">27.3.1</span> MAKE FLIPBOOK<a href="extensions-to-ggplot.html#make-flipbook" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!---FLIPBOOK EX 1-->
<iframe style="margin:0 auto; border: solid black;" id="myIframe11" width="763" height="432" src="https://higgi13425.github.io/mini_flipbooks/scales_microflip.html#1" scrolling="no" data-external="1" allowfullscreen loading="lazy">
</iframe>
<!------------->
</div>
</div>
<div id="a-waffle-plot" class="section level2 hasAnchor" number="27.4">
<h2><span class="header-section-number">27.4</span> A Waffle Plot<a href="extensions-to-ggplot.html#a-waffle-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Why is this better than a bar plot or a dotplot?</p>
<p>In order to represent counts, or individual participants in a trial, a bar plot is a bit deceiving. It appears to be a continuous variable. But each participant in a clinical trial is a discrete individual. A bar plot can be helpful for very large numbers, but for manageable numbers it is a bit of a misrepresentation.</p>
<p>A dotplot, with geom_dotplot, would seem like a good option, but it only displays proportions, not counts.</p>
<p>In order to show outcomes for distinct individual participants, a waffle plot comes in handy. These have become quite popular in data journalism to represent counts.
Let’s start with a waffle plot of</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="extensions-to-ggplot.html#cb525-1" tabindex="-1"></a><span class="fu">library</span>(waffle)</span>
<span id="cb525-2"><a href="extensions-to-ggplot.html#cb525-2" tabindex="-1"></a>indo_rct <span class="ot">&lt;-</span> medicaldata<span class="sc">::</span>indo_rct</span>
<span id="cb525-3"><a href="extensions-to-ggplot.html#cb525-3" tabindex="-1"></a>  scaler <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb525-4"><a href="extensions-to-ggplot.html#cb525-4" tabindex="-1"></a>indo_data <span class="ot">&lt;-</span> indo_rct <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(outcome, rx) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb525-5"><a href="extensions-to-ggplot.html#cb525-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> n<span class="sc">/</span>scaler)</span>
<span id="cb525-6"><a href="extensions-to-ggplot.html#cb525-6" tabindex="-1"></a></span>
<span id="cb525-7"><a href="extensions-to-ggplot.html#cb525-7" tabindex="-1"></a>indo_data <span class="sc">%&gt;%</span> </span>
<span id="cb525-8"><a href="extensions-to-ggplot.html#cb525-8" tabindex="-1"></a>  <span class="co">#mutate(site = case_when(site == &quot;1_UM&quot; ~ &quot;Michigan&quot;, site == &quot;2_IU&quot; ~ &quot;Indiana&quot;, site == &quot;3_UK&quot; ~ &quot;Kentucky&quot;, site == &quot;4_Case&quot; ~ &quot;Case&quot;)) %&gt;% </span></span>
<span id="cb525-9"><a href="extensions-to-ggplot.html#cb525-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rx =</span> <span class="fu">str_sub</span>(rx, <span class="dv">3</span><span class="dt">L</span>, <span class="dv">10</span><span class="dt">L</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb525-10"><a href="extensions-to-ggplot.html#cb525-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> outcome, <span class="at">values =</span> n)) <span class="sc">+</span></span>
<span id="cb525-11"><a href="extensions-to-ggplot.html#cb525-11" tabindex="-1"></a>  <span class="fu">geom_waffle</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size=</span><span class="fl">0.25</span>, <span class="at">n_rows =</span> <span class="dv">10</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb525-12"><a href="extensions-to-ggplot.html#cb525-12" tabindex="-1"></a>              <span class="at">flip =</span> <span class="cn">TRUE</span>, <span class="at">radius =</span> <span class="fu">unit</span>(<span class="fl">0.7</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb525-13"><a href="extensions-to-ggplot.html#cb525-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>rx, <span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb525-14"><a href="extensions-to-ggplot.html#cb525-14" tabindex="-1"></a>             <span class="at">strip.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb525-15"><a href="extensions-to-ggplot.html#cb525-15" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>() <span class="sc">+</span> </span>
<span id="cb525-16"><a href="extensions-to-ggplot.html#cb525-16" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">10</span>), </span>
<span id="cb525-17"><a href="extensions-to-ggplot.html#cb525-17" tabindex="-1"></a>      <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">format</span>(x <span class="sc">*</span> <span class="dv">10</span><span class="sc">*</span>scaler, <span class="at">scientific =</span> F),</span>
<span id="cb525-18"><a href="extensions-to-ggplot.html#cb525-18" tabindex="-1"></a>              <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb525-19"><a href="extensions-to-ggplot.html#cb525-19" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1a85ff&quot;</span>, <span class="st">&quot;#d41159&quot;</span> )) <span class="sc">+</span></span>
<span id="cb525-20"><a href="extensions-to-ggplot.html#cb525-20" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb525-21"><a href="extensions-to-ggplot.html#cb525-21" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb525-22"><a href="extensions-to-ggplot.html#cb525-22" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Post-ERCP Outcomes by Treatment: &lt;br&gt;&lt;span style = &#39;color:#d41159;&#39;&gt;Pancreatitis&lt;/span&gt;, or &lt;span style = &#39;color:#1a85ff;&#39;&gt;No Event&lt;/span&gt;, &lt;br&gt;in the Rectal Indomethacin Trial&quot;</span>,</span>
<span id="cb525-23"><a href="extensions-to-ggplot.html#cb525-23" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">&quot;One square = %s Outcome, Each Row = 10 Outcomes&quot;</span>, scaler),</span>
<span id="cb525-24"><a href="extensions-to-ggplot.html#cb525-24" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb525-25"><a href="extensions-to-ggplot.html#cb525-25" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb525-26"><a href="extensions-to-ggplot.html#cb525-26" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Data: NEJM 2012; 366:1414-1422, Elmunzer&quot;</span></span>
<span id="cb525-27"><a href="extensions-to-ggplot.html#cb525-27" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb525-28"><a href="extensions-to-ggplot.html#cb525-28" tabindex="-1"></a>   <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb525-29"><a href="extensions-to-ggplot.html#cb525-29" tabindex="-1"></a>  <span class="co">#theme_ipsum_rc()+</span></span>
<span id="cb525-30"><a href="extensions-to-ggplot.html#cb525-30" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb525-31"><a href="extensions-to-ggplot.html#cb525-31" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb525-32"><a href="extensions-to-ggplot.html#cb525-32" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb525-33"><a href="extensions-to-ggplot.html#cb525-33" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_line</span>(),</span>
<span id="cb525-34"><a href="extensions-to-ggplot.html#cb525-34" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb525-35"><a href="extensions-to-ggplot.html#cb525-35" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb525-36"><a href="extensions-to-ggplot.html#cb525-36" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/waffle-1.png" width="672" /></p>
<p>The waffle plot is an interesting hack of ggplot. The geom_waffle() is actually a faceted plot, with one row of facets (examine the code above). You can change the scaler constant to make each square count for N cases. You can learn more about the many capabilities of the {waffle} package - including pictograms and an alternative to pie charts - <a href="https://github.com/hrbrmstr/waffle">here</a>.</p>
<p>Note that we have used colors in the title in place of a legend, by coloring the outcomes with the corresponding colors, using the {ggtext} extension package, which allows you to add color, backgrounds, images, bold face, or italic face to text in ggplots, using markdown/HTML tags. You can learn more about the many capabilities of the {ggtext} package and what it can do <a href="https://github.com/wilkelab/ggtext">here</a>.</p>
</div>
<div id="an-alluvial-plot" class="section level2 hasAnchor" number="27.5">
<h2><span class="header-section-number">27.5</span> An Alluvial Plot<a href="extensions-to-ggplot.html#an-alluvial-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An alluvial plot depicts flow, like a river, which can split off branches and re-unite streams. This kind of plot can be helpful to show patient flow from one state to the next. This requires the {ggalluvial} package, which you may need to install and then load with the library() function.</p>
<p>The example below shows the flow of patients with chest pain from ED triage to hospitalization and an outcome of survived or died, stratified by gender.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="extensions-to-ggplot.html#cb526-1" tabindex="-1"></a>datafr <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb526-2"><a href="extensions-to-ggplot.html#cb526-2" tabindex="-1"></a>  <span class="sc">~</span>gender, <span class="sc">~</span>triage, <span class="sc">~</span>next_day, <span class="sc">~</span>outcome, <span class="sc">~</span>count,</span>
<span id="cb526-3"><a href="extensions-to-ggplot.html#cb526-3" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">211</span>,</span>
<span id="cb526-4"><a href="extensions-to-ggplot.html#cb526-4" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">43</span>,</span>
<span id="cb526-5"><a href="extensions-to-ggplot.html#cb526-5" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">280</span>,</span>
<span id="cb526-6"><a href="extensions-to-ggplot.html#cb526-6" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">15</span>,</span>
<span id="cb526-7"><a href="extensions-to-ggplot.html#cb526-7" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">67</span>,</span>
<span id="cb526-8"><a href="extensions-to-ggplot.html#cb526-8" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">11</span>,</span>
<span id="cb526-9"><a href="extensions-to-ggplot.html#cb526-9" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">415</span>,</span>
<span id="cb526-10"><a href="extensions-to-ggplot.html#cb526-10" tabindex="-1"></a>  <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">5</span>,</span>
<span id="cb526-11"><a href="extensions-to-ggplot.html#cb526-11" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">219</span>,</span>
<span id="cb526-12"><a href="extensions-to-ggplot.html#cb526-12" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">33</span>,</span>
<span id="cb526-13"><a href="extensions-to-ggplot.html#cb526-13" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">250</span>,</span>
<span id="cb526-14"><a href="extensions-to-ggplot.html#cb526-14" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;ER&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">45</span>,</span>
<span id="cb526-15"><a href="extensions-to-ggplot.html#cb526-15" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">88</span>,</span>
<span id="cb526-16"><a href="extensions-to-ggplot.html#cb526-16" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Hospitalized&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">27</span>,</span>
<span id="cb526-17"><a href="extensions-to-ggplot.html#cb526-17" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">402</span>,</span>
<span id="cb526-18"><a href="extensions-to-ggplot.html#cb526-18" tabindex="-1"></a>  <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Observation&quot;</span>, <span class="st">&quot;Discharged&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb526-19"><a href="extensions-to-ggplot.html#cb526-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gender =</span> <span class="fu">as_factor</span>(gender),</span>
<span id="cb526-20"><a href="extensions-to-ggplot.html#cb526-20" tabindex="-1"></a>         <span class="at">triage =</span> <span class="fu">as_factor</span>(triage),</span>
<span id="cb526-21"><a href="extensions-to-ggplot.html#cb526-21" tabindex="-1"></a>         <span class="at">next_day =</span> <span class="fu">as_factor</span>(next_day),</span>
<span id="cb526-22"><a href="extensions-to-ggplot.html#cb526-22" tabindex="-1"></a>         <span class="at">outcome =</span> <span class="fu">as_factor</span>(outcome))</span>
<span id="cb526-23"><a href="extensions-to-ggplot.html#cb526-23" tabindex="-1"></a></span>
<span id="cb526-24"><a href="extensions-to-ggplot.html#cb526-24" tabindex="-1"></a><span class="fu">ggplot</span>(datafr, </span>
<span id="cb526-25"><a href="extensions-to-ggplot.html#cb526-25" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> count, <span class="at">axis1 =</span> gender, <span class="at">axis2 =</span> triage,</span>
<span id="cb526-26"><a href="extensions-to-ggplot.html#cb526-26" tabindex="-1"></a>           <span class="at">axis3 =</span> next_day)) <span class="sc">+</span></span>
<span id="cb526-27"><a href="extensions-to-ggplot.html#cb526-27" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> outcome), <span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb526-28"><a href="extensions-to-ggplot.html#cb526-28" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span><span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb526-29"><a href="extensions-to-ggplot.html#cb526-29" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">stat =</span> <span class="st">&quot;stratum&quot;</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum))) <span class="sc">+</span></span>
<span id="cb526-30"><a href="extensions-to-ggplot.html#cb526-30" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;gender&quot;</span>, <span class="st">&quot;triage&quot;</span>, <span class="st">&quot;next_day&quot;</span>), <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">10</span>, .<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb526-31"><a href="extensions-to-ggplot.html#cb526-31" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Patients Presenting with Chest Pain&quot;</span>) <span class="sc">+</span></span>
<span id="cb526-32"><a href="extensions-to-ggplot.html#cb526-32" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1a85ff&quot;</span>, <span class="st">&quot;#d41159&quot;</span> ))</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/alluvial-1.png" width="672" /></p>
<div class="tryit">
<p>Now try this yourself. Copy the code below (click on the copy icon in the top right of the code chunk), paste it into your RStudio IDE, and edit to:</p>
<ul>
<li>show the additive effects of ethanol use, cirrhosis, and HCC on death rates. Code the outcome as Survived or Died.</li>
</ul>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="extensions-to-ggplot.html#cb527-1" tabindex="-1"></a>datafr <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb527-2"><a href="extensions-to-ggplot.html#cb527-2" tabindex="-1"></a>  <span class="sc">~</span>Ethanol_Use, <span class="sc">~</span>Cirrhosis, <span class="sc">~</span>HCC, <span class="sc">~</span>outcome, <span class="sc">~</span>count,</span>
<span id="cb527-3"><a href="extensions-to-ggplot.html#cb527-3" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>,  <span class="dv">4</span>,</span>
<span id="cb527-4"><a href="extensions-to-ggplot.html#cb527-4" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">28</span>,</span>
<span id="cb527-5"><a href="extensions-to-ggplot.html#cb527-5" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">12</span>,</span>
<span id="cb527-6"><a href="extensions-to-ggplot.html#cb527-6" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">45</span>,</span>
<span id="cb527-7"><a href="extensions-to-ggplot.html#cb527-7" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">2</span>,</span>
<span id="cb527-8"><a href="extensions-to-ggplot.html#cb527-8" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">4</span>,</span>
<span id="cb527-9"><a href="extensions-to-ggplot.html#cb527-9" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">57</span>,</span>
<span id="cb527-10"><a href="extensions-to-ggplot.html#cb527-10" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">26</span>,</span>
<span id="cb527-11"><a href="extensions-to-ggplot.html#cb527-11" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb527-12"><a href="extensions-to-ggplot.html#cb527-12" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">10</span>,</span>
<span id="cb527-13"><a href="extensions-to-ggplot.html#cb527-13" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">32</span>,</span>
<span id="cb527-14"><a href="extensions-to-ggplot.html#cb527-14" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">26</span>,</span>
<span id="cb527-15"><a href="extensions-to-ggplot.html#cb527-15" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">1</span>,</span>
<span id="cb527-16"><a href="extensions-to-ggplot.html#cb527-16" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb527-17"><a href="extensions-to-ggplot.html#cb527-17" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">297</span>,</span>
<span id="cb527-18"><a href="extensions-to-ggplot.html#cb527-18" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">15</span></span>
<span id="cb527-19"><a href="extensions-to-ggplot.html#cb527-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb527-20"><a href="extensions-to-ggplot.html#cb527-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ethanol_Use =</span> <span class="fu">as_factor</span>(Ethanol_Use),</span>
<span id="cb527-21"><a href="extensions-to-ggplot.html#cb527-21" tabindex="-1"></a>         <span class="at">Cirrhosis =</span> <span class="fu">as_factor</span>(Cirrhosis),</span>
<span id="cb527-22"><a href="extensions-to-ggplot.html#cb527-22" tabindex="-1"></a>         <span class="at">HCC =</span> <span class="fu">as_factor</span>(HCC),</span>
<span id="cb527-23"><a href="extensions-to-ggplot.html#cb527-23" tabindex="-1"></a>         <span class="at">outcome =</span> <span class="fu">as_factor</span>(outcome))</span>
<span id="cb527-24"><a href="extensions-to-ggplot.html#cb527-24" tabindex="-1"></a></span>
<span id="cb527-25"><a href="extensions-to-ggplot.html#cb527-25" tabindex="-1"></a><span class="fu">ggplot</span>(datafr, </span>
<span id="cb527-26"><a href="extensions-to-ggplot.html#cb527-26" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> count, <span class="at">axis1 =</span> ____, </span>
<span id="cb527-27"><a href="extensions-to-ggplot.html#cb527-27" tabindex="-1"></a>           <span class="at">axis2 =</span> ____,</span>
<span id="cb527-28"><a href="extensions-to-ggplot.html#cb527-28" tabindex="-1"></a>           <span class="at">axis3 =</span> ____)) <span class="sc">+</span></span>
<span id="cb527-29"><a href="extensions-to-ggplot.html#cb527-29" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> outcome), <span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb527-30"><a href="extensions-to-ggplot.html#cb527-30" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span><span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-31"><a href="extensions-to-ggplot.html#cb527-31" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">stat =</span> <span class="st">&quot;stratum&quot;</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum))) <span class="sc">+</span></span>
<span id="cb527-32"><a href="extensions-to-ggplot.html#cb527-32" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;____&quot;</span>, <span class="st">&quot;____&quot;</span>, <span class="st">&quot;____&quot;</span>), <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">10</span>, .<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb527-33"><a href="extensions-to-ggplot.html#cb527-33" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Patients Presenting with Hepatitis C Infection&quot;</span>) <span class="sc">+</span></span>
<span id="cb527-34"><a href="extensions-to-ggplot.html#cb527-34" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1a85ff&quot;</span>, <span class="st">&quot;#d41159&quot;</span> ))</span></code></pre></div>
<pre><code>## Error in parse(text = input): &lt;text&gt;:26:32: unexpected input
## 25: ggplot(datafr, 
## 26:        aes(y = count, axis1 = __
##                                    ^</code></pre>
</div>
<div class="webex-solution">
<button>
alluvial1-solution
</button>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="extensions-to-ggplot.html#cb529-1" tabindex="-1"></a>datafr <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb529-2"><a href="extensions-to-ggplot.html#cb529-2" tabindex="-1"></a>  <span class="sc">~</span>Ethanol_Use, <span class="sc">~</span>Cirrhosis, <span class="sc">~</span>HCC, <span class="sc">~</span>outcome, <span class="sc">~</span>count,</span>
<span id="cb529-3"><a href="extensions-to-ggplot.html#cb529-3" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>,  <span class="dv">4</span>,</span>
<span id="cb529-4"><a href="extensions-to-ggplot.html#cb529-4" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">28</span>,</span>
<span id="cb529-5"><a href="extensions-to-ggplot.html#cb529-5" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">12</span>,</span>
<span id="cb529-6"><a href="extensions-to-ggplot.html#cb529-6" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">45</span>,</span>
<span id="cb529-7"><a href="extensions-to-ggplot.html#cb529-7" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">2</span>,</span>
<span id="cb529-8"><a href="extensions-to-ggplot.html#cb529-8" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">4</span>,</span>
<span id="cb529-9"><a href="extensions-to-ggplot.html#cb529-9" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">57</span>,</span>
<span id="cb529-10"><a href="extensions-to-ggplot.html#cb529-10" tabindex="-1"></a>  <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">26</span>,</span>
<span id="cb529-11"><a href="extensions-to-ggplot.html#cb529-11" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb529-12"><a href="extensions-to-ggplot.html#cb529-12" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">10</span>,</span>
<span id="cb529-13"><a href="extensions-to-ggplot.html#cb529-13" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">32</span>,</span>
<span id="cb529-14"><a href="extensions-to-ggplot.html#cb529-14" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">26</span>,</span>
<span id="cb529-15"><a href="extensions-to-ggplot.html#cb529-15" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">1</span>,</span>
<span id="cb529-16"><a href="extensions-to-ggplot.html#cb529-16" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb529-17"><a href="extensions-to-ggplot.html#cb529-17" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Survived&quot;</span>, <span class="dv">297</span>,</span>
<span id="cb529-18"><a href="extensions-to-ggplot.html#cb529-18" tabindex="-1"></a>  <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;No&quot;</span>, <span class="st">&quot;Died&quot;</span>, <span class="dv">15</span></span>
<span id="cb529-19"><a href="extensions-to-ggplot.html#cb529-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb529-20"><a href="extensions-to-ggplot.html#cb529-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Ethanol_Use =</span> <span class="fu">as_factor</span>(Ethanol_Use),</span>
<span id="cb529-21"><a href="extensions-to-ggplot.html#cb529-21" tabindex="-1"></a>         <span class="at">Cirrhosis =</span> <span class="fu">as_factor</span>(Cirrhosis),</span>
<span id="cb529-22"><a href="extensions-to-ggplot.html#cb529-22" tabindex="-1"></a>         <span class="at">HCC =</span> <span class="fu">as_factor</span>(HCC),</span>
<span id="cb529-23"><a href="extensions-to-ggplot.html#cb529-23" tabindex="-1"></a>         <span class="at">outcome =</span> <span class="fu">as_factor</span>(outcome))</span>
<span id="cb529-24"><a href="extensions-to-ggplot.html#cb529-24" tabindex="-1"></a></span>
<span id="cb529-25"><a href="extensions-to-ggplot.html#cb529-25" tabindex="-1"></a><span class="fu">ggplot</span>(datafr, </span>
<span id="cb529-26"><a href="extensions-to-ggplot.html#cb529-26" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> count, <span class="at">axis1 =</span> Ethanol_Use, </span>
<span id="cb529-27"><a href="extensions-to-ggplot.html#cb529-27" tabindex="-1"></a>           <span class="at">axis2 =</span> Cirrhosis,</span>
<span id="cb529-28"><a href="extensions-to-ggplot.html#cb529-28" tabindex="-1"></a>           <span class="at">axis3 =</span> HCC)) <span class="sc">+</span></span>
<span id="cb529-29"><a href="extensions-to-ggplot.html#cb529-29" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> outcome), <span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb529-30"><a href="extensions-to-ggplot.html#cb529-30" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span><span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb529-31"><a href="extensions-to-ggplot.html#cb529-31" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">stat =</span> <span class="st">&quot;stratum&quot;</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum))) <span class="sc">+</span></span>
<span id="cb529-32"><a href="extensions-to-ggplot.html#cb529-32" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;Ethanol_Use&quot;</span>, <span class="st">&quot;Cirrhosis&quot;</span>, <span class="st">&quot;HCC&quot;</span>), <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">10</span>, .<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb529-33"><a href="extensions-to-ggplot.html#cb529-33" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Patients Presenting with Hepatitis C Infection&quot;</span>) <span class="sc">+</span></span>
<span id="cb529-34"><a href="extensions-to-ggplot.html#cb529-34" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1a85ff&quot;</span>, <span class="st">&quot;#d41159&quot;</span> ))</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/alluvial1-solution-1.png" width="672" /></p>
</div>
<div class="tryit">
<p>Now try this again. Copy the code below (click on the copy icon in the top right of the code chunk), paste it into your RStudio IDE, and edit to:</p>
<ul>
<li>show the progression of inpatients through therapies for Acute Severe Ulcerative colitis through the first 90 days of therapy. Code the outcome as Intact or Colectomy.</li>
<li>Use the examples above to build your alluvial plot</li>
</ul>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="extensions-to-ggplot.html#cb530-1" tabindex="-1"></a>datafr <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb530-2"><a href="extensions-to-ggplot.html#cb530-2" tabindex="-1"></a>  <span class="sc">~</span>Day_1_Therapy, <span class="sc">~</span>Day_7_Therapy, <span class="sc">~</span>Day_28_Therapy, <span class="sc">~</span>Day_90_Therapy, <span class="sc">~</span>outcome, <span class="sc">~</span>count,</span>
<span id="cb530-3"><a href="extensions-to-ggplot.html#cb530-3" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Pred + Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">19</span>,</span>
<span id="cb530-4"><a href="extensions-to-ggplot.html#cb530-4" tabindex="-1"></a> <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Pred + Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb530-5"><a href="extensions-to-ggplot.html#cb530-5" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Pred + Upa&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">4</span>,</span>
<span id="cb530-6"><a href="extensions-to-ggplot.html#cb530-6" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Cyclo&quot;</span>, <span class="st">&quot;Cyclo + IFX&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">12</span>,</span>
<span id="cb530-7"><a href="extensions-to-ggplot.html#cb530-7" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">9</span>,</span>
<span id="cb530-8"><a href="extensions-to-ggplot.html#cb530-8" tabindex="-1"></a>   <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">12</span>,</span>
<span id="cb530-9"><a href="extensions-to-ggplot.html#cb530-9" tabindex="-1"></a> <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">5</span>,</span>
<span id="cb530-10"><a href="extensions-to-ggplot.html#cb530-10" tabindex="-1"></a>  <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">7</span>,</span>
<span id="cb530-11"><a href="extensions-to-ggplot.html#cb530-11" tabindex="-1"></a>  <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Cyclo&quot;</span>, <span class="st">&quot;Cyclo + IFX&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">9</span>,</span>
<span id="cb530-12"><a href="extensions-to-ggplot.html#cb530-12" tabindex="-1"></a>  <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">7</span></span>
<span id="cb530-13"><a href="extensions-to-ggplot.html#cb530-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb530-14"><a href="extensions-to-ggplot.html#cb530-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day_1_Therapy =</span> <span class="fu">as_factor</span>(Day_1_Therapy),</span>
<span id="cb530-15"><a href="extensions-to-ggplot.html#cb530-15" tabindex="-1"></a>         <span class="at">Day_7_Therapy =</span> <span class="fu">as_factor</span>(Day_7_Therapy),</span>
<span id="cb530-16"><a href="extensions-to-ggplot.html#cb530-16" tabindex="-1"></a>         <span class="at">Day_28_Therapy =</span> <span class="fu">as_factor</span>(Day_28_Therapy),</span>
<span id="cb530-17"><a href="extensions-to-ggplot.html#cb530-17" tabindex="-1"></a>         <span class="at">Day_90_Therapy =</span> <span class="fu">as_factor</span>(Day_90_Therapy),</span>
<span id="cb530-18"><a href="extensions-to-ggplot.html#cb530-18" tabindex="-1"></a>         <span class="at">outcome =</span> <span class="fu">as_factor</span>(outcome))</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
alluvial2-solution
</button>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="extensions-to-ggplot.html#cb531-1" tabindex="-1"></a>datafr <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(</span>
<span id="cb531-2"><a href="extensions-to-ggplot.html#cb531-2" tabindex="-1"></a>  <span class="sc">~</span>Day_1_Therapy, <span class="sc">~</span>Day_7_Therapy, <span class="sc">~</span>Day_28_Therapy, <span class="sc">~</span>Day_90_Therapy, <span class="sc">~</span>outcome, <span class="sc">~</span>count,</span>
<span id="cb531-3"><a href="extensions-to-ggplot.html#cb531-3" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Pred + Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">19</span>,</span>
<span id="cb531-4"><a href="extensions-to-ggplot.html#cb531-4" tabindex="-1"></a> <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Pred + Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb531-5"><a href="extensions-to-ggplot.html#cb531-5" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Pred + Upa&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">4</span>,</span>
<span id="cb531-6"><a href="extensions-to-ggplot.html#cb531-6" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;Cyclo&quot;</span>, <span class="st">&quot;Cyclo + IFX&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">12</span>,</span>
<span id="cb531-7"><a href="extensions-to-ggplot.html#cb531-7" tabindex="-1"></a>  <span class="st">&quot;IVCS + Upa&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">9</span>,</span>
<span id="cb531-8"><a href="extensions-to-ggplot.html#cb531-8" tabindex="-1"></a>   <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">12</span>,</span>
<span id="cb531-9"><a href="extensions-to-ggplot.html#cb531-9" tabindex="-1"></a> <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">5</span>,</span>
<span id="cb531-10"><a href="extensions-to-ggplot.html#cb531-10" tabindex="-1"></a>  <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Upa&quot;</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">&quot;Colectomy&quot;</span>, <span class="dv">7</span>,</span>
<span id="cb531-11"><a href="extensions-to-ggplot.html#cb531-11" tabindex="-1"></a>  <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;Cyclo&quot;</span>, <span class="st">&quot;Cyclo + IFX&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">9</span>,</span>
<span id="cb531-12"><a href="extensions-to-ggplot.html#cb531-12" tabindex="-1"></a>  <span class="st">&quot;Upa&quot;</span>, <span class="st">&quot;IFX&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;IFX + Aza&quot;</span>, <span class="st">&quot;Intact&quot;</span>, <span class="dv">7</span></span>
<span id="cb531-13"><a href="extensions-to-ggplot.html#cb531-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb531-14"><a href="extensions-to-ggplot.html#cb531-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day_1_Therapy =</span> <span class="fu">as_factor</span>(Day_1_Therapy),</span>
<span id="cb531-15"><a href="extensions-to-ggplot.html#cb531-15" tabindex="-1"></a>         <span class="at">Day_7_Therapy =</span> <span class="fu">as_factor</span>(Day_7_Therapy),</span>
<span id="cb531-16"><a href="extensions-to-ggplot.html#cb531-16" tabindex="-1"></a>         <span class="at">Day_28_Therapy =</span> <span class="fu">as_factor</span>(Day_28_Therapy),</span>
<span id="cb531-17"><a href="extensions-to-ggplot.html#cb531-17" tabindex="-1"></a>         <span class="at">Day_90_Therapy =</span> <span class="fu">as_factor</span>(Day_90_Therapy),</span>
<span id="cb531-18"><a href="extensions-to-ggplot.html#cb531-18" tabindex="-1"></a>         <span class="at">outcome =</span> <span class="fu">as_factor</span>(outcome))</span>
<span id="cb531-19"><a href="extensions-to-ggplot.html#cb531-19" tabindex="-1"></a></span>
<span id="cb531-20"><a href="extensions-to-ggplot.html#cb531-20" tabindex="-1"></a><span class="fu">ggplot</span>(datafr, </span>
<span id="cb531-21"><a href="extensions-to-ggplot.html#cb531-21" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">y =</span> count, <span class="at">axis1 =</span> Day_1_Therapy, </span>
<span id="cb531-22"><a href="extensions-to-ggplot.html#cb531-22" tabindex="-1"></a>           <span class="at">axis2 =</span> Day_7_Therapy,</span>
<span id="cb531-23"><a href="extensions-to-ggplot.html#cb531-23" tabindex="-1"></a>           <span class="at">axis3 =</span> Day_28_Therapy,</span>
<span id="cb531-24"><a href="extensions-to-ggplot.html#cb531-24" tabindex="-1"></a>           <span class="at">axis4 =</span> Day_90_Therapy)) <span class="sc">+</span></span>
<span id="cb531-25"><a href="extensions-to-ggplot.html#cb531-25" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>(<span class="fu">aes</span>(<span class="at">fill =</span> outcome), <span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb531-26"><a href="extensions-to-ggplot.html#cb531-26" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">width =</span><span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb531-27"><a href="extensions-to-ggplot.html#cb531-27" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">stat =</span> <span class="st">&quot;stratum&quot;</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(stratum))) <span class="sc">+</span></span>
<span id="cb531-28"><a href="extensions-to-ggplot.html#cb531-28" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">&quot;Day_1_Rx&quot;</span>, <span class="st">&quot;Day_7_Rx&quot;</span>, <span class="st">&quot;Day_28_Rx&quot;</span>, <span class="st">&quot;Day_90_Rx&quot;</span>), <span class="at">expand =</span> <span class="fu">c</span>(.<span class="dv">18</span>,<span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb531-29"><a href="extensions-to-ggplot.html#cb531-29" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Patients Presenting with Acute Severe UC&quot;</span>) <span class="sc">+</span></span>
<span id="cb531-30"><a href="extensions-to-ggplot.html#cb531-30" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#1a85ff&quot;</span>, <span class="st">&quot;#d41159&quot;</span> )) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/alluvial2-solution-1.png" width="672" /></p>
</div>
</div>
<div id="lollipop-plots" class="section level2 hasAnchor" number="27.6">
<h2><span class="header-section-number">27.6</span> Lollipop Plots<a href="extensions-to-ggplot.html#lollipop-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While bar charts are quite popular for comparing continuous variables across categories, they have limitations. Humans are good at comparing length, but the bars add width, which is a distraction. Bar charts are also often used for counts, and it is not always clear whether a continuous or a discrete count variable is being plotted (a waffle chart can clear up discrete counts). For a continuous variable, you have a single point estimate (the end of the bar), and it is better to emphasize this estimate, without giving up the benefit of comparing lengths (which humans are good at). A lollipop plot emphasizes the continuous value, while de-emphasizing the width of a bar. Let’s look at an example below.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="extensions-to-ggplot.html#cb532-1" tabindex="-1"></a>medicaldata<span class="sc">::</span>covid_testing <span class="sc">%&gt;%</span> </span>
<span id="cb532-2"><a href="extensions-to-ggplot.html#cb532-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">positive =</span> <span class="fu">case_when</span>(ct_result <span class="sc">&lt;</span> <span class="dv">45</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb532-3"><a href="extensions-to-ggplot.html#cb532-3" tabindex="-1"></a>                              ct_result <span class="sc">&gt;=</span> <span class="dv">45</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb532-4"><a href="extensions-to-ggplot.html#cb532-4" tabindex="-1"></a>  <span class="fu">group_by</span>(demo_group) <span class="sc">%&gt;%</span> </span>
<span id="cb532-5"><a href="extensions-to-ggplot.html#cb532-5" tabindex="-1"></a>  <span class="fu">count</span>(positive) <span class="sc">%&gt;%</span> </span>
<span id="cb532-6"><a href="extensions-to-ggplot.html#cb532-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(positive)) <span class="sc">%&gt;%</span> </span>
<span id="cb532-7"><a href="extensions-to-ggplot.html#cb532-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> n<span class="sc">/</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb532-8"><a href="extensions-to-ggplot.html#cb532-8" tabindex="-1"></a>  <span class="fu">filter</span>(positive<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb532-9"><a href="extensions-to-ggplot.html#cb532-9" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb532-10"><a href="extensions-to-ggplot.html#cb532-10" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(demo_group, freq), <span class="at">y =</span> freq) <span class="sc">+</span> </span>
<span id="cb532-11"><a href="extensions-to-ggplot.html#cb532-11" tabindex="-1"></a>  <span class="fu">geom_lollipop</span>(<span class="at">point.size =</span> <span class="dv">5</span>, <span class="at">point.colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb532-12"><a href="extensions-to-ggplot.html#cb532-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(<span class="at">scale =</span> <span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb532-13"><a href="extensions-to-ggplot.html#cb532-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Percent Positive&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Demographic Category&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using the `size` aesthetic with geom_segment was deprecated in ggplot2 3.4.0.
## ℹ Please use the `linewidth` aesthetic instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="io48j-extension-plots_files/figure-html/lollipop-1.png" width="672" /></p>
</div>
<div id="dumbbell-plots" class="section level2 hasAnchor" number="27.7">
<h2><span class="header-section-number">27.7</span> Dumbbell Plots<a href="extensions-to-ggplot.html#dumbbell-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Dumbbell Plot is a visualization that shows change between two points (usually 2 time points) in our data. It gets the name because of its dumbbell shape. It’s a great way to show changes in data between two points (think start and finish).</p>
<p>Note that a bit of data wrangling needs to be done to produce the correct data format for geom_dumbbell(). You may need to pivot_wider() to get 2 columns of data on distinct dates (in this case, month 1 vs month 4). See the data wrangling below to get mean age for these 2 months.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="extensions-to-ggplot.html#cb534-1" tabindex="-1"></a>medicaldata<span class="sc">::</span>covid_testing <span class="sc">%&gt;%</span> </span>
<span id="cb534-2"><a href="extensions-to-ggplot.html#cb534-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(patient_class, <span class="st">&quot;surgery&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb534-3"><a href="extensions-to-ggplot.html#cb534-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pan_month =</span> <span class="fu">ceiling</span>((pan_day)<span class="sc">/</span><span class="dv">30</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb534-4"><a href="extensions-to-ggplot.html#cb534-4" tabindex="-1"></a>  <span class="fu">filter</span>(pan_month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb534-5"><a href="extensions-to-ggplot.html#cb534-5" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> pan_month,</span>
<span id="cb534-6"><a href="extensions-to-ggplot.html#cb534-6" tabindex="-1"></a>              <span class="at">values_from =</span> age,</span>
<span id="cb534-7"><a href="extensions-to-ggplot.html#cb534-7" tabindex="-1"></a>              <span class="at">id_cols =</span> patient_class,</span>
<span id="cb534-8"><a href="extensions-to-ggplot.html#cb534-8" tabindex="-1"></a>    <span class="at">values_fn =</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb534-9"><a href="extensions-to-ggplot.html#cb534-9" tabindex="-1"></a>              <span class="at">names_prefix =</span> <span class="st">&quot;month_&quot;</span>) <span class="ot">-&gt;</span></span>
<span id="cb534-10"><a href="extensions-to-ggplot.html#cb534-10" tabindex="-1"></a>dumb_covid_data</span>
<span id="cb534-11"><a href="extensions-to-ggplot.html#cb534-11" tabindex="-1"></a>dumb_covid_data</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   patient_class        month_1 month_4
##   &lt;chr&gt;                  &lt;dbl&gt;   &lt;dbl&gt;
## 1 inpatient               3.42    8.68
## 2 not applicable          9.11   24.6 
## 3 emergency               2.25   13.5 
## 4 recurring outpatient    2.21    6.93
## 5 observation             2.55   12.2 
## 6 outpatient              6.10   19.3</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="extensions-to-ggplot.html#cb536-1" tabindex="-1"></a>dumb_covid_data <span class="sc">%&gt;%</span> </span>
<span id="cb536-2"><a href="extensions-to-ggplot.html#cb536-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month_1, <span class="at">xend =</span> month_4, <span class="at">y =</span> patient_class,</span>
<span id="cb536-3"><a href="extensions-to-ggplot.html#cb536-3" tabindex="-1"></a>           <span class="at">group =</span> patient_class)) <span class="sc">+</span></span>
<span id="cb536-4"><a href="extensions-to-ggplot.html#cb536-4" tabindex="-1"></a>  <span class="fu">geom_dumbbell</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="co"># size of line</span></span>
<span id="cb536-5"><a href="extensions-to-ggplot.html#cb536-5" tabindex="-1"></a>      <span class="at">size_x =</span><span class="dv">4</span>, <span class="at">size_xend =</span> <span class="dv">4</span>, <span class="co"># dot size</span></span>
<span id="cb536-6"><a href="extensions-to-ggplot.html#cb536-6" tabindex="-1"></a>  <span class="at">colour =</span> <span class="st">&quot;lightblue2&quot;</span>, <span class="co">#line color</span></span>
<span id="cb536-7"><a href="extensions-to-ggplot.html#cb536-7" tabindex="-1"></a>  <span class="at">colour_x =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="co"># 1st dot color</span></span>
<span id="cb536-8"><a href="extensions-to-ggplot.html#cb536-8" tabindex="-1"></a>  <span class="at">colour_xend =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="co"># end dot color</span></span>
<span id="cb536-9"><a href="extensions-to-ggplot.html#cb536-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Patient Age&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Patient Class&quot;</span>,</span>
<span id="cb536-10"><a href="extensions-to-ggplot.html#cb536-10" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Increases in Mean Patient Age at a Pediatric Hospital </span><span class="sc">\n</span><span class="st">from Month 1 to Month 4 of the Pandemic&quot;</span>,</span>
<span id="cb536-11"><a href="extensions-to-ggplot.html#cb536-11" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Keeping the Young Ones Safe at Home&quot;</span>) <span class="sc">+</span></span>
<span id="cb536-12"><a href="extensions-to-ggplot.html#cb536-12" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">1</span>,<span class="dv">25</span>) <span class="sc">+</span> <span class="co"># set limits on x axis</span></span>
<span id="cb536-13"><a href="extensions-to-ggplot.html#cb536-13" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb536-14"><a href="extensions-to-ggplot.html#cb536-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>) <span class="co"># align title and subtitle to left edge, rather than to plot area+</span></span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/dumbbell-1.png" width="672" /></p>
<p>Now, this is a nice basic dumbbell plot. But you may want to make the direction of change from pre to post a bit more obvious with arrows.</p>
<p>We will start with loading some packages and creating a dataset with a ‘change’ variable for the change in C-reactive protein between day 1 and day 5 of a hospitalization for acute severe ulcerative colitis.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="extensions-to-ggplot.html#cb537-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb537-2"><a href="extensions-to-ggplot.html#cb537-2" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb537-3"><a href="extensions-to-ggplot.html#cb537-3" tabindex="-1"></a>dat <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>id, <span class="sc">~</span>crp1, <span class="sc">~</span>crp5,</span>
<span id="cb537-4"><a href="extensions-to-ggplot.html#cb537-4" tabindex="-1"></a>                       <span class="st">&quot;001&quot;</span>, <span class="dv">47</span>, <span class="dv">4</span>,</span>
<span id="cb537-5"><a href="extensions-to-ggplot.html#cb537-5" tabindex="-1"></a>                       <span class="st">&quot;002&quot;</span>, <span class="dv">14</span>, <span class="dv">58</span>,</span>
<span id="cb537-6"><a href="extensions-to-ggplot.html#cb537-6" tabindex="-1"></a>                       <span class="st">&quot;003&quot;</span>, <span class="dv">34</span>, <span class="dv">6</span>,</span>
<span id="cb537-7"><a href="extensions-to-ggplot.html#cb537-7" tabindex="-1"></a>                       <span class="st">&quot;004&quot;</span>, <span class="dv">129</span>, <span class="dv">12</span>,</span>
<span id="cb537-8"><a href="extensions-to-ggplot.html#cb537-8" tabindex="-1"></a>                       <span class="st">&quot;005&quot;</span>, <span class="dv">81</span>, <span class="dv">3</span>,</span>
<span id="cb537-9"><a href="extensions-to-ggplot.html#cb537-9" tabindex="-1"></a>                       <span class="st">&quot;006&quot;</span>, <span class="dv">65</span>, <span class="dv">7</span>)</span>
<span id="cb537-10"><a href="extensions-to-ggplot.html#cb537-10" tabindex="-1"></a></span>
<span id="cb537-11"><a href="extensions-to-ggplot.html#cb537-11" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">change =</span> crp5<span class="sc">-</span>crp1) <span class="sc">%&gt;%</span></span>
<span id="cb537-12"><a href="extensions-to-ggplot.html#cb537-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">linedir =</span> <span class="fu">case_when</span>(change<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb537-13"><a href="extensions-to-ggplot.html#cb537-13" tabindex="-1"></a>                             <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">1</span>)) <span class="ot">-&gt;</span> dat</span></code></pre></div>
<p>To help plot the points, we will add a long version of this simple dataset, created with pivot_longer.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="extensions-to-ggplot.html#cb538-1" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">&quot;crp&quot;</span>), <span class="at">names_prefix =</span> <span class="st">&quot;crp&quot;</span>, <span class="at">names_to =</span> <span class="st">&quot;day&quot;</span>)</span></code></pre></div>
<p>Now we will make the arrow plot (a fancier version of the dumbbell plot, with added directionality). We will use ggtext to help us turn our title into a color legend.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="extensions-to-ggplot.html#cb539-1" tabindex="-1"></a><span class="co">#set custom colors</span></span>
<span id="cb539-2"><a href="extensions-to-ggplot.html#cb539-2" tabindex="-1"></a>custom_days <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#1e90ff&quot;</span>, <span class="st">&quot;#1874cd&quot;</span>)</span>
<span id="cb539-3"><a href="extensions-to-ggplot.html#cb539-3" tabindex="-1"></a>custom_dir <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;limegreen&quot;</span>, <span class="st">&quot;firebrick&quot;</span>)</span>
<span id="cb539-4"><a href="extensions-to-ggplot.html#cb539-4" tabindex="-1"></a></span>
<span id="cb539-5"><a href="extensions-to-ggplot.html#cb539-5" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb539-6"><a href="extensions-to-ggplot.html#cb539-6" tabindex="-1"></a>  <span class="co"># geom segment will plot arrows from the dat dataset</span></span>
<span id="cb539-7"><a href="extensions-to-ggplot.html#cb539-7" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> crp1, <span class="at">xend =</span> crp5,</span>
<span id="cb539-8"><a href="extensions-to-ggplot.html#cb539-8" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">parse_number</span>(id), </span>
<span id="cb539-9"><a href="extensions-to-ggplot.html#cb539-9" tabindex="-1"></a>            <span class="at">yend =</span> <span class="fu">parse_number</span>(id), </span>
<span id="cb539-10"><a href="extensions-to-ggplot.html#cb539-10" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">as_factor</span>(linedir)), <span class="at">linewidth =</span> <span class="fl">1.5</span>,</span>
<span id="cb539-11"><a href="extensions-to-ggplot.html#cb539-11" tabindex="-1"></a>      <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle =</span> <span class="dv">25</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>))) <span class="sc">+</span></span>
<span id="cb539-12"><a href="extensions-to-ggplot.html#cb539-12" tabindex="-1"></a>   <span class="co"># geom point will plot the points from the dat_long dataset</span></span>
<span id="cb539-13"><a href="extensions-to-ggplot.html#cb539-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dat_long,</span>
<span id="cb539-14"><a href="extensions-to-ggplot.html#cb539-14" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> <span class="fu">parse_number</span>(id), <span class="at">fill =</span> day), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">22</span>) <span class="sc">+</span></span>
<span id="cb539-15"><a href="extensions-to-ggplot.html#cb539-15" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb539-16"><a href="extensions-to-ggplot.html#cb539-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_markdown</span>()) <span class="sc">+</span></span>
<span id="cb539-17"><a href="extensions-to-ggplot.html#cb539-17" tabindex="-1"></a>  <span class="co"># notice how we color the text in the title - this is allowed by `element_markdown` in the theme for plot.title. This makes the text function as a legend for the plot</span></span>
<span id="cb539-18"><a href="extensions-to-ggplot.html#cb539-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;CRP in mg/L&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Patient ID&quot;</span>,</span>
<span id="cb539-19"><a href="extensions-to-ggplot.html#cb539-19" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Change in CRP from &lt;span style = &#39;color:#1e90ff;&#39;&gt;Day 1&lt;/span&gt;  to &lt;span style = &#39;color:#1874cd;&#39;&gt;Day 5&lt;/span&gt;&quot;</span>) <span class="sc">+</span></span>
<span id="cb539-20"><a href="extensions-to-ggplot.html#cb539-20" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb539-21"><a href="extensions-to-ggplot.html#cb539-21" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">25</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>,<span class="dv">125</span>,<span class="dv">150</span>)) <span class="sc">+</span></span>
<span id="cb539-22"><a href="extensions-to-ggplot.html#cb539-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="co"># turn off the actual legend</span></span>
<span id="cb539-23"><a href="extensions-to-ggplot.html#cb539-23" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> custom_days) <span class="sc">+</span></span>
<span id="cb539-24"><a href="extensions-to-ggplot.html#cb539-24" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> custom_dir) <span class="sc">+</span></span>
<span id="cb539-25"><a href="extensions-to-ggplot.html#cb539-25" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="co"># flip it so CRP goes up or down</span></span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>This is another variant on the dumbbell plot that helps show directionality. We have used {ggtext} to format and color words in the title so that they can work as a legend. We have used custom colors for the arrows to show good (CRP going down) and bad (CRP rising) outcomes and directionalitywith the arrowheads.</p>
</div>
<div id="spaghetti-plots-with-summary-smoothed-lines-for-change-over-time" class="section level2 hasAnchor" number="27.8">
<h2><span class="header-section-number">27.8</span> Spaghetti Plots with Summary Smoothed Lines for Change Over Time<a href="extensions-to-ggplot.html#spaghetti-plots-with-summary-smoothed-lines-for-change-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Spaghetti Plot is a visualization that shows change over multiple time points for longitudinal data, which lets you see change in each individual as a line. It gets the name because the result (with method = “lm”) looks a bit like you scattered uncooked spaghetti (straight lines) on the plot. It’s a great way to show changes in data over multiple time points, and there are multiple variants, including summary smoothed lines.</p>
<p>Note that a bit of data wrangling needs to be done to produce the correct data format for geom_line(). You may need to pivot_longer() to get 1 row of data for each data point, and an id for each individual (multiple points making up a line. This id will often be a patient id (pat_id). We will read in some simulated data below for 4 time points. The variables are time point, the value, ses (2 categories), elderly (2 categories), and pat_id for 8 patients.</p>
<p>The code below will illustrate the basic spaghetti plot.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="extensions-to-ggplot.html#cb540-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>time, <span class="sc">~</span>value, <span class="sc">~</span>ses, <span class="sc">~</span>elderly, <span class="sc">~</span>pat_id, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">3</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,  <span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">3</span>,<span class="dv">11</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>, <span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>, <span class="dv">3</span>,<span class="dv">15</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">6</span>, <span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">6</span>,  <span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">6</span>, <span class="dv">3</span>,<span class="dv">13</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">6</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>, <span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>, <span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>, <span class="dv">3</span>,<span class="dv">14</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">7</span>, <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">8</span>, <span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">8</span>, <span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">8</span>, <span class="dv">3</span>,<span class="dv">16</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">8</span>)</span>
<span id="cb540-2"><a href="extensions-to-ggplot.html#cb540-2" tabindex="-1"></a></span>
<span id="cb540-3"><a href="extensions-to-ggplot.html#cb540-3" tabindex="-1"></a></span>
<span id="cb540-4"><a href="extensions-to-ggplot.html#cb540-4" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, </span>
<span id="cb540-5"><a href="extensions-to-ggplot.html#cb540-5" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(pat_id))) <span class="sc">+</span></span>
<span id="cb540-6"><a href="extensions-to-ggplot.html#cb540-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb540-7"><a href="extensions-to-ggplot.html#cb540-7" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb540-8"><a href="extensions-to-ggplot.html#cb540-8" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observation Time Point&quot;</span>) <span class="sc">+</span></span>
<span id="cb540-9"><a href="extensions-to-ggplot.html#cb540-9" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y&quot;</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti-1.png" width="672" /></p>
<p>As you can see, a bit like spilled (uncooked) spaghetti, with a line for each patient. Each patient is the same (default) color. Note that it is <strong>critical</strong> to group y the patient id (group = factor(pat_id)) so that ggplot knows which points go together as a line. If you remove this bit of code for the group argument, you get chaos from <em>geom_smooth()</em> or <em>geom_line()</em>. We can also let each patient’s line follow their actual values, rather than a fitted line, with a few modifications. Try this below.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="extensions-to-ggplot.html#cb541-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, </span>
<span id="cb541-2"><a href="extensions-to-ggplot.html#cb541-2" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(pat_id))) <span class="sc">+</span></span>
<span id="cb541-3"><a href="extensions-to-ggplot.html#cb541-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb541-4"><a href="extensions-to-ggplot.html#cb541-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb541-5"><a href="extensions-to-ggplot.html#cb541-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observation Time Point&quot;</span>) <span class="sc">+</span></span>
<span id="cb541-6"><a href="extensions-to-ggplot.html#cb541-6" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y&quot;</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti2-1.png" width="672" />
Now each patient is represented by a line (and points) with more detail than a fitted straight line.</p>
<p>We can also chose to color these lines in two classes by ses (SocioEconomic Status) by setting color = factor(ses). We can make the legend neater by putting it inside the plot boundaries with theme (legend.position), and use the x and y range from 0 to 1 to position it as below.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="extensions-to-ggplot.html#cb542-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, </span>
<span id="cb542-2"><a href="extensions-to-ggplot.html#cb542-2" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(pat_id), <span class="at">color =</span> <span class="fu">factor</span>(ses))) <span class="sc">+</span></span>
<span id="cb542-3"><a href="extensions-to-ggplot.html#cb542-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb542-4"><a href="extensions-to-ggplot.html#cb542-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb542-5"><a href="extensions-to-ggplot.html#cb542-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb542-6"><a href="extensions-to-ggplot.html#cb542-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observation Time Point&quot;</span>) <span class="sc">+</span></span>
<span id="cb542-7"><a href="extensions-to-ggplot.html#cb542-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y&quot;</span>) </span></code></pre></div>
<pre><code>## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
## 3.5.0.
## ℹ Please use the `legend.position.inside` argument of `theme()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti3-1.png" width="672" /></p>
<p>If we want to summarize the overall pattern, we can use a <em>geom_smooth()</em> with the default loess smoothing. We set the color to “black”, rather than the color of either SES group. We need to turn off the grouping with group = NULL to get a single summary line. Note the loess smoothing produces a curve.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="extensions-to-ggplot.html#cb544-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, </span>
<span id="cb544-2"><a href="extensions-to-ggplot.html#cb544-2" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(pat_id), <span class="at">color =</span> <span class="fu">factor</span>(ses))) <span class="sc">+</span></span>
<span id="cb544-3"><a href="extensions-to-ggplot.html#cb544-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb544-4"><a href="extensions-to-ggplot.html#cb544-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb544-5"><a href="extensions-to-ggplot.html#cb544-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb544-6"><a href="extensions-to-ggplot.html#cb544-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observation Time Point&quot;</span>) <span class="sc">+</span></span>
<span id="cb544-7"><a href="extensions-to-ggplot.html#cb544-7" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb544-8"><a href="extensions-to-ggplot.html#cb544-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="cn">NULL</span>))</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti4-1.png" width="672" /></p>
<p>If we want to get fancy, we can also make summary curves for each ses group, and facet the plot by elderly status, as below.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="extensions-to-ggplot.html#cb545-1" tabindex="-1"></a>elderly_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb545-2"><a href="extensions-to-ggplot.html#cb545-2" tabindex="-1"></a> <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Young&quot;</span>,</span>
<span id="cb545-3"><a href="extensions-to-ggplot.html#cb545-3" tabindex="-1"></a> <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Old&quot;</span>) </span>
<span id="cb545-4"><a href="extensions-to-ggplot.html#cb545-4" tabindex="-1"></a></span>
<span id="cb545-5"><a href="extensions-to-ggplot.html#cb545-5" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> value, </span>
<span id="cb545-6"><a href="extensions-to-ggplot.html#cb545-6" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(pat_id), <span class="at">color =</span> <span class="fu">factor</span>(ses))) <span class="sc">+</span></span>
<span id="cb545-7"><a href="extensions-to-ggplot.html#cb545-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb545-8"><a href="extensions-to-ggplot.html#cb545-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb545-9"><a href="extensions-to-ggplot.html#cb545-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb545-10"><a href="extensions-to-ggplot.html#cb545-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Observation Time Point&quot;</span>) <span class="sc">+</span></span>
<span id="cb545-11"><a href="extensions-to-ggplot.html#cb545-11" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb545-12"><a href="extensions-to-ggplot.html#cb545-12" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,   <span class="fu">aes</span>(<span class="at">group =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="fu">factor</span>(ses))) <span class="sc">+</span></span>
<span id="cb545-13"><a href="extensions-to-ggplot.html#cb545-13" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>elderly)</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti5-1.png" width="672" /></p>
<p>This gives us a plot faceted into two graphs, one for the elderly on the right, and the non-elderly on the left. Each individual is represented by points and a connected line. SES status is indicated by color, and a summary curve of each SES group is a thicker (size=1) loess curve.</p>
<div class="tryit">
<p>Now try this yourself. Copy the code below (click on the copy icon in the top right of the code chunk), paste it into your RStudio IDE, and edit to:
(Note you only have to read in the data (dat) once, just copy and edit the ggplot thereafter)</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="extensions-to-ggplot.html#cb546-1" tabindex="-1"></a>dat <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span> patid, <span class="sc">~</span>week, <span class="sc">~</span>crp, <span class="sc">~</span>fcp, <span class="sc">~</span>flare, <span class="sc">~</span>dz_type, <span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="dv">191</span>,<span class="dv">1</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">1</span>,<span class="dv">3</span>,<span class="fl">1.1</span>,<span class="dv">302</span>,<span class="dv">1</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">1</span>,<span class="dv">8</span>,<span class="fl">1.5</span>,<span class="dv">507</span>,<span class="dv">1</span>,<span class="st">&quot;uc&quot;</span>, </span>
<span id="cb546-2"><a href="extensions-to-ggplot.html#cb546-2" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="dv">214</span>,<span class="dv">1</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">2</span>,<span class="dv">3</span>,<span class="fl">1.2</span>,<span class="dv">412</span>,<span class="dv">1</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">2</span>,<span class="dv">8</span>,<span class="fl">1.6</span>,<span class="dv">647</span>,<span class="dv">1</span>,<span class="st">&quot;cd&quot;</span>,  </span>
<span id="cb546-3"><a href="extensions-to-ggplot.html#cb546-3" tabindex="-1"></a>       <span class="dv">3</span>,<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="dv">137</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">0.5</span>,<span class="dv">101</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">3</span>,<span class="dv">8</span>,<span class="fl">0.4</span>,<span class="dv">58</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, </span>
<span id="cb546-4"><a href="extensions-to-ggplot.html#cb546-4" tabindex="-1"></a>      <span class="dv">4</span>,<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">112</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">4</span>,<span class="dv">3</span>,<span class="fl">0.3</span>,<span class="dv">81</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">4</span>,<span class="dv">8</span>,<span class="fl">0.1</span>,<span class="dv">44</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>,</span>
<span id="cb546-5"><a href="extensions-to-ggplot.html#cb546-5" tabindex="-1"></a>      <span class="dv">5</span>,<span class="dv">1</span>,<span class="fl">0.6</span>,<span class="dv">119</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">5</span>,<span class="dv">3</span>,<span class="fl">0.4</span>,<span class="dv">87</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">5</span>,<span class="dv">8</span>,<span class="fl">0.3</span>,<span class="dv">57</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, </span>
<span id="cb546-6"><a href="extensions-to-ggplot.html#cb546-6" tabindex="-1"></a>     <span class="dv">6</span>,<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="dv">216</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">6</span>,<span class="dv">3</span>,<span class="fl">0.5</span>,<span class="dv">161</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">6</span>,<span class="dv">8</span>,<span class="fl">0.3</span>,<span class="dv">92</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, </span>
<span id="cb546-7"><a href="extensions-to-ggplot.html#cb546-7" tabindex="-1"></a>       <span class="dv">7</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,<span class="dv">267</span>,<span class="dv">1</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">7</span>,<span class="dv">3</span>,<span class="fl">1.1</span>,<span class="dv">412</span>,<span class="dv">1</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">7</span>,<span class="dv">8</span>,<span class="fl">1.9</span>,<span class="dv">692</span>,<span class="dv">1</span>,<span class="st">&quot;uc&quot;</span>,</span>
<span id="cb546-8"><a href="extensions-to-ggplot.html#cb546-8" tabindex="-1"></a>  <span class="dv">8</span>,<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="dv">212</span>,<span class="dv">1</span>,<span class="st">&quot;cd&quot;</span>,  <span class="dv">8</span>,<span class="dv">3</span>,<span class="fl">1.1</span>,<span class="dv">342</span>,<span class="dv">1</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">8</span>,<span class="dv">8</span>,<span class="fl">1.6</span>,<span class="dv">517</span>,<span class="dv">1</span>,<span class="st">&quot;cd&quot;</span>, </span>
<span id="cb546-9"><a href="extensions-to-ggplot.html#cb546-9" tabindex="-1"></a>  <span class="dv">9</span>,<span class="dv">1</span>,<span class="fl">0.9</span>,<span class="dv">197</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">9</span>,<span class="dv">3</span>,<span class="fl">0.6</span>,<span class="dv">134</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">9</span>,<span class="dv">8</span>,<span class="fl">0.4</span>,<span class="dv">86</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, </span>
<span id="cb546-10"><a href="extensions-to-ggplot.html#cb546-10" tabindex="-1"></a><span class="dv">10</span>,<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="dv">143</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">10</span>,<span class="dv">3</span>,<span class="fl">0.4</span>,<span class="dv">101</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, <span class="dv">10</span>,<span class="dv">8</span>,<span class="fl">0.3</span>,<span class="dv">64</span>,<span class="dv">0</span>,<span class="st">&quot;cd&quot;</span>, </span>
<span id="cb546-11"><a href="extensions-to-ggplot.html#cb546-11" tabindex="-1"></a><span class="dv">11</span>,<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="dv">217</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">11</span>,<span class="dv">3</span>,<span class="fl">0.4</span>,<span class="dv">153</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>, <span class="dv">11</span>,<span class="dv">8</span>,<span class="fl">0.3</span>,<span class="dv">51</span>,<span class="dv">0</span>,<span class="st">&quot;uc&quot;</span>)</span>
<span id="cb546-12"><a href="extensions-to-ggplot.html#cb546-12" tabindex="-1"></a></span>
<span id="cb546-13"><a href="extensions-to-ggplot.html#cb546-13" tabindex="-1"></a></span>
<span id="cb546-14"><a href="extensions-to-ggplot.html#cb546-14" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> crp, </span>
<span id="cb546-15"><a href="extensions-to-ggplot.html#cb546-15" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">factor</span>(patid),</span>
<span id="cb546-16"><a href="extensions-to-ggplot.html#cb546-16" tabindex="-1"></a>                <span class="at">color=</span> <span class="fu">factor</span>(patid))) <span class="sc">+</span></span>
<span id="cb546-17"><a href="extensions-to-ggplot.html#cb546-17" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb546-18"><a href="extensions-to-ggplot.html#cb546-18" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb546-19"><a href="extensions-to-ggplot.html#cb546-19" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Week&quot;</span>) <span class="sc">+</span></span>
<span id="cb546-20"><a href="extensions-to-ggplot.html#cb546-20" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;CRP&quot;</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<ul>
<li><ol style="list-style-type: decimal">
<li>See the initial plot above for CRP with smooth lines for each patient, then try it for FCP.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>Now plot the CRP values, and change the grouping to patid without colors, and use geom_point() and geom_line() rather than geom_smooth to see the CRP trends in black.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>Now plot the CRP values, and add to the aes, color = factor(dz_type) OR color= factor(flare) to group = factor(patid)</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>Now plot the FCP values, and add the geom_smooth with group = NULL and color = factor(flare). Also facet_grid by dz_type, and see if you can improve the default legend title and labels (might need to google these).</li>
</ol></li>
</ul>
<p>Click on the <code>Solution</code> buttons below to toggle showing or hiding each solution.</p>
</div>
<div class="webex-solution">
<button>
Solution 1
</button>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="extensions-to-ggplot.html#cb547-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> crp, </span>
<span id="cb547-2"><a href="extensions-to-ggplot.html#cb547-2" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">factor</span>(patid),</span>
<span id="cb547-3"><a href="extensions-to-ggplot.html#cb547-3" tabindex="-1"></a>                <span class="at">color=</span> <span class="fu">factor</span>(patid))) <span class="sc">+</span></span>
<span id="cb547-4"><a href="extensions-to-ggplot.html#cb547-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">se =</span> <span class="cn">FALSE</span>, </span>
<span id="cb547-5"><a href="extensions-to-ggplot.html#cb547-5" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span></span>
<span id="cb547-6"><a href="extensions-to-ggplot.html#cb547-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Week&quot;</span>, <span class="at">y =</span> <span class="st">&quot;CRP&quot;</span>, <span class="at">title =</span> <span class="st">&quot;CRP by week&quot;</span>) <span class="sc">+</span></span>
<span id="cb547-7"><a href="extensions-to-ggplot.html#cb547-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb547-8"><a href="extensions-to-ggplot.html#cb547-8" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti-solution1-1.png" width="672" /></p>
</div>
<div class="webex-solution">
<button>
Solution 2
</button>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="extensions-to-ggplot.html#cb548-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> crp, </span>
<span id="cb548-2"><a href="extensions-to-ggplot.html#cb548-2" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">factor</span>(patid))) <span class="sc">+</span></span>
<span id="cb548-3"><a href="extensions-to-ggplot.html#cb548-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb548-4"><a href="extensions-to-ggplot.html#cb548-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb548-5"><a href="extensions-to-ggplot.html#cb548-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Week&quot;</span>, <span class="at">y =</span> <span class="st">&quot;CRP&quot;</span>, <span class="at">title =</span> <span class="st">&quot;CRP by week&quot;</span>) <span class="sc">+</span></span>
<span id="cb548-6"><a href="extensions-to-ggplot.html#cb548-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb548-7"><a href="extensions-to-ggplot.html#cb548-7" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti-solution2-1.png" width="672" /></p>
</div>
<div class="webex-solution">
<button>
Solution 3
</button>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="extensions-to-ggplot.html#cb549-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> crp, </span>
<span id="cb549-2"><a href="extensions-to-ggplot.html#cb549-2" tabindex="-1"></a>      <span class="at">group =</span> <span class="fu">factor</span>(patid),</span>
<span id="cb549-3"><a href="extensions-to-ggplot.html#cb549-3" tabindex="-1"></a>      <span class="at">color =</span> <span class="fu">factor</span>(flare))) <span class="sc">+</span></span>
<span id="cb549-4"><a href="extensions-to-ggplot.html#cb549-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb549-5"><a href="extensions-to-ggplot.html#cb549-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb549-6"><a href="extensions-to-ggplot.html#cb549-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Week&quot;</span>, <span class="at">y =</span> <span class="st">&quot;CRP&quot;</span>, <span class="at">title =</span> <span class="st">&quot;CRP by week&quot;</span>) <span class="sc">+</span></span>
<span id="cb549-7"><a href="extensions-to-ggplot.html#cb549-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb549-8"><a href="extensions-to-ggplot.html#cb549-8" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb549-9"><a href="extensions-to-ggplot.html#cb549-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Flare&quot;</span>)</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti-solution3-1.png" width="672" /></p>
</div>
<div class="webex-solution">
<button>
Solution 4
</button>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="extensions-to-ggplot.html#cb550-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> fcp, </span>
<span id="cb550-2"><a href="extensions-to-ggplot.html#cb550-2" tabindex="-1"></a>                <span class="at">group =</span> <span class="fu">factor</span>(patid),</span>
<span id="cb550-3"><a href="extensions-to-ggplot.html#cb550-3" tabindex="-1"></a>       <span class="at">color =</span> <span class="fu">factor</span>(flare))) <span class="sc">+</span></span>
<span id="cb550-4"><a href="extensions-to-ggplot.html#cb550-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb550-5"><a href="extensions-to-ggplot.html#cb550-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb550-6"><a href="extensions-to-ggplot.html#cb550-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Week&quot;</span>, <span class="at">y =</span> <span class="st">&quot;FCP&quot;</span>, <span class="at">title =</span> <span class="st">&quot;FCP by week&quot;</span>) <span class="sc">+</span></span>
<span id="cb550-7"><a href="extensions-to-ggplot.html#cb550-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb550-8"><a href="extensions-to-ggplot.html#cb550-8" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x=</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb550-9"><a href="extensions-to-ggplot.html#cb550-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">size=</span><span class="dv">2</span>, <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,   <span class="fu">aes</span>(<span class="at">group =</span> <span class="cn">NULL</span>, <span class="at">color =</span> <span class="fu">factor</span>(flare))) <span class="sc">+</span></span>
<span id="cb550-10"><a href="extensions-to-ggplot.html#cb550-10" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>dz_type)  <span class="sc">+</span></span>
<span id="cb550-11"><a href="extensions-to-ggplot.html#cb550-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Flare&quot;</span>) <span class="sc">+</span></span>
<span id="cb550-12"><a href="extensions-to-ggplot.html#cb550-12" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>),</span>
<span id="cb550-13"><a href="extensions-to-ggplot.html#cb550-13" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>))</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/spaghetti-solution4-1.png" width="672" /></p>
</div>
</div>
<div id="swimmer-plots" class="section level2 hasAnchor" number="27.9">
<h2><span class="header-section-number">27.9</span> Swimmer Plots<a href="extensions-to-ggplot.html#swimmer-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Swimmer Plot is a visualization that shows treatment timelines, with each patient in their own “lane”. It gets the name because it looks a bit like a pool at a swim meet, where you can see the progress of each patient over time. These can help visualize treatment or measurement patterns, clinical events, time-varying covariates, outcomes, and loss to follow-up in longitudinal data settings. These work well with a moderate number of patient courses (usually 10-50), and can be illuminating when new approaches to therapy are being tried in small numbers of patients, like a case series.</p>
<p>Note that this is not done with a particular package, but with standard geom_line and geom_point, but with a lot of customization in ggplot worth learning about.</p>
<p>This section borrows heavily from a nice blog post from statistician Kat Hoffman <a href="https://www.khstats.com/blog/trt-timelines/multiple-vars.html#just-the-code">here</a>. Note that a bit of data wrangling needs to be done to produce the correct data format for swimmer plots. We will read in some simulated data of COVID patients from spring 2020 from Kat Hoffman. The original data includes one row per day for each patient, with dichotomous outcomes for the events we are interested in: intubation status, use of steroids, the first day of severe hypoxia status, and death.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="extensions-to-ggplot.html#cb551-1" tabindex="-1"></a><span class="co"># install.packages(c(&quot;tidyverse&quot;,&quot;gt&quot;,&quot;RCurl&quot;,&quot;rmarkdown&quot;))</span></span>
<span id="cb551-2"><a href="extensions-to-ggplot.html#cb551-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb551-3"><a href="extensions-to-ggplot.html#cb551-3" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb551-4"><a href="extensions-to-ggplot.html#cb551-4" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb551-5"><a href="extensions-to-ggplot.html#cb551-5" tabindex="-1"></a></span>
<span id="cb551-6"><a href="extensions-to-ggplot.html#cb551-6" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/kathoffman/steroids-trial-emulation/main/data/dat_trt_timeline.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">list</span>(<span class="at">id  =</span> <span class="st">&quot;c&quot;</span>, <span class="at">steroids =</span> <span class="st">&quot;c&quot;</span>, <span class="at">death =</span> <span class="st">&quot;c&quot;</span>, <span class="at">severe =</span> <span class="st">&quot;c&quot;</span>))</span>
<span id="cb551-7"><a href="extensions-to-ggplot.html#cb551-7" tabindex="-1"></a>dat_long <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   id      day intubation_status steroids death severe
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; 
## 1 797       0 Not intubated     0        0     0     
## 2 797       1 Not intubated     0        0     0     
## 3 797       2 Not intubated     0        0     1     
## 4 797       3 Not intubated     0        0     0     
## 5 797       4 Not intubated     0        0     0     
## 6 797       5 Not intubated     0        0     0</code></pre>
<p>We can use geom_line to plot the length of stay, with day on thex axis and lines colored by intubation status and grouped by patient id.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="extensions-to-ggplot.html#cb553-1" tabindex="-1"></a>dat_long <span class="sc">|&gt;</span></span>
<span id="cb553-2"><a href="extensions-to-ggplot.html#cb553-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>id, <span class="at">col =</span> intubation_status, <span class="at">group=</span>id)) <span class="sc">+</span></span>
<span id="cb553-3"><a href="extensions-to-ggplot.html#cb553-3" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb553-4"><a href="extensions-to-ggplot.html#cb553-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>While this is very simple, it gives you a quick look at how these 30 simulated patients did in the hospital.</p>
<p>We can add steroid use by day as colored points with geom_point, in one added line of code, as seen below.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="extensions-to-ggplot.html#cb554-1" tabindex="-1"></a>dat_long <span class="sc">|&gt;</span></span>
<span id="cb554-2"><a href="extensions-to-ggplot.html#cb554-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>id, <span class="at">col =</span> intubation_status, <span class="at">group=</span>id)) <span class="sc">+</span></span>
<span id="cb554-3"><a href="extensions-to-ggplot.html#cb554-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>id, <span class="at">col =</span> steroids)) <span class="sc">+</span></span>
<span id="cb554-4"><a href="extensions-to-ggplot.html#cb554-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb554-5"><a href="extensions-to-ggplot.html#cb554-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>This gets a bit messy, as we have different colors of points (steroids on/steroids off) obscuring the colors of the lines indicating intubation. It is time for a bit of data wrangling. <br>
To help clarify things in data wrangling step 1, let’s create new variables to specify on which day(s) steroids were used, the first day that severe hypoxia was present, and when death occurred. These variables will have lots of NA values when things did not occur - so that we won’t plot points when the events did <strong>not</strong> occur (NA days), and will have days for the values when the events occurred, which makes these easier to plot on the x axis. These NAs will be removed (and generate a lot of warnings) when plotting, so I will use an option to turn off messages and warnings in this section.</p>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="extensions-to-ggplot.html#cb555-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">message=</span>F, <span class="at">warning=</span>F)</span>
<span id="cb555-2"><a href="extensions-to-ggplot.html#cb555-2" tabindex="-1"></a></span>
<span id="cb555-3"><a href="extensions-to-ggplot.html#cb555-3" tabindex="-1"></a>dat_swim <span class="ot">&lt;-</span></span>
<span id="cb555-4"><a href="extensions-to-ggplot.html#cb555-4" tabindex="-1"></a>  dat_long <span class="sc">|&gt;</span></span>
<span id="cb555-5"><a href="extensions-to-ggplot.html#cb555-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">severe_this_day =</span> <span class="fu">case_when</span>(severe <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> day),</span>
<span id="cb555-6"><a href="extensions-to-ggplot.html#cb555-6" tabindex="-1"></a>         <span class="at">steroids_this_day =</span> <span class="fu">case_when</span>(steroids <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> day),</span>
<span id="cb555-7"><a href="extensions-to-ggplot.html#cb555-7" tabindex="-1"></a>         <span class="at">death_this_day =</span> <span class="fu">case_when</span>(death <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> day))</span></code></pre></div>
<p>In in data wrangling step 2, it would also make it easier to read the plot if the patients were arranged by length of stay (max_day), so we will use fct_reorder() to make the patient ids (factors) ordered by length of stay.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="extensions-to-ggplot.html#cb556-1" tabindex="-1"></a>dat_swim <span class="ot">&lt;-</span> </span>
<span id="cb556-2"><a href="extensions-to-ggplot.html#cb556-2" tabindex="-1"></a>  dat_swim <span class="sc">|&gt;</span></span>
<span id="cb556-3"><a href="extensions-to-ggplot.html#cb556-3" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">|&gt;</span></span>
<span id="cb556-4"><a href="extensions-to-ggplot.html#cb556-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">max_day =</span> <span class="fu">max</span>(day)) <span class="sc">|&gt;</span></span>
<span id="cb556-5"><a href="extensions-to-ggplot.html#cb556-5" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb556-6"><a href="extensions-to-ggplot.html#cb556-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(id), max_day))</span>
<span id="cb556-7"><a href="extensions-to-ggplot.html#cb556-7" tabindex="-1"></a></span>
<span id="cb556-8"><a href="extensions-to-ggplot.html#cb556-8" tabindex="-1"></a><span class="fu">head</span>(dat_swim) <span class="sc">|&gt;</span> <span class="fu">paged_table</span>()</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["fct"],"align":["left"]},{"label":["day"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["intubation_status"],"name":[3],"type":["chr"],"align":["left"]},{"label":["steroids"],"name":[4],"type":["chr"],"align":["left"]},{"label":["death"],"name":[5],"type":["chr"],"align":["left"]},{"label":["severe"],"name":[6],"type":["chr"],"align":["left"]},{"label":["severe_this_day"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["steroids_this_day"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["death_this_day"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["max_day"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"797","2":"0","3":"Not intubated","4":"0","5":"0","6":"0","7":"NA","8":"NA","9":"NA","10":"16"},{"1":"797","2":"1","3":"Not intubated","4":"0","5":"0","6":"0","7":"NA","8":"NA","9":"NA","10":"16"},{"1":"797","2":"2","3":"Not intubated","4":"0","5":"0","6":"1","7":"2","8":"NA","9":"NA","10":"16"},{"1":"797","2":"3","3":"Not intubated","4":"0","5":"0","6":"0","7":"NA","8":"NA","9":"NA","10":"16"},{"1":"797","2":"4","3":"Not intubated","4":"0","5":"0","6":"0","7":"NA","8":"NA","9":"NA","10":"16"},{"1":"797","2":"5","3":"Not intubated","4":"0","5":"0","6":"0","7":"NA","8":"NA","9":"NA","10":"16"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>After this data wrangling, now we can plot the data again, arranged by LOS and with only the steroid used days as visible points.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="extensions-to-ggplot.html#cb557-1" tabindex="-1"></a>dat_swim <span class="sc">|&gt;</span> </span>
<span id="cb557-2"><a href="extensions-to-ggplot.html#cb557-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb557-3"><a href="extensions-to-ggplot.html#cb557-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>id, <span class="at">col =</span> intubation_status, <span class="at">group=</span>id)) <span class="sc">+</span></span>
<span id="cb557-4"><a href="extensions-to-ggplot.html#cb557-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>steroids_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Steroids&quot;</span>, <span class="at">shape=</span><span class="st">&quot;Steroids&quot;</span>)) <span class="sc">+</span></span>
<span id="cb557-5"><a href="extensions-to-ggplot.html#cb557-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>This is nicer to look at, though the legend is still a bit of a mess, and you can now clearly see that steroids were largely used for intubated patients at this point. It would look nicer if the lines were nearly as thick as the points, so that they are less obscured. Let’s fix this with a larger geom_line size, and format the steroid points with a shape for contrast.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="extensions-to-ggplot.html#cb558-1" tabindex="-1"></a>dat_swim <span class="sc">|&gt;</span> </span>
<span id="cb558-2"><a href="extensions-to-ggplot.html#cb558-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb558-3"><a href="extensions-to-ggplot.html#cb558-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>id, <span class="at">col =</span> intubation_status, <span class="at">group=</span>id),</span>
<span id="cb558-4"><a href="extensions-to-ggplot.html#cb558-4" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb558-5"><a href="extensions-to-ggplot.html#cb558-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>steroids_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Steroids&quot;</span>), <span class="at">stroke=</span><span class="dv">2</span>, <span class="at">shape=</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb558-6"><a href="extensions-to-ggplot.html#cb558-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Now we add important clinical events - we can add severe hypoxia events and death events to the plot, with additional point geoms with distinct shapes for each of these.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="extensions-to-ggplot.html#cb559-1" tabindex="-1"></a>dat_swim <span class="sc">|&gt;</span> </span>
<span id="cb559-2"><a href="extensions-to-ggplot.html#cb559-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb559-3"><a href="extensions-to-ggplot.html#cb559-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>id, <span class="at">col =</span> intubation_status, <span class="at">group=</span>id),</span>
<span id="cb559-4"><a href="extensions-to-ggplot.html#cb559-4" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb559-5"><a href="extensions-to-ggplot.html#cb559-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>steroids_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Steroids&quot;</span>), <span class="at">stroke=</span><span class="dv">2</span>, <span class="at">shape=</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb559-6"><a href="extensions-to-ggplot.html#cb559-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb559-7"><a href="extensions-to-ggplot.html#cb559-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>severe_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Severe hypoxia&quot;</span>), <span class="at">size=</span><span class="dv">2</span>, <span class="at">stroke=</span><span class="fl">1.5</span>, <span class="at">shape=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb559-8"><a href="extensions-to-ggplot.html#cb559-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>death_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Death&quot;</span>), <span class="at">size=</span><span class="dv">2</span>, <span class="at">stroke=</span><span class="fl">1.5</span>, <span class="at">shape=</span><span class="dv">4</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>We can fine-tune the colors and improve the legend name below.
We will save the plot as p, and add more to it in future steps.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="extensions-to-ggplot.html#cb560-1" tabindex="-1"></a><span class="co"># define colors for all geometries with a color argument</span></span>
<span id="cb560-2"><a href="extensions-to-ggplot.html#cb560-2" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Severe hypoxia&quot;</span> <span class="ot">=</span> <span class="st">&quot;#b24745&quot;</span>, <span class="co"># red</span></span>
<span id="cb560-3"><a href="extensions-to-ggplot.html#cb560-3" tabindex="-1"></a>    <span class="st">&quot;Intubated&quot;</span> <span class="ot">=</span> <span class="st">&quot;#483d8b&quot;</span>, <span class="co"># navy</span></span>
<span id="cb560-4"><a href="extensions-to-ggplot.html#cb560-4" tabindex="-1"></a>  <span class="st">&quot;Not intubated&quot;</span> <span class="ot">=</span> <span class="st">&quot;#74aaff&quot;</span>, <span class="co"># light blue</span></span>
<span id="cb560-5"><a href="extensions-to-ggplot.html#cb560-5" tabindex="-1"></a>          <span class="st">&quot;Steroids&quot;</span><span class="ot">=</span><span class="st">&quot;#ffd966&quot;</span>, <span class="co"># gold</span></span>
<span id="cb560-6"><a href="extensions-to-ggplot.html#cb560-6" tabindex="-1"></a>          <span class="st">&quot;Death&quot;</span> <span class="ot">=</span> <span class="st">&quot;#000000&quot;</span>) <span class="co"># black </span></span>
<span id="cb560-7"><a href="extensions-to-ggplot.html#cb560-7" tabindex="-1"></a></span>
<span id="cb560-8"><a href="extensions-to-ggplot.html#cb560-8" tabindex="-1"></a>p <span class="ot">&lt;-</span> dat_swim <span class="sc">|&gt;</span> </span>
<span id="cb560-9"><a href="extensions-to-ggplot.html#cb560-9" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb560-10"><a href="extensions-to-ggplot.html#cb560-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>id, <span class="at">col =</span> intubation_status, <span class="at">group=</span>id),</span>
<span id="cb560-11"><a href="extensions-to-ggplot.html#cb560-11" tabindex="-1"></a>            <span class="at">size=</span><span class="fl">1.8</span>) <span class="sc">+</span></span>
<span id="cb560-12"><a href="extensions-to-ggplot.html#cb560-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>steroids_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Steroids&quot;</span>), <span class="at">stroke=</span><span class="dv">2</span>, <span class="at">shape=</span><span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb560-13"><a href="extensions-to-ggplot.html#cb560-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb560-14"><a href="extensions-to-ggplot.html#cb560-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>severe_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Severe hypoxia&quot;</span>), <span class="at">size=</span><span class="dv">2</span>, <span class="at">stroke=</span><span class="fl">1.5</span>, <span class="at">shape=</span><span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb560-15"><a href="extensions-to-ggplot.html#cb560-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>death_this_day, <span class="at">y=</span>id, <span class="at">col=</span><span class="st">&quot;Death&quot;</span>), <span class="at">size=</span><span class="dv">2</span>, <span class="at">stroke=</span><span class="fl">1.5</span>, <span class="at">shape=</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb560-16"><a href="extensions-to-ggplot.html#cb560-16" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> cols, <span class="at">name=</span><span class="st">&quot;Patient Status&quot;</span>) </span>
<span id="cb560-17"><a href="extensions-to-ggplot.html#cb560-17" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>This is really coming along. But the legend symbols are accurate for colors, but don’t reflect the shapes we used, as we did not use aes() to create the shapes. To override the default shapes, lines, etc. in the legend, we need to use the guides() function, and override guide_legend(). This lets you manually specify the shapes. Let’s start by first defining the corresponding shapes (with NA when we don’t want a point), then overriding the shapes, and update our plot.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="extensions-to-ggplot.html#cb561-1" tabindex="-1"></a>shape_override <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">21</span>, <span class="dv">15</span>) <span class="co"># order matches `cols`:severe, intubation (yes/no), steroids, death, with the appropriate shapes</span></span>
<span id="cb561-2"><a href="extensions-to-ggplot.html#cb561-2" tabindex="-1"></a></span>
<span id="cb561-3"><a href="extensions-to-ggplot.html#cb561-3" tabindex="-1"></a><span class="co"># modify the color legend to include the correct shapes</span></span>
<span id="cb561-4"><a href="extensions-to-ggplot.html#cb561-4" tabindex="-1"></a>p <span class="sc">+</span> </span>
<span id="cb561-5"><a href="extensions-to-ggplot.html#cb561-5" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb561-6"><a href="extensions-to-ggplot.html#cb561-6" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb561-7"><a href="extensions-to-ggplot.html#cb561-7" tabindex="-1"></a>        <span class="at">shape =</span> shape_override) </span>
<span id="cb561-8"><a href="extensions-to-ggplot.html#cb561-8" tabindex="-1"></a>        ))</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>That worked well. Now let’s remove the lines though Death, Severe Hypoxia, and Steroids, by overriding the line type (1 for a standard line or NA for no line), then fine tune the stroke and size for each of these geom points. Note that for shapes 21-24 in R, you have to separately specify stroke (for outer line) and fill (if any), while shapes 1-20 just require a size.</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="extensions-to-ggplot.html#cb562-1" tabindex="-1"></a>line_override <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="cn">NA</span>,<span class="cn">NA</span>) <span class="co"># order matches `cols`:severe, intubation (yes/no), steroids, death</span></span>
<span id="cb562-2"><a href="extensions-to-ggplot.html#cb562-2" tabindex="-1"></a>stroke_override <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">1.4</span>) <span class="co"># order matches `cols`:severe, intubation (yes/no), steroids, death</span></span>
<span id="cb562-3"><a href="extensions-to-ggplot.html#cb562-3" tabindex="-1"></a>size_override <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.5</span>,<span class="fl">2.5</span>,<span class="fl">2.6</span>,<span class="fl">2.5</span>,<span class="dv">2</span>) <span class="co"># order matches `cols`:severe, intubation (yes/no), steroids, death</span></span>
<span id="cb562-4"><a href="extensions-to-ggplot.html#cb562-4" tabindex="-1"></a></span>
<span id="cb562-5"><a href="extensions-to-ggplot.html#cb562-5" tabindex="-1"></a>p <span class="ot">&lt;-</span></span>
<span id="cb562-6"><a href="extensions-to-ggplot.html#cb562-6" tabindex="-1"></a>  p <span class="sc">+</span></span>
<span id="cb562-7"><a href="extensions-to-ggplot.html#cb562-7" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb562-8"><a href="extensions-to-ggplot.html#cb562-8" tabindex="-1"></a>        <span class="at">override.aes =</span> <span class="fu">list</span>(</span>
<span id="cb562-9"><a href="extensions-to-ggplot.html#cb562-9" tabindex="-1"></a>        <span class="at">shape =</span> shape_override,</span>
<span id="cb562-10"><a href="extensions-to-ggplot.html#cb562-10" tabindex="-1"></a>        <span class="at">linetype =</span> line_override,</span>
<span id="cb562-11"><a href="extensions-to-ggplot.html#cb562-11" tabindex="-1"></a>        <span class="at">stroke =</span> stroke_override,</span>
<span id="cb562-12"><a href="extensions-to-ggplot.html#cb562-12" tabindex="-1"></a>        <span class="at">size =</span> size_override)</span>
<span id="cb562-13"><a href="extensions-to-ggplot.html#cb562-13" tabindex="-1"></a>        ))</span>
<span id="cb562-14"><a href="extensions-to-ggplot.html#cb562-14" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Now the legend looks nice. Let’s add a few more aesthetic tweaks, including title and better axis labels.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="extensions-to-ggplot.html#cb563-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> p <span class="sc">+</span></span>
<span id="cb563-2"><a href="extensions-to-ggplot.html#cb563-2" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Days since hospitalization&quot;</span>,<span class="at">y=</span><span class="st">&quot;Patient</span><span class="sc">\n</span><span class="st">number&quot;</span>,<span class="at">title=</span><span class="st">&quot;COVID Treatment Timeline for 30 Patients&quot;</span>) <span class="sc">+</span></span>
<span id="cb563-3"><a href="extensions-to-ggplot.html#cb563-3" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)) <span class="sc">+</span> <span class="co"># remove extra white space </span></span>
<span id="cb563-4"><a href="extensions-to-ggplot.html#cb563-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co"># text=element_text(family=&quot;Poppins&quot;, size=11),</span></span>
<span id="cb563-5"><a href="extensions-to-ggplot.html#cb563-5" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust=</span>.<span class="dv">5</span>, <span class="at">size=</span><span class="dv">12</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb563-6"><a href="extensions-to-ggplot.html#cb563-6" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust=</span>.<span class="dv">5</span>, <span class="at">size=</span><span class="dv">12</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb563-7"><a href="extensions-to-ggplot.html#cb563-7" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">0</span>),</span>
<span id="cb563-8"><a href="extensions-to-ggplot.html#cb563-8" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>, <span class="at">hjust=</span><span class="fl">1.5</span>),</span>
<span id="cb563-9"><a href="extensions-to-ggplot.html#cb563-9" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb563-10"><a href="extensions-to-ggplot.html#cb563-10" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.3</span>),</span>
<span id="cb563-11"><a href="extensions-to-ggplot.html#cb563-11" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">13</span>, <span class="at">face=</span><span class="dv">4</span>),</span>
<span id="cb563-12"><a href="extensions-to-ggplot.html#cb563-12" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb563-13"><a href="extensions-to-ggplot.html#cb563-13" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>, <span class="at">colour =</span><span class="st">&quot;gray30&quot;</span>),</span>
<span id="cb563-14"><a href="extensions-to-ggplot.html#cb563-14" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb563-15"><a href="extensions-to-ggplot.html#cb563-15" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb563-16"><a href="extensions-to-ggplot.html#cb563-16" tabindex="-1"></a>  ) </span>
<span id="cb563-17"><a href="extensions-to-ggplot.html#cb563-17" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>And we are done. You can see how this can illustrate the hospital course for a number of patients, and transmit a lot of longitudinal information quickly when the number of patients is not too long.</p>
<p>Let’s try another swimmer plot, using some simulated data from a study of patients after liver transplant. Some of these patients develop ascites (increased fluid in the abdominal peritoneal cavity) that requires large volume paracentesis to remove. If this becomes frequent, it can cause major fluid shifts and problems with kidney function. Sometimes taking the spleen out of the system with splenectomy (surgical removal) or SAE (splenic artery embolism) can reduce the need for large volume paracentesis. Let’s look at this with a small dataset of 12 patients who developed ascites after liver transplantation and received SAE (splenic artery embolization). Run the code chunk below to read in the data.</p>
<p>In this code chunk, we do a bit of data wrangling as well, properly formatting the dates, and calculating the length of time in days before or after the SAE (splenic artery embolization). Note that the default units are seconds, so we need to divide by (3600*24) to get days.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="extensions-to-ggplot.html#cb564-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb564-2"><a href="extensions-to-ggplot.html#cb564-2" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb564-3"><a href="extensions-to-ggplot.html#cb564-3" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb564-4"><a href="extensions-to-ggplot.html#cb564-4" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb564-5"><a href="extensions-to-ggplot.html#cb564-5" tabindex="-1"></a></span>
<span id="cb564-6"><a href="extensions-to-ggplot.html#cb564-6" tabindex="-1"></a>swim_liver <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/swim_liver.csv&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb564-7"><a href="extensions-to-ggplot.html#cb564-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">olt_date =</span> <span class="fu">mdy</span>(olt_date),</span>
<span id="cb564-8"><a href="extensions-to-ggplot.html#cb564-8" tabindex="-1"></a>         <span class="at">sae_date =</span> <span class="fu">mdy</span>(sae_date),</span>
<span id="cb564-9"><a href="extensions-to-ggplot.html#cb564-9" tabindex="-1"></a>         <span class="at">lvp_date =</span> <span class="fu">mdy</span>(lvp_date),</span>
<span id="cb564-10"><a href="extensions-to-ggplot.html#cb564-10" tabindex="-1"></a>         <span class="at">eofu_date =</span> <span class="fu">mdy</span>(eofu_date),</span>
<span id="cb564-11"><a href="extensions-to-ggplot.html#cb564-11" tabindex="-1"></a>         <span class="at">pat_id =</span> <span class="fu">factor</span>(pat_id))</span></code></pre></div>
<p>The key events are olt - orthotopic liver transplant, sae (splenic artery embolism), lvp (large volume paracentesis), and eofu (end of follow up). Each patient has an id and multiple events occur. Each patient also has a MELD score (meld = model for end-stage liver disease), which measures how sick they were before the liver transplant (higher scores are worse). We will start by drawing the line segments from liver transplant to end of followup, colored by meld score at the time of transplant.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="extensions-to-ggplot.html#cb565-1" tabindex="-1"></a>swim_liver <span class="sc">%&gt;%</span> </span>
<span id="cb565-2"><a href="extensions-to-ggplot.html#cb565-2" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb565-3"><a href="extensions-to-ggplot.html#cb565-3" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">xend =</span> end,</span>
<span id="cb565-4"><a href="extensions-to-ggplot.html#cb565-4" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld),</span>
<span id="cb565-5"><a href="extensions-to-ggplot.html#cb565-5" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">fct_reorder</span>(pat_id, meld), </span>
<span id="cb565-6"><a href="extensions-to-ggplot.html#cb565-6" tabindex="-1"></a>                   <span class="at">color =</span> meld)) <span class="sc">+</span></span>
<span id="cb565-7"><a href="extensions-to-ggplot.html#cb565-7" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb565-8"><a href="extensions-to-ggplot.html#cb565-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Now, let’s add the large volume paracentesis events as points with geom_point.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="extensions-to-ggplot.html#cb566-1" tabindex="-1"></a>swim_liver <span class="sc">%&gt;%</span> </span>
<span id="cb566-2"><a href="extensions-to-ggplot.html#cb566-2" tabindex="-1"></a>  <span class="fu">filter</span>(days_from_sae <span class="sc">&lt;=</span> end) <span class="sc">|&gt;</span> </span>
<span id="cb566-3"><a href="extensions-to-ggplot.html#cb566-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb566-4"><a href="extensions-to-ggplot.html#cb566-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">xend =</span> end,</span>
<span id="cb566-5"><a href="extensions-to-ggplot.html#cb566-5" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld),</span>
<span id="cb566-6"><a href="extensions-to-ggplot.html#cb566-6" tabindex="-1"></a>      <span class="at">yend =</span> <span class="fu">fct_reorder</span>(pat_id, meld), </span>
<span id="cb566-7"><a href="extensions-to-ggplot.html#cb566-7" tabindex="-1"></a>                   <span class="at">color =</span> meld)) <span class="sc">+</span></span>
<span id="cb566-8"><a href="extensions-to-ggplot.html#cb566-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>days_from_sae, </span>
<span id="cb566-9"><a href="extensions-to-ggplot.html#cb566-9" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld)),</span>
<span id="cb566-10"><a href="extensions-to-ggplot.html#cb566-10" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb566-11"><a href="extensions-to-ggplot.html#cb566-11" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb566-12"><a href="extensions-to-ggplot.html#cb566-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb566-13"><a href="extensions-to-ggplot.html#cb566-13" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">low =</span> <span class="st">&quot;dodgerblue1&quot;</span>, <span class="at">high =</span> <span class="st">&#39;dodgerblue4&#39;</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Now we can increase the linewidth and the size of the points to make this clearer.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="extensions-to-ggplot.html#cb567-1" tabindex="-1"></a>swim_liver <span class="sc">%&gt;%</span> </span>
<span id="cb567-2"><a href="extensions-to-ggplot.html#cb567-2" tabindex="-1"></a>   <span class="fu">filter</span>(days_from_sae <span class="sc">&lt;=</span> end) <span class="sc">|&gt;</span> </span>
<span id="cb567-3"><a href="extensions-to-ggplot.html#cb567-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb567-4"><a href="extensions-to-ggplot.html#cb567-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">xend =</span> end,</span>
<span id="cb567-5"><a href="extensions-to-ggplot.html#cb567-5" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld),</span>
<span id="cb567-6"><a href="extensions-to-ggplot.html#cb567-6" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="fu">fct_reorder</span>(pat_id, meld), </span>
<span id="cb567-7"><a href="extensions-to-ggplot.html#cb567-7" tabindex="-1"></a>                   <span class="at">color =</span> meld), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb567-8"><a href="extensions-to-ggplot.html#cb567-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>days_from_sae, </span>
<span id="cb567-9"><a href="extensions-to-ggplot.html#cb567-9" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld)), <span class="at">size =</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb567-10"><a href="extensions-to-ggplot.html#cb567-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb567-11"><a href="extensions-to-ggplot.html#cb567-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb567-12"><a href="extensions-to-ggplot.html#cb567-12" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">low =</span> <span class="st">&quot;dodgerblue1&quot;</span>, <span class="at">high =</span> <span class="st">&#39;dodgerblue4&#39;</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>The labels on axes and the legend are a bit of a mess still. We can clean this up and add red circles for the transplant events. We can move the legend inside the plot, and add some explanatory text as an annotation. It appears that the SAE (at day 0 in this pre-post swimmer plot) provides a lot of benefit to the mild to moderate MELD patients by reducing their need for large volume paracentesis. Those with severely high MELD scores don’t seem to get as much benefit.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="extensions-to-ggplot.html#cb568-1" tabindex="-1"></a>swim_liver <span class="sc">%&gt;%</span> </span>
<span id="cb568-2"><a href="extensions-to-ggplot.html#cb568-2" tabindex="-1"></a>   <span class="fu">filter</span>(days_from_sae <span class="sc">&lt;=</span> end) <span class="sc">|&gt;</span> </span>
<span id="cb568-3"><a href="extensions-to-ggplot.html#cb568-3" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb568-4"><a href="extensions-to-ggplot.html#cb568-4" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">xend =</span> end,</span>
<span id="cb568-5"><a href="extensions-to-ggplot.html#cb568-5" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld),</span>
<span id="cb568-6"><a href="extensions-to-ggplot.html#cb568-6" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="fu">fct_reorder</span>(pat_id, meld), </span>
<span id="cb568-7"><a href="extensions-to-ggplot.html#cb568-7" tabindex="-1"></a>                   <span class="at">color =</span> meld), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb568-8"><a href="extensions-to-ggplot.html#cb568-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>days_from_sae, </span>
<span id="cb568-9"><a href="extensions-to-ggplot.html#cb568-9" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld)), <span class="at">size =</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb568-10"><a href="extensions-to-ggplot.html#cb568-10" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> start, <span class="at">y =</span> <span class="fu">fct_reorder</span>(pat_id, meld)),</span>
<span id="cb568-11"><a href="extensions-to-ggplot.html#cb568-11" tabindex="-1"></a>        <span class="at">shape =</span><span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">stroke =</span><span class="dv">2</span>, <span class="at">size =</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb568-12"><a href="extensions-to-ggplot.html#cb568-12" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb568-13"><a href="extensions-to-ggplot.html#cb568-13" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="sc">-</span><span class="dv">225</span>, <span class="at">y=</span> <span class="fl">11.5</span>, <span class="at">label =</span> <span class="st">&quot;Red circles represent</span><span class="sc">\n</span><span class="st">the OLT date, </span><span class="sc">\n</span><span class="st">Each black dot represents</span><span class="sc">\n</span><span class="st">one large volume</span><span class="sc">\n</span><span class="st">paracentesis, </span><span class="sc">\n</span><span class="st"> Splenic Intervention at Day 0&quot;</span>) <span class="sc">+</span></span>
<span id="cb568-14"><a href="extensions-to-ggplot.html#cb568-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb568-15"><a href="extensions-to-ggplot.html#cb568-15" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">low =</span> <span class="st">&quot;dodgerblue1&quot;</span>, <span class="at">high =</span> <span class="st">&#39;dodgerblue4&#39;</span>)  <span class="sc">+</span></span>
<span id="cb568-16"><a href="extensions-to-ggplot.html#cb568-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Days Relative to Splenic Intervention&quot;</span>,<span class="at">y=</span><span class="st">&quot;Patient</span><span class="sc">\n</span><span class="st">number&quot;</span>,<span class="at">title=</span><span class="st">&quot;Large Volume Paracentesis</span><span class="sc">\n</span><span class="st">Timeline for 12 Patients from OLT Date</span><span class="sc">\n</span><span class="st">to End of FollowUp&quot;</span>) <span class="sc">+</span></span>
<span id="cb568-17"><a href="extensions-to-ggplot.html#cb568-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co"># text=element_text(family=&quot;Poppins&quot;, size=11),</span></span>
<span id="cb568-18"><a href="extensions-to-ggplot.html#cb568-18" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust=</span>.<span class="dv">5</span>, <span class="at">size=</span><span class="dv">12</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb568-19"><a href="extensions-to-ggplot.html#cb568-19" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">vjust=</span>.<span class="dv">5</span>, <span class="at">size=</span><span class="dv">12</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb568-20"><a href="extensions-to-ggplot.html#cb568-20" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>, <span class="at">face=</span><span class="st">&quot;bold&quot;</span>, <span class="at">vjust=</span><span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">0</span>),</span>
<span id="cb568-21"><a href="extensions-to-ggplot.html#cb568-21" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>, <span class="at">hjust=</span><span class="fl">1.5</span>),</span>
<span id="cb568-22"><a href="extensions-to-ggplot.html#cb568-22" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb568-23"><a href="extensions-to-ggplot.html#cb568-23" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.12</span>, <span class="fl">0.6</span>),</span>
<span id="cb568-24"><a href="extensions-to-ggplot.html#cb568-24" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">13</span>),</span>
<span id="cb568-25"><a href="extensions-to-ggplot.html#cb568-25" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb568-26"><a href="extensions-to-ggplot.html#cb568-26" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">size=</span><span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;solid&quot;</span>, <span class="at">colour =</span><span class="st">&quot;gray30&quot;</span>),</span>
<span id="cb568-27"><a href="extensions-to-ggplot.html#cb568-27" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb568-28"><a href="extensions-to-ggplot.html#cb568-28" tabindex="-1"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb568-29"><a href="extensions-to-ggplot.html#cb568-29" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>You can explore other (similar) approaches to swimmer plots, including the {swimmer} package <a href="https://cran.r-project.org/web/packages/swimplot/vignettes/Introduction.to.swimplot.html">here</a> in a blog post by Jessica Weiss.</p>
</div>
<div id="adding-significance-comparisons-with-ggsignif" class="section level2 hasAnchor" number="27.10">
<h2><span class="header-section-number">27.10</span> Adding Significance Comparisons with {ggsignif}<a href="extensions-to-ggplot.html#adding-significance-comparisons-with-ggsignif" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is common to compare continuous outcomes across categories with scatter plots or box plots, but we often see comparison bars and p values added. This can be added to a ggplot with the {ggsignif} package. Let’s load some libraries and some data in the code chunk below. Then we will do a basic boxplot.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="extensions-to-ggplot.html#cb569-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb569-2"><a href="extensions-to-ggplot.html#cb569-2" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb569-3"><a href="extensions-to-ggplot.html#cb569-3" tabindex="-1"></a><span class="fu">library</span>(medicaldata)</span>
<span id="cb569-4"><a href="extensions-to-ggplot.html#cb569-4" tabindex="-1"></a></span>
<span id="cb569-5"><a href="extensions-to-ggplot.html#cb569-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> medicaldata<span class="sc">::</span>diabetes</span>
<span id="cb569-6"><a href="extensions-to-ggplot.html#cb569-6" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb569-7"><a href="extensions-to-ggplot.html#cb569-7" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump</span>(<span class="fu">as_factor</span>(pregnancy_num), <span class="at">n =</span> <span class="dv">3</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">glucose_mg-dl</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb569-8"><a href="extensions-to-ggplot.html#cb569-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb569-9"><a href="extensions-to-ggplot.html#cb569-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Glucose in mg/dL&quot;</span>,</span>
<span id="cb569-10"><a href="extensions-to-ggplot.html#cb569-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Pregnancy Number&quot;</span>) <span class="sc">+</span></span>
<span id="cb569-11"><a href="extensions-to-ggplot.html#cb569-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>There seems to be a downward trend of fasting serum glucose from 0 to 2 pregnancies, then a rise in glucose with &gt;=3 pregnancies.
Now imagine that you would like to know if the difference in mean glucose between 0 and 2 pregnancies, or 2 and more than 2, are significant. And you want to display it on your plot.
You can use the geom_signif() geom from the {ggsignif} package. The arguments include the:
- comparisons = list(c(“cat1”, “cat2”)) # in quotes with names, or use the numbers of categories from left to right
- y_position = NN # manually control where on y axis
- tip_length = 1 (can use 0, 0.5, modify as needed
- xmin and xmax - can set the width. If you have more than one comparison, can use a vector, i.e. xmin = c(0.1, 1.8)
- annotation - can replace p value with “NS” or “**“, or whatever you want
- vjust = -0.2 (set a value to adjust the vertical justification of the annotation of p value - above or below the bar as needed)</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="extensions-to-ggplot.html#cb570-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb570-2"><a href="extensions-to-ggplot.html#cb570-2" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb570-3"><a href="extensions-to-ggplot.html#cb570-3" tabindex="-1"></a><span class="fu">library</span>(medicaldata)</span>
<span id="cb570-4"><a href="extensions-to-ggplot.html#cb570-4" tabindex="-1"></a></span>
<span id="cb570-5"><a href="extensions-to-ggplot.html#cb570-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> medicaldata<span class="sc">::</span>diabetes</span>
<span id="cb570-6"><a href="extensions-to-ggplot.html#cb570-6" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb570-7"><a href="extensions-to-ggplot.html#cb570-7" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_lump</span>(<span class="fu">as_factor</span>(pregnancy_num), <span class="at">n =</span> <span class="dv">3</span>), <span class="at">y =</span> <span class="st">`</span><span class="at">glucose_mg-dl</span><span class="st">`</span>) <span class="sc">+</span></span>
<span id="cb570-8"><a href="extensions-to-ggplot.html#cb570-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb570-9"><a href="extensions-to-ggplot.html#cb570-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Glucose in mg/dL&quot;</span>,</span>
<span id="cb570-10"><a href="extensions-to-ggplot.html#cb570-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Pregnancy Number&quot;</span>) <span class="sc">+</span></span>
<span id="cb570-11"><a href="extensions-to-ggplot.html#cb570-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb570-12"><a href="extensions-to-ggplot.html#cb570-12" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">y_position =</span> <span class="dv">200</span>,</span>
<span id="cb570-13"><a href="extensions-to-ggplot.html#cb570-13" tabindex="-1"></a>              <span class="at">comparison =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)),</span>
<span id="cb570-14"><a href="extensions-to-ggplot.html#cb570-14" tabindex="-1"></a>              <span class="at">tip_length =</span> <span class="fl">0.005</span>) <span class="sc">+</span></span>
<span id="cb570-15"><a href="extensions-to-ggplot.html#cb570-15" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">y_position =</span> <span class="dv">195</span>,</span>
<span id="cb570-16"><a href="extensions-to-ggplot.html#cb570-16" tabindex="-1"></a>              <span class="at">comparison =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)),</span>
<span id="cb570-17"><a href="extensions-to-ggplot.html#cb570-17" tabindex="-1"></a>              <span class="at">tip_length =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb570-18"><a href="extensions-to-ggplot.html#cb570-18" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">y_position =</span> <span class="dv">197</span>,</span>
<span id="cb570-19"><a href="extensions-to-ggplot.html#cb570-19" tabindex="-1"></a>              <span class="at">comparison =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)),</span>
<span id="cb570-20"><a href="extensions-to-ggplot.html#cb570-20" tabindex="-1"></a>              <span class="at">tip_length =</span> <span class="fl">0.02</span>) <span class="sc">+</span></span>
<span id="cb570-21"><a href="extensions-to-ggplot.html#cb570-21" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">y_position =</span> <span class="dv">179</span>,</span>
<span id="cb570-22"><a href="extensions-to-ggplot.html#cb570-22" tabindex="-1"></a>              <span class="at">comparison =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb570-23"><a href="extensions-to-ggplot.html#cb570-23" tabindex="-1"></a>              <span class="at">tip_length =</span> <span class="fl">0.02</span>,</span>
<span id="cb570-24"><a href="extensions-to-ggplot.html#cb570-24" tabindex="-1"></a>              <span class="at">annotation =</span> <span class="st">&quot;NS&quot;</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>We can add specific pairwise comparisons and position their height (on the y axis) with geom_signif.</p>
<p>You can learn more about
the {ggsignif} package at its <a href="https://cran.r-project.org/web/packages/ggsignif/vignettes/intro.html">webpage</a>.</p>
<div class="tryit">
<p>Now try this yourself. Copy the code below (click on the copy icon in the top right of the code chunk), paste it into your RStudio IDE, and edit to:</p>
<ul>
<li>compare spring to summer</li>
<li>compare summer to winter</li>
<li>put these at appropriate y_postions with appropriate tip_lengths - your choice</li>
</ul>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="extensions-to-ggplot.html#cb571-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb571-2"><a href="extensions-to-ggplot.html#cb571-2" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb571-3"><a href="extensions-to-ggplot.html#cb571-3" tabindex="-1"></a><span class="fu">library</span>(medicaldata)</span>
<span id="cb571-4"><a href="extensions-to-ggplot.html#cb571-4" tabindex="-1"></a></span>
<span id="cb571-5"><a href="extensions-to-ggplot.html#cb571-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> medicaldata<span class="sc">::</span>abm <span class="sc">|&gt;</span> </span>
<span id="cb571-6"><a href="extensions-to-ggplot.html#cb571-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">case_when</span>(month <span class="sc">&gt;</span><span class="dv">5</span> <span class="sc">&amp;</span></span>
<span id="cb571-7"><a href="extensions-to-ggplot.html#cb571-7" tabindex="-1"></a>                  month <span class="sc">&lt;</span><span class="dv">9</span> <span class="sc">~</span> <span class="st">&quot;summer&quot;</span>,</span>
<span id="cb571-8"><a href="extensions-to-ggplot.html#cb571-8" tabindex="-1"></a>                  month <span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb571-9"><a href="extensions-to-ggplot.html#cb571-9" tabindex="-1"></a>                  month <span class="sc">&lt;</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb571-10"><a href="extensions-to-ggplot.html#cb571-10" tabindex="-1"></a>                  month <span class="sc">&gt;</span><span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb571-11"><a href="extensions-to-ggplot.html#cb571-11" tabindex="-1"></a>                  month <span class="sc">&lt;</span><span class="dv">12</span> <span class="sc">~</span> <span class="st">&quot;fall&quot;</span>,</span>
<span id="cb571-12"><a href="extensions-to-ggplot.html#cb571-12" tabindex="-1"></a>                  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;winter&quot;</span>))</span>
<span id="cb571-13"><a href="extensions-to-ggplot.html#cb571-13" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb571-14"><a href="extensions-to-ggplot.html#cb571-14" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> csf_gluc) <span class="sc">+</span></span>
<span id="cb571-15"><a href="extensions-to-ggplot.html#cb571-15" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb571-16"><a href="extensions-to-ggplot.html#cb571-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;CSF Glucose in mg/dL&quot;</span>,</span>
<span id="cb571-17"><a href="extensions-to-ggplot.html#cb571-17" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Season&quot;</span>) <span class="sc">+</span></span>
<span id="cb571-18"><a href="extensions-to-ggplot.html#cb571-18" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Solution ggsignif
</button>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="extensions-to-ggplot.html#cb572-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb572-2"><a href="extensions-to-ggplot.html#cb572-2" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb572-3"><a href="extensions-to-ggplot.html#cb572-3" tabindex="-1"></a><span class="fu">library</span>(medicaldata)</span>
<span id="cb572-4"><a href="extensions-to-ggplot.html#cb572-4" tabindex="-1"></a></span>
<span id="cb572-5"><a href="extensions-to-ggplot.html#cb572-5" tabindex="-1"></a>dat <span class="ot">&lt;-</span> medicaldata<span class="sc">::</span>abm <span class="sc">|&gt;</span> </span>
<span id="cb572-6"><a href="extensions-to-ggplot.html#cb572-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">case_when</span>(month <span class="sc">&gt;</span><span class="dv">5</span> <span class="sc">&amp;</span></span>
<span id="cb572-7"><a href="extensions-to-ggplot.html#cb572-7" tabindex="-1"></a>                  month <span class="sc">&lt;</span><span class="dv">9</span> <span class="sc">~</span> <span class="st">&quot;summer&quot;</span>,</span>
<span id="cb572-8"><a href="extensions-to-ggplot.html#cb572-8" tabindex="-1"></a>                  month <span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span></span>
<span id="cb572-9"><a href="extensions-to-ggplot.html#cb572-9" tabindex="-1"></a>                  month <span class="sc">&lt;</span><span class="dv">6</span> <span class="sc">~</span> <span class="st">&quot;spring&quot;</span>,</span>
<span id="cb572-10"><a href="extensions-to-ggplot.html#cb572-10" tabindex="-1"></a>                  month <span class="sc">&gt;</span><span class="dv">8</span> <span class="sc">&amp;</span></span>
<span id="cb572-11"><a href="extensions-to-ggplot.html#cb572-11" tabindex="-1"></a>                  month <span class="sc">&lt;</span><span class="dv">12</span> <span class="sc">~</span> <span class="st">&quot;fall&quot;</span>,</span>
<span id="cb572-12"><a href="extensions-to-ggplot.html#cb572-12" tabindex="-1"></a>                  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;winter&quot;</span>))</span>
<span id="cb572-13"><a href="extensions-to-ggplot.html#cb572-13" tabindex="-1"></a><span class="fu">ggplot</span>(dat) <span class="sc">+</span></span>
<span id="cb572-14"><a href="extensions-to-ggplot.html#cb572-14" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> csf_gluc) <span class="sc">+</span></span>
<span id="cb572-15"><a href="extensions-to-ggplot.html#cb572-15" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb572-16"><a href="extensions-to-ggplot.html#cb572-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;CSF Glucose in mg/dL&quot;</span>,</span>
<span id="cb572-17"><a href="extensions-to-ggplot.html#cb572-17" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Season&quot;</span>) <span class="sc">+</span></span>
<span id="cb572-18"><a href="extensions-to-ggplot.html#cb572-18" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb572-19"><a href="extensions-to-ggplot.html#cb572-19" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">y_position =</span> <span class="dv">200</span>,</span>
<span id="cb572-20"><a href="extensions-to-ggplot.html#cb572-20" tabindex="-1"></a>              <span class="at">comparison =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)),</span>
<span id="cb572-21"><a href="extensions-to-ggplot.html#cb572-21" tabindex="-1"></a>              <span class="at">tip_length =</span> <span class="fl">0.005</span>) <span class="sc">+</span></span>
<span id="cb572-22"><a href="extensions-to-ggplot.html#cb572-22" tabindex="-1"></a>  <span class="fu">geom_signif</span>(<span class="at">y_position =</span> <span class="dv">190</span>,</span>
<span id="cb572-23"><a href="extensions-to-ggplot.html#cb572-23" tabindex="-1"></a>              <span class="at">comparison =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)),</span>
<span id="cb572-24"><a href="extensions-to-ggplot.html#cb572-24" tabindex="-1"></a>              <span class="at">tip_length =</span> <span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="io48j-extension-plots_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
</div>
</div>

</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="bivariate-ggplot2-scatterplots-to-visualize-relationships-between-variables.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="customizing-plot-scales.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["rmrwr.pdf", "rmrwr.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "section"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
